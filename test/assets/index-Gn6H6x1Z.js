import{r as y,a as ys,R as fe}from"./react-DnQQq7lD.js";import{D as vs}from"./storage-7oeF2ZJA.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))a(c);new MutationObserver(c=>{for(const o of c)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function t(c){const o={};return c.integrity&&(o.integrity=c.integrity),c.referrerPolicy&&(o.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?o.credentials="include":c.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(c){if(c.ep)return;c.ep=!0;const o=t(c);fetch(c.href,o)}})();var Ke={exports:{}},Ce={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ws=y,xs=Symbol.for("react.element"),ks=Symbol.for("react.fragment"),js=Object.prototype.hasOwnProperty,As=ws.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ss={key:!0,ref:!0,__self:!0,__source:!0};function Ye(n,e,t){var a,c={},o=null,l=null;t!==void 0&&(o=""+t),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(l=e.ref);for(a in e)js.call(e,a)&&!Ss.hasOwnProperty(a)&&(c[a]=e[a]);if(n&&n.defaultProps)for(a in e=n.defaultProps,e)c[a]===void 0&&(c[a]=e[a]);return{$$typeof:xs,type:n,key:o,ref:l,props:c,_owner:As.current}}Ce.Fragment=ks;Ce.jsx=Ye;Ce.jsxs=Ye;Ke.exports=Ce;var s=Ke.exports,Me={},Je=ys;Me.createRoot=Je.createRoot,Me.hydrateRoot=Je.hydrateRoot;class Ns extends vs{topics;learningPaths;tasks;answerHistory;userProgress;practiceSessions;spacedRepetition;constructor(){super("mindforge-academy-test"),this.version(1).stores({topics:"id, title, isActive, createdAt",learningPaths:"id, topicId, difficulty, isActive, createdAt",tasks:"id, learningPathId, type, *metadata.tags, metadata.difficulty, createdAt",answerHistory:"id, taskId, sessionId, timestamp, isCorrect",userProgress:"id, topicId, learningPathId, *milestones.lastActivity",practiceSessions:"id, execution.status, execution.startedAt, execution.completedAt, createdAt",spacedRepetition:"id, taskId, schedule.nextReview, algorithm.interval, createdAt"})}}const I=new Ns;async function Rs(){const n=new Map,e=[],t=[],a={mathematik:["algebra-basics.json","geometry-basics.json","advanced-tasks.json","brueche-grundlagen.json"],biologie:["zellbiologie.json","genetik-basics.json"],spanisch:["spanisch-grundlagen.json","begruessung-vorstellung.json","familie-persoenliches.json","zahlen-farben-tiere.json","vokabeltest-karteikarten.json"],test:["all-task-types.json"]};for(const[c,o]of Object.entries(a)){if(!n.has(c)){const l=Cs(c);n.set(c,l)}for(const l of o)try{const i=`/learning-platform/test/learning-paths/${c}/${l}`,p=await fetch(i);if(!p.ok){console.warn(`Failed to load ${i}: ${p.status}`);continue}const f=await p.json(),N=f.tasks.map(_=>_.id),P={...f.learningPath,taskIds:N,createdAt:f.learningPath.createdAt?new Date(f.learningPath.createdAt):new Date("2024-01-01"),updatedAt:f.learningPath.createdAt?new Date(f.learningPath.createdAt):new Date("2024-01-01")};e.push(P);const z=n.get(c);z.learningPathIds.includes(P.id)||z.learningPathIds.push(P.id);for(const _ of f.tasks){const q={..._,createdAt:new Date("2024-01-01"),updatedAt:new Date("2024-01-01")};t.push(q)}}catch(h){console.error(`Failed to load learning path ${c}/${l}:`,h)}}return{topics:Array.from(n.values()),learningPaths:e,tasks:t}}function Cs(n){const t={test:{id:"test",title:"Test & Demo",description:"Demonstriert alle Aufgabentypen der Plattform",metadata:{estimatedHours:1,difficultyLevel:"beginner",prerequisites:[]}},mathematik:{id:"mathematik",title:"Mathematik",description:"Grundlagen der Mathematik: Algebra, Geometrie und mehr",metadata:{estimatedHours:40,difficultyLevel:"intermediate",prerequisites:[]}},biologie:{id:"biologie",title:"Biologie",description:"Einf√ºhrung in die Biologie: Zellen, Genetik und √ñkosysteme",metadata:{estimatedHours:35,difficultyLevel:"beginner",prerequisites:[]}},spanisch:{id:"spanisch",title:"Spanisch",description:"Lerne Spanisch: Vokabeln, Grammatik und Konversation",metadata:{estimatedHours:50,difficultyLevel:"beginner",prerequisites:[]}},chemie:{id:"chemie",title:"Chemie",description:"Grundlagen der Chemie: Atome, Molek√ºle und Reaktionen",metadata:{estimatedHours:40,difficultyLevel:"intermediate",prerequisites:[]}},physik:{id:"physik",title:"Physik",description:"Einf√ºhrung in die Physik: Kr√§fte, Energie und Bewegung",metadata:{estimatedHours:45,difficultyLevel:"intermediate",prerequisites:[]}}}[n]||{id:n,title:n.charAt(0).toUpperCase()+n.slice(1),description:`Lernmaterialien f√ºr ${n}`,metadata:{estimatedHours:30,difficultyLevel:"beginner",prerequisites:[]}};return{id:t.id,title:t.title,description:t.description,learningPathIds:[],isActive:!0,metadata:t.metadata,createdAt:new Date("2024-01-01"),updatedAt:new Date("2024-01-01")}}async function Ve(n){console.log("üóëÔ∏è Clearing existing database...");const e=await n.topics.count(),t=await n.learningPaths.count(),a=await n.tasks.count();console.log(`Before clear: ${e} topics, ${t} paths, ${a} tasks`),await n.topics.clear(),await n.learningPaths.clear(),await n.tasks.clear();const c=await n.tasks.count();console.log(`After clear: ${c} tasks remaining`),console.log("üìÇ Loading learning paths from JSON files...");const o=await Rs();if(o.topics.length===0)throw new Error("No learning paths found in JSON files!");console.log(`Saving to database: ${o.topics.length} topics, ${o.learningPaths.length} learning paths, ${o.tasks.length} tasks`),console.log("Topics:",o.topics.map(p=>p.id)),console.log("Learning paths:",o.learningPaths.map(p=>`${p.id} (${p.taskIds?.length||0} taskIds)`)),console.log("Tasks:",o.tasks.map(p=>`${p.id} (learningPathId: ${p.learningPathId})`));try{await n.topics.bulkAdd(o.topics),console.log("‚úì Topics saved")}catch{console.log("‚ö†Ô∏è Topics exist, using bulkPut to update..."),await n.topics.bulkPut(o.topics),console.log("‚úì Topics updated")}try{await n.learningPaths.bulkAdd(o.learningPaths),console.log("‚úì Learning paths saved")}catch{console.log("‚ö†Ô∏è Learning paths exist, using bulkPut to update..."),await n.learningPaths.bulkPut(o.learningPaths),console.log("‚úì Learning paths updated")}try{await n.tasks.bulkAdd(o.tasks),console.log("‚úì Tasks saved")}catch(p){console.error("‚ùå Error saving tasks with bulkAdd:",p.message),console.log("‚ö†Ô∏è Some tasks already exist, using bulkPut to update...");try{await n.tasks.bulkPut(o.tasks),console.log("‚úì Tasks updated with bulkPut")}catch(f){console.error("‚ùå Error with bulkPut:",f.message)}}console.log(`‚úÖ Loaded from JSON: ${o.topics.length} topics, ${o.learningPaths.length} learning paths, ${o.tasks.length} tasks`);const l=await n.topics.count(),h=await n.learningPaths.count(),i=await n.tasks.count();console.log(`‚úÖ Verified in DB: ${l} topics, ${h} learning paths, ${i} tasks`)}class Qe extends Error{constructor(e,t,a){super(e),this.code=t,this.context=a,this.name="LearningPlatformError"}}class re extends Qe{constructor(e,t){super(e,"VALIDATION_ERROR",t),this.name="ValidationError"}}class me extends Qe{constructor(e,t){super(`${e} with id ${t} not found`,"NOT_FOUND",{resource:e,id:t}),this.name="NotFoundError"}}class V{id;configuration;execution;results;createdAt;updatedAt;constructor(e){V.validate(e),this.id=e.id,this.configuration={...e.configuration,learningPathIds:[...e.configuration.learningPathIds]},this.execution={taskIds:[...e.execution.taskIds],completedCount:e.execution.completedCount,correctCount:e.execution.correctCount,status:e.execution.status,totalTimeSpent:e.execution.totalTimeSpent},e.execution.startedAt&&(this.execution.startedAt=new Date(e.execution.startedAt)),e.execution.completedAt&&(this.execution.completedAt=new Date(e.execution.completedAt)),this.results={...e.results,difficultyDistribution:{...e.results.difficultyDistribution},improvementAreas:[...e.results.improvementAreas]},this.createdAt=e.createdAt||new Date,this.updatedAt=e.updatedAt||new Date}static validate(e){if(e.configuration?.targetCount!==void 0&&(e.configuration.targetCount<5||e.configuration.targetCount>50))throw new re("Target count must be between 5 and 50",{field:"targetCount",value:e.configuration.targetCount});if(e.execution?.status!==void 0){const t=["planned","active","paused","completed","abandoned"];if(!t.includes(e.execution.status))throw new re("Invalid session status",{field:"status",value:e.execution.status,validValues:t})}}static create(e,t,a,c,o){const l={topicId:t,learningPathIds:a,targetCount:o.targetCount,includeReview:o.includeReview};return o.difficultyFilter&&(l.difficultyFilter=o.difficultyFilter),new V({id:e,configuration:l,execution:{taskIds:c,completedCount:0,correctCount:0,status:"planned",totalTimeSpent:0},results:{accuracy:0,averageTime:0,difficultyDistribution:{},improvementAreas:[]}})}start(){if(this.execution.status!=="planned"&&this.execution.status!=="paused")throw new Error("Can only start planned or paused sessions");this.execution.status="active",this.execution.startedAt||(this.execution.startedAt=new Date),this.updatedAt=new Date}pause(){if(this.execution.status!=="active")throw new Error("Can only pause active sessions");this.execution.status="paused",this.updatedAt=new Date}resume(){if(this.execution.status!=="paused")throw new Error("Can only resume paused sessions");this.execution.status="active",this.updatedAt=new Date}recordAnswer(e,t){if(this.execution.status!=="active")throw new Error("Session must be active to record answers");this.execution.completedCount++,e&&this.execution.correctCount++,this.execution.totalTimeSpent+=t,this.updateResults(),this.updatedAt=new Date}complete(){if(this.execution.status==="completed"||this.execution.status==="abandoned")throw new Error("Session already finalized");this.execution.status="completed",this.execution.completedAt=new Date,this.updateResults(),this.updatedAt=new Date}abandon(){if(this.execution.status==="completed"||this.execution.status==="abandoned")throw new Error("Session already finalized");this.execution.status="abandoned",this.updatedAt=new Date}updateResults(){this.execution.completedCount>0&&(this.results.accuracy=this.execution.correctCount/this.execution.completedCount*100),this.execution.completedCount>0&&(this.results.averageTime=this.execution.totalTimeSpent/this.execution.completedCount)}getProgress(){return this.execution.completedCount/this.configuration.targetCount*100}isComplete(){return this.execution.completedCount>=this.configuration.targetCount}getRemainingCount(){return Math.max(0,this.configuration.targetCount-this.execution.completedCount)}toJSON(){const e={id:this.id,configuration:{...this.configuration,learningPathIds:[...this.configuration.learningPathIds]},execution:{...this.execution,taskIds:[...this.execution.taskIds]},results:{...this.results,difficultyDistribution:{...this.results.difficultyDistribution},improvementAreas:[...this.results.improvementAreas]},createdAt:this.createdAt,updatedAt:this.updatedAt};return this.configuration.difficultyFilter&&(e.configuration.difficultyFilter=this.configuration.difficultyFilter),this.execution.startedAt&&(e.execution.startedAt=this.execution.startedAt),this.execution.completedAt&&(e.execution.completedAt=this.execution.completedAt),e}static fromJSON(e){return new V(e)}}class $e{constructor(e,t,a){this.sessionRepository=e,this.taskRepository=t,this.spacedRepRepository=a}async createSession(e){const t=await this.selectTasksForSession(e),a=`session-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,c={targetCount:e.targetCount,includeReview:e.includeReview};e.difficultyFilter&&(c.difficultyFilter=e.difficultyFilter);const o=V.create(a,e.topicId,e.learningPathIds,t,c);return await this.sessionRepository.create(o.toJSON())}async getSession(e){return await this.sessionRepository.getById(e)}async updateSession(e,t){await this.sessionRepository.update(e,t)}async completeSession(e){const t=await this.sessionRepository.getById(e);if(!t)throw new me("PracticeSession",e);const a=V.fromJSON(t);return a.complete(),await this.sessionRepository.update(e,a.toJSON())}async pauseSession(e){const t=await this.sessionRepository.getById(e);if(!t)throw new me("PracticeSession",e);const a=V.fromJSON(t);a.pause(),await this.sessionRepository.update(e,a.toJSON())}async resumeSession(e){const t=await this.sessionRepository.getById(e);if(!t)throw new me("PracticeSession",e);const a=V.fromJSON(t);a.resume(),await this.sessionRepository.update(e,a.toJSON())}async abandonSession(e){const t=await this.sessionRepository.getById(e);if(!t)throw new me("PracticeSession",e);const a=V.fromJSON(t);a.abandon(),await this.sessionRepository.update(e,a.toJSON())}async getActiveSessions(e){return await this.sessionRepository.getActive(e)}async getRecentSessions(e,t){return await this.sessionRepository.getRecent(e,t)}async recordSessionAnswer(e,t,a){const c=await this.sessionRepository.getById(e);if(!c)throw new me("PracticeSession",e);const o=V.fromJSON(c);o.execution.status==="planned"&&o.start(),o.recordAnswer(t,a),o.isComplete()&&o.complete(),await this.sessionRepository.update(e,o.toJSON())}async selectTasksForSession(e){const t=[];let a=e.targetCount;if(console.log(`Selecting tasks: targetCount=${e.targetCount}, learningPaths=${e.learningPathIds.join(",")}`),e.includeReview&&a>0){const c=await this.spacedRepRepository.getDue(new Date),o=c.slice(0,Math.min(c.length,Math.ceil(e.targetCount*.3))).map(l=>l.taskId);console.log(`Review tasks found: ${o.length}`),t.push(...o),a-=o.length}if(a>0){const c={learningPathIds:e.learningPathIds,excludeIds:t};e.difficultyFilter&&(c.difficulty=e.difficultyFilter),console.log(`Requesting ${a} new tasks with filters:`,c);const o=await this.taskRepository.getRandomTasks(a,c);console.log(`Got ${o.length} tasks:`,o.map(l=>l.id)),t.push(...o.map(l=>l.id))}return console.log(`Total selected tasks: ${t.length}`),t}}class ge{id;taskId;algorithm;schedule;performance;metadata;createdAt;updatedAt;constructor(e){ge.validate(e),this.id=e.id,this.taskId=e.taskId,this.algorithm={...e.algorithm},this.schedule={...e.schedule,nextReview:new Date(e.schedule.nextReview)},e.schedule.lastReviewed&&(this.schedule.lastReviewed=new Date(e.schedule.lastReviewed)),this.performance={...e.performance},this.metadata={...e.metadata,introduced:new Date(e.metadata.introduced)},this.createdAt=e.createdAt||new Date,this.updatedAt=e.updatedAt||new Date}static validate(e){if(e.algorithm?.efactor!==void 0&&(e.algorithm.efactor<1.3||e.algorithm.efactor>2.5))throw new re("Efactor must be between 1.3 and 2.5",{field:"efactor",value:e.algorithm.efactor});if(e.algorithm?.interval!==void 0&&(e.algorithm.interval<0||e.algorithm.interval>365))throw new re("Interval must be between 0 and 365 days",{field:"interval",value:e.algorithm.interval});if(e.performance?.lastGrade!==void 0&&(e.performance.lastGrade<0||e.performance.lastGrade>5))throw new re("Grade must be between 0 and 5",{field:"lastGrade",value:e.performance.lastGrade});if(e.performance?.averageAccuracy!==void 0&&(e.performance.averageAccuracy<0||e.performance.averageAccuracy>100))throw new re("Average accuracy must be between 0 and 100",{field:"averageAccuracy",value:e.performance.averageAccuracy})}static createNew(e,t){return new ge({id:t,taskId:e,algorithm:{interval:1,repetition:0,efactor:2.5},schedule:{nextReview:new Date(Date.now()+24*60*60*1e3),totalReviews:0,consecutiveCorrect:0},performance:{averageAccuracy:0,averageTime:0,difficultyRating:3,lastGrade:0},metadata:{introduced:new Date,graduated:!1,lapseCount:0}})}recordAnswer(e,t){if(e<0||e>5)throw new re("Grade must be between 0 and 5",{field:"grade",value:e});if(this.performance.lastGrade=e,this.updateAverageAccuracy(e>=3),this.updateAverageTime(t),this.schedule.totalReviews++,this.schedule.lastReviewed=new Date,e<3)this.algorithm.repetition=0,this.algorithm.interval=1,this.schedule.consecutiveCorrect=0,this.metadata.lapseCount++,this.metadata.graduated=!1;else{this.schedule.consecutiveCorrect++;const a=.1-(5-e)*(.08+(5-e)*.02);this.algorithm.efactor=Math.max(1.3,this.algorithm.efactor+a),this.algorithm.efactor=Math.min(2.5,this.algorithm.efactor),this.algorithm.repetition===0?this.algorithm.interval=1:this.algorithm.repetition===1?this.algorithm.interval=6:this.algorithm.interval=Math.round(this.algorithm.interval*this.algorithm.efactor),this.algorithm.interval=Math.min(365,this.algorithm.interval),this.algorithm.repetition++,this.algorithm.repetition>=2&&(this.metadata.graduated=!0)}this.schedule.nextReview=new Date(Date.now()+this.algorithm.interval*24*60*60*1e3),this.updatedAt=new Date}updateAverageAccuracy(e){const t=this.schedule.totalReviews,c=this.performance.averageAccuracy/100*(t-1)+(e?1:0);this.performance.averageAccuracy=c/t*100}updateAverageTime(e){const t=this.schedule.totalReviews,c=this.performance.averageTime*(t-1)+e;this.performance.averageTime=c/t}isDue(){return this.schedule.nextReview.getTime()<=Date.now()}daysUntilReview(){const e=this.schedule.nextReview.getTime()-Date.now();return Math.ceil(e/(24*60*60*1e3))}toJSON(){const e={id:this.id,taskId:this.taskId,algorithm:{...this.algorithm},schedule:{nextReview:this.schedule.nextReview,totalReviews:this.schedule.totalReviews,consecutiveCorrect:this.schedule.consecutiveCorrect},performance:{...this.performance},metadata:{introduced:this.metadata.introduced,graduated:this.metadata.graduated,lapseCount:this.metadata.lapseCount},createdAt:this.createdAt,updatedAt:this.updatedAt};return this.schedule.lastReviewed&&(e.schedule.lastReviewed=this.schedule.lastReviewed),e}static fromJSON(e){return new ge(e)}}class Is{constructor(e,t){this.spacedRepRepository=e,this.taskRepository=t}async getNextTasks(e,t){const o=(await this.spacedRepRepository.getDue(new Date)).sort((h,i)=>i.metadata.lapseCount!==h.metadata.lapseCount?i.metadata.lapseCount-h.metadata.lapseCount:h.schedule.nextReview.getTime()-i.schedule.nextReview.getTime()).slice(0,t),l=[];for(const h of o){const i=await this.taskRepository.getById(h.taskId);i&&l.push(i)}return l}async recordAnswer(e,t,a){if(a<0||a>5)throw new Error("Grade must be between 0 and 5");let c=await this.spacedRepRepository.getByTaskId(e);if(!c){const l=ge.createNew(e,`sr-${e}-${Date.now()}`);c=await this.spacedRepRepository.create(l.toJSON())}const o=ge.fromJSON(c);o.recordAnswer(a,0),await this.spacedRepRepository.update(c.id,o.toJSON())}async getRepetitionData(e){return await this.spacedRepRepository.getByTaskId(e)}async getTasksDue(e){const t=await this.spacedRepRepository.getDue(new Date),a=[];for(const c of t){const o=await this.taskRepository.getById(c.taskId);o&&a.push(o)}return a}async getReviewSchedule(e,t){const a=[],c=new Date;for(let o=0;o<t;o++){const l=new Date(c);l.setDate(l.getDate()+o),l.setHours(23,59,59,999);const h=await this.spacedRepRepository.getByNextReviewDate(l);let i=0;for(const p of h)i+=p.performance.averageTime||3e4;a.push({date:l,taskCount:h.length,estimatedTime:Math.round(i/1e3)})}return a}async rescheduleTask(e,t){const a=await this.spacedRepRepository.getByTaskId(e);if(!a)throw new me("SpacedRepetitionItem",e);await this.spacedRepRepository.updateSchedule(a.id,{...a.schedule,nextReview:t})}async getStatistics(e){const t=await this.spacedRepRepository.getAll(),a=await this.spacedRepRepository.getDue(new Date),c=t.filter(h=>h.metadata.graduated).length,o=t.reduce((h,i)=>h+i.algorithm.interval,0),l=t.reduce((h,i)=>h+i.performance.averageAccuracy,0);return{totalItems:t.length,dueToday:a.length,graduated:c,averageInterval:t.length>0?o/t.length:0,averageAccuracy:t.length>0?l/t.length:0}}}class Ps{constructor(e){this.table=e}async create(e){return await this.table.add(e),e}async getById(e){return await this.table.get(e)||null}async getAll(){return await this.table.toArray()}async update(e,t){return await this.table.update(e,t),await this.table.get(e)}async delete(e){await this.table.delete(e)}async getActive(){return await this.table.where("isActive").equals(1).toArray()}async search(e){const t=e.toLowerCase();return await this.table.filter(a=>a.title.toLowerCase().includes(t)).toArray()}async getByTitle(e){return null}async createMany(e){return[]}async updateMany(e){}async deleteMany(e){}async count(){return await this.table.count()}async exists(e){return!!await this.table.get(e)}}class Ts{constructor(e){this.table=e}async create(e){return await this.table.add(e),e}async getById(e){return await this.table.get(e)||null}async getAll(){return await this.table.toArray()}async update(e,t){return await this.table.update(e,t),await this.table.get(e)}async delete(e){await this.table.delete(e)}async getByTopicId(e){return await this.table.where("topicId").equals(e).toArray()}async getByDifficulty(e){return await this.table.where("difficulty").equals(e).toArray()}async getActive(){return await this.table.where("isActive").equals(1).toArray()}async searchByTitle(e){return[]}async createMany(e){return[]}async updateMany(e){}async deleteMany(e){}async count(){return await this.table.count()}async exists(e){return!!await this.table.get(e)}}class zs{constructor(e){this.table=e}async create(e){return await this.table.add(e),e}async getById(e){return await this.table.get(e)||null}async getAll(){return await this.table.toArray()}async update(e,t){return await this.table.update(e,t),await this.table.get(e)}async delete(e){await this.table.delete(e)}async getByLearningPathId(e){return await this.table.where("learningPathId").equals(e).toArray()}async getRandomTasks(e,t){console.log(`[TaskRepository] getRandomTasks called: count=${e}, filters=`,t);let a;if(t?.learningPathIds?(a=await this.table.where("learningPathId").anyOf(t.learningPathIds).toArray(),console.log(`[TaskRepository] Found ${a.length} tasks for learning paths:`,t.learningPathIds),console.log("[TaskRepository] Task IDs:",a.map(l=>l.id))):(a=await this.table.toArray(),console.log(`[TaskRepository] Found ${a.length} tasks (no filter)`)),t?.excludeIds){const l=a.length;a=a.filter(h=>!t.excludeIds.includes(h.id)),console.log(`[TaskRepository] After excluding IDs: ${l} -> ${a.length} tasks`)}const c=a.sort(()=>Math.random()-.5),o=[];if(c.length===0)return console.log("[TaskRepository] No tasks available!"),o;for(let l=0;l<e;l++){const h=c[l%c.length];h&&o.push(h)}return console.log(`[TaskRepository] Returning ${o.length} tasks (${c.length} unique, repeated to reach ${e})`),o}async getByLearningPathIds(e){return[]}async getByType(e){return[]}async getByDifficulty(e){return[]}async getByTags(e){return[]}async search(e){return[]}async createMany(e){return[]}async updateMany(e){}async deleteMany(e){}async count(){return await this.table.count()}async exists(e){return!!await this.table.get(e)}}class Ds{constructor(e){this.table=e}async create(e){return await this.table.add(e),e}async getById(e){return await this.table.get(e)||null}async getAll(){return await this.table.toArray()}async update(e,t){return await this.table.update(e,t),await this.table.get(e)}async delete(e){await this.table.delete(e)}async getByTaskId(e){return await this.table.where("taskId").equals(e).toArray()}async getBySessionId(e){return await this.table.where("sessionId").equals(e).toArray()}async getByUserId(e,t){return[]}async getByDateRange(e,t){return[]}async getCorrectAnswers(e){return await this.table.where("taskId").equals(e).filter(t=>t.isCorrect).toArray()}async getIncorrectAnswers(e){return await this.table.where("taskId").equals(e).filter(t=>!t.isCorrect).toArray()}async getAccuracyForPeriod(e,t,a){return 0}async createMany(e){return[]}async updateMany(e){}async deleteMany(e){}async count(){return await this.table.count()}async exists(e){return!!await this.table.get(e)}}class $s{constructor(e){this.table=e}async create(e){return await this.table.add(e),e}async getById(e){return await this.table.get(e)||null}async getAll(){return await this.table.toArray()}async update(e,t){return await this.table.update(e,t),await this.table.get(e)}async delete(e){await this.table.delete(e)}async getByTopicId(e){return(await this.table.where("topicId").equals(e).toArray())[0]||null}async getByLearningPathId(e){return(await this.table.where("learningPathId").equals(e).toArray())[0]||null}async getByUserId(e){return[]}async updateStatistics(e,t){}async incrementTaskCount(e,t){}async updateStreak(e,t){}async createMany(e){return[]}async updateMany(e){}async deleteMany(e){}async count(){return await this.table.count()}async exists(e){return!!await this.table.get(e)}}class Ls{constructor(e){this.table=e}async create(e){return await this.table.add(e),e}async getById(e){return await this.table.get(e)||null}async getAll(){return await this.table.toArray()}async update(e,t){return await this.table.update(e,t),await this.table.get(e)}async delete(e){await this.table.delete(e)}async getActive(e){return await this.table.where("execution.status").anyOf(["planned","active","paused"]).toArray()}async getRecent(e,t){return await this.table.orderBy("createdAt").reverse().limit(t).toArray()}async getByStatus(e){return await this.table.where("execution.status").equals(e).toArray()}async getByUserId(e){return[]}async getByDateRange(e,t){return[]}async updateStatus(e,t){}async incrementProgress(e,t,a){}async createMany(e){return[]}async updateMany(e){}async deleteMany(e){}async count(){return await this.table.count()}async exists(e){return!!await this.table.get(e)}}class Bs{constructor(e){this.table=e}async create(e){return await this.table.add(e),e}async getById(e){return await this.table.get(e)||null}async getAll(){return await this.table.toArray()}async update(e,t){return await this.table.update(e,t),await this.table.get(e)}async delete(e){await this.table.delete(e)}async getByTaskId(e){return(await this.table.where("taskId").equals(e).toArray())[0]||null}async getDue(e){return await this.table.where("schedule.nextReview").belowOrEqual(e).toArray()}async getByNextReviewDate(e){return[]}async updateAlgorithmData(e,t){}async updateSchedule(e,t){}async updatePerformance(e,t){}async getReviewCalendar(e,t){return[]}async createMany(e){return[]}async updateMany(e){}async deleteMany(e){}async count(){return await this.table.count()}async exists(e){return!!await this.table.get(e)}}class Fe{static topicRepo;static learningPathRepo;static taskRepo;static answerHistoryRepo;static userProgressRepo;static practiceSessionRepo;static spacedRepetitionRepo;static getTopicRepository(){return this.topicRepo||(this.topicRepo=new Ps(I.topics)),this.topicRepo}static getLearningPathRepository(){return this.learningPathRepo||(this.learningPathRepo=new Ts(I.learningPaths)),this.learningPathRepo}static getTaskRepository(){return this.taskRepo||(this.taskRepo=new zs(I.tasks)),this.taskRepo}static getAnswerHistoryRepository(){return this.answerHistoryRepo||(this.answerHistoryRepo=new Ds(I.answerHistory)),this.answerHistoryRepo}static getUserProgressRepository(){return this.userProgressRepo||(this.userProgressRepo=new $s(I.userProgress)),this.userProgressRepo}static getPracticeSessionRepository(){return this.practiceSessionRepo||(this.practiceSessionRepo=new Ls(I.practiceSessions)),this.practiceSessionRepo}static getSpacedRepetitionRepository(){return this.spacedRepetitionRepo||(this.spacedRepetitionRepo=new Bs(I.spacedRepetition)),this.spacedRepetitionRepo}static reset(){this.topicRepo=null,this.learningPathRepo=null,this.taskRepo=null,this.answerHistoryRepo=null,this.userProgressRepo=null,this.practiceSessionRepo=null,this.spacedRepetitionRepo=null}}const je=()=>Fe.getTaskRepository(),Le=()=>Fe.getPracticeSessionRepository(),Ae=()=>Fe.getSpacedRepetitionRepository();class Ms{manifest=null;audioCache=new Map;getBasePath=()=>window.location.pathname.startsWith("/learning-platform/")?"/learning-platform/":"/";get manifestPath(){return`${this.getBasePath()}audio/spanish/manifest.json`}get audioBasePath(){return`${this.getBasePath()}audio/spanish/`}isInitialized=!1;currentlyPlaying=null;async initialize(){if(!this.isInitialized)try{const e=await fetch(this.manifestPath);if(!e.ok)throw new Error(`Failed to load audio manifest: ${e.statusText}`);this.manifest=await e.json(),this.isInitialized=!0,console.log("‚úì Audio service initialized with",Object.keys(this.manifest||{}).length,"audio files")}catch(e){console.warn("‚ö†Ô∏è Failed to initialize audio service:",e),this.manifest={},this.isInitialized=!0}}async playSpanish(e){if(this.isInitialized||await this.initialize(),!this.manifest||!this.manifest[e])throw console.warn(`‚ö†Ô∏è No audio file found for: "${e}"`),new Error(`Audio not available for: ${e}`);const t=this.manifest[e],a=this.audioBasePath+t;this.currentlyPlaying&&(this.currentlyPlaying.pause(),this.currentlyPlaying.currentTime=0);let c=this.audioCache.get(a);return c||(c=new Audio(a),this.audioCache.set(a,c)),this.currentlyPlaying=c,new Promise((o,l)=>{if(!c){l(new Error("Audio element not found"));return}const h=()=>{p(),this.currentlyPlaying=null,o()},i=()=>{p(),this.currentlyPlaying=null,l(new Error(`Failed to play audio: ${a}`))},p=()=>{c.removeEventListener("ended",h),c.removeEventListener("error",i)};c.addEventListener("ended",h),c.addEventListener("error",i),c.currentTime=0,c.play().catch(f=>{p(),this.currentlyPlaying=null,l(f)})})}hasAudio(e){return this.isInitialized?!!(this.manifest&&this.manifest[e]):!1}stopPlayback(){this.currentlyPlaying&&(this.currentlyPlaying.pause(),this.currentlyPlaying.currentTime=0,this.currentlyPlaying=null)}clearCache(){this.audioCache.clear()}}const Ne=new Ms;function Xe(n){var e,t,a="";if(typeof n=="string"||typeof n=="number")a+=n;else if(typeof n=="object")if(Array.isArray(n)){var c=n.length;for(e=0;e<c;e++)n[e]&&(t=Xe(n[e]))&&(a&&(a+=" "),a+=t)}else for(t in n)n[t]&&(a&&(a+=" "),a+=t);return a}function D(){for(var n,e,t=0,a="",c=arguments.length;t<c;t++)(n=arguments[t])&&(e=Xe(n))&&(a&&(a+=" "),a+=e);return a}const Fs="_pulse_4vr9j_1",Z={"audio-button":"_audio-button_4vr9j_4","audio-button--small":"_audio-button--small_4vr9j_24","audio-button--medium":"_audio-button--medium_4vr9j_29","audio-button--large":"_audio-button--large_4vr9j_34","audio-button--disabled":"_audio-button--disabled_4vr9j_40","audio-button--playing":"_audio-button--playing_4vr9j_52","audio-button--active":"_audio-button--active_4vr9j_59","audio-button__icon":"_audio-button__icon_4vr9j_69","audio-button__icon--playing":"_audio-button__icon--playing_4vr9j_73",pulse:Fs,"audio-button-inline":"_audio-button-inline_4vr9j_88"},Ue=({size:n})=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",style:{width:n,height:n},children:s.jsx("path",{d:"M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"})}),Es=({size:n})=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",style:{width:n,height:n},children:s.jsx("path",{d:"M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"})});function _e({text:n,className:e,disabled:t=!1,size:a="medium"}){const[c,o]=y.useState(!1),[l,h]=y.useState(null),i=Ne.hasAudio(n),p=async()=>{if(!(c||t||!i)){o(!0),h(null);try{await Ne.playSpanish(n)}catch(P){console.error("Failed to play audio:",P),h("Audio playback failed")}finally{o(!1)}}},f={small:"16px",medium:"20px",large:"24px"},N=t||!i;return s.jsx("button",{onClick:p,disabled:N,className:D(Z["audio-button"],Z[`audio-button--${a}`],N&&Z["audio-button--disabled"],c&&Z["audio-button--playing"],!N&&!c&&Z["audio-button--active"],e),title:i?c?"Spielt ab...":`Aussprache abspielen: ${n}`:"Audio nicht verf√ºgbar","aria-label":`Spanische Aussprache f√ºr ${n} abspielen`,type:"button",children:c?s.jsx("div",{className:D(Z["audio-button__icon"],Z["audio-button__icon--playing"]),children:s.jsx(Ue,{size:f[a]})}):!i||l?s.jsx("div",{className:Z["audio-button__icon"],children:s.jsx(Es,{size:f[a]})}):s.jsx("div",{className:Z["audio-button__icon"],children:s.jsx(Ue,{size:f[a]})})})}const Os="_card_1cbjp_4",ue={card:Os,"card--shadow":"_card--shadow_1cbjp_11","card--no-shadow":"_card--no-shadow_1cbjp_15","card--border":"_card--border_1cbjp_20","card--no-border":"_card--no-border_1cbjp_24","card--padding-small":"_card--padding-small_1cbjp_29","card--padding-medium":"_card--padding-medium_1cbjp_33","card--padding-large":"_card--padding-large_1cbjp_37"};function ce({padding:n="medium",shadow:e=!0,border:t=!0,borderColor:a,backgroundColor:c,children:o,className:l,style:h,...i}){const p={...c&&{backgroundColor:c},...a&&{borderColor:a},...h};return s.jsx("div",{...i,style:p,className:D(ue.card,ue[`card--padding-${n}`],e?ue["card--shadow"]:ue["card--no-shadow"],t?ue["card--border"]:ue["card--no-border"],l),children:o})}const A={primary:{500:"#3b82f6"},success:{100:"#dcfce7",300:"#86efac",500:"#10b981"},error:{100:"#fee2e2",300:"#fca5a5",500:"#ef4444"},warning:{100:"#fef3c7",400:"#fbbf24",500:"#f59e0b"},info:{100:"#f3e8ff",300:"#d8b4fe",500:"#8b5cf6"}},L={feedback:{success:A.success[500],successLight:A.success[100],successBorder:A.success[300],error:A.error[500],errorLight:A.error[100],errorBorder:A.error[300],warning:A.warning[500],warningLight:A.warning[100],warningBorder:A.warning[400],info:A.info[500],infoLight:A.info[100],infoBorder:A.info[300]}},ee={"feedback-content":"_feedback-content_1oyn0_4","feedback-icon":"_feedback-icon_1oyn0_11","feedback-text":"_feedback-text_1oyn0_19","feedback-title":"_feedback-title_1oyn0_24","feedback-message":"_feedback-message_1oyn0_32","feedback-children":"_feedback-children_1oyn0_39","feedback-dismiss":"_feedback-dismiss_1oyn0_45","feedback--success":"_feedback--success_1oyn0_62","feedback--error":"_feedback--error_1oyn0_71","feedback--warning":"_feedback--warning_1oyn0_80","feedback--info":"_feedback--info_1oyn0_89"};function es({variant:n,title:e,message:t,dismissible:a=!1,onDismiss:c,children:o,className:l,style:h,...i}){const p=fe.useMemo(()=>qs(n),[n]),f=fe.useMemo(()=>Ws(n),[n]);return s.jsx(ce,{...i,padding:"medium",shadow:!1,border:!0,borderColor:p.border,backgroundColor:p.background,style:h,className:D(ee[`feedback--${n}`],l),role:n==="error"||n==="warning"?"alert":"status","aria-live":n==="error"||n==="warning"?"assertive":"polite","aria-atomic":"true",children:s.jsxs("div",{className:ee["feedback-content"],children:[s.jsx("div",{className:ee["feedback-icon"],"aria-hidden":"true",children:f}),s.jsxs("div",{className:ee["feedback-text"],children:[e&&s.jsx("h4",{className:ee["feedback-title"],children:e}),o?s.jsx("div",{className:ee["feedback-children"],children:o}):t&&s.jsx("p",{className:ee["feedback-message"],children:t})]}),a&&c&&s.jsx("button",{onClick:c,className:ee["feedback-dismiss"],"aria-label":`Dismiss ${n} message`,children:s.jsx("span",{"aria-hidden":"true",children:"‚úï"})})]})})}function qs(n){switch(n){case"success":return{background:L.feedback.successLight,border:L.feedback.successBorder,text:L.feedback.success};case"error":return{background:L.feedback.errorLight,border:L.feedback.errorBorder,text:L.feedback.error};case"warning":return{background:L.feedback.warningLight,border:L.feedback.warningBorder,text:L.feedback.warning};case"info":return{background:L.feedback.infoLight,border:L.feedback.infoBorder,text:L.feedback.info};default:return{background:L.feedback.infoLight,border:L.feedback.infoBorder,text:L.feedback.info}}}function Ws(n){switch(n){case"success":return"‚úì";case"error":return"‚úó";case"warning":return"‚ö†";case"info":return"‚Ñπ";default:return"‚Ñπ"}}const Hs="_input_1krva_4",K={"input-wrapper":"_input-wrapper_1krva_4","input-wrapper--full-width":"_input-wrapper--full-width_1krva_8",input:Hs,"input--full-width":"_input--full-width_1krva_27","input--error":"_input--error_1krva_40","input--success":"_input--success_1krva_46","input__helper-text--error":"_input__helper-text--error_1krva_72","input__helper-text--success":"_input__helper-text--success_1krva_76"};function Ze({value:n,onChange:e,error:t=!1,success:a=!1,helperText:c,fullWidth:o=!1,disabled:l=!1,className:h,style:i,id:p,...f}){const N=c?`${p||"input"}-helper`:void 0;return s.jsxs("div",{className:D(K["input-wrapper"],o&&K["input-wrapper--full-width"]),children:[s.jsx("input",{...f,id:p,type:"text",value:n,onChange:e,disabled:l,style:i,className:D(K.input,o&&K["input--full-width"],t&&K["input--error"],a&&K["input--success"],h),"aria-invalid":t?"true":"false","aria-describedby":N}),c&&s.jsx("div",{id:N,className:D(K.input__helper_text,t&&K["input__helper-text--error"],a&&K["input__helper-text--success"]),children:c})]})}const Gs="_checkbox_uclkx_4",Js="_checkbox__checkmark_uclkx_83",Vs="_checkbox__label_uclkx_101",J={"checkbox-container":"_checkbox-container_uclkx_4","checkbox-container--disabled":"_checkbox-container--disabled_uclkx_11","checkbox-wrapper":"_checkbox-wrapper_uclkx_16",checkbox:Gs,"checkbox--with-label":"_checkbox--with-label_uclkx_35","checkbox--error":"_checkbox--error_uclkx_55","checkbox--success":"_checkbox--success_uclkx_66",checkbox__checkmark:Js,"checkbox__checkmark--visible":"_checkbox__checkmark--visible_uclkx_96",checkbox__label:Vs,"checkbox__label--disabled":"_checkbox__label--disabled_uclkx_107"};function Us({checked:n,onChange:e,label:t,error:a=!1,success:c=!1,disabled:o=!1,className:l,style:h,id:i,...p}){const f=fe.useId(),N=i||`checkbox-${f}`;return s.jsxs("label",{htmlFor:N,style:h,className:D(J["checkbox-container"],o&&J["checkbox-container--disabled"],l),children:[s.jsxs("div",{className:J["checkbox-wrapper"],children:[s.jsx("input",{...p,type:"checkbox",id:N,checked:n,onChange:e,disabled:o,className:D(J.checkbox,t&&J["checkbox--with-label"],a&&J["checkbox--error"],c&&J["checkbox--success"]),"aria-checked":n,"aria-invalid":a}),s.jsx("div",{className:D(J.checkbox__checkmark,n&&J["checkbox__checkmark--visible"])})]}),t&&s.jsx("span",{className:D(J.checkbox__label,o&&J["checkbox__label--disabled"]),children:t})]})}const Zs="_select_1bjtk_4",Se={select:Zs,"select--full-width":"_select--full-width_1bjtk_23","select--error":"_select--error_1bjtk_36","select--success":"_select--success_1bjtk_42"};function Ks({value:n,onChange:e,options:t,disabled:a=!1,placeholder:c,error:o=!1,success:l=!1,fullWidth:h=!1,className:i,style:p,id:f}){return s.jsxs("select",{id:f,value:n,onChange:N=>e(N.target.value),disabled:a,style:p,className:D(Se.select,h&&Se["select--full-width"],o&&Se["select--error"],l&&Se["select--success"],i),"aria-invalid":o?"true":"false",children:[c&&s.jsx("option",{value:"",disabled:!0,children:c}),t.map(N=>s.jsx("option",{value:N.value,disabled:N.disabled,children:N.label},N.value))]})}const Y={"slider-container":"_slider-container_1ivuv_4","slider-track":"_slider-track_1ivuv_12","slider-fill":"_slider-fill_1ivuv_22","slider-fill--disabled":"_slider-fill--disabled_1ivuv_32","slider-input":"_slider-input_1ivuv_37","slider-thumb":"_slider-thumb_1ivuv_52","slider-thumb--disabled":"_slider-thumb--disabled_1ivuv_67","slider-value-display":"_slider-value-display_1ivuv_72","slider-value-display__current":"_slider-value-display__current_1ivuv_80"};function Ys({value:n,onChange:e,min:t,max:a,step:c=1,disabled:o=!1,unit:l="",showValue:h=!0,className:i,style:p,id:f,"aria-label":N}){const P=(n-t)/(a-t)*100;return s.jsxs("div",{style:p,className:D(Y["slider-container"],i),children:[s.jsxs("div",{className:Y["slider-track"],children:[s.jsx("div",{className:D(Y["slider-fill"],o&&Y["slider-fill--disabled"]),style:{width:`${P}%`}}),s.jsx("div",{className:D(Y["slider-thumb"],o&&Y["slider-thumb--disabled"]),style:{left:`calc(${P}% - 12px)`}}),s.jsx("input",{type:"range",id:f,min:t,max:a,step:c,value:n,onChange:z=>e(Number(z.target.value)),disabled:o,className:Y["slider-input"],"aria-label":N,"aria-valuenow":n,"aria-valuemin":t,"aria-valuemax":a,"aria-valuetext":`${n}${l}`})]}),h&&s.jsxs("div",{className:Y["slider-value-display"],children:[s.jsxs("span",{children:[t,l]}),s.jsxs("span",{className:Y["slider-value-display__current"],children:[n,l]}),s.jsxs("span",{children:[a,l]})]})]})}const r={"practice-session":"_practice-session_i40nv_3","practice-session__header":"_practice-session__header_i40nv_14","practice-session__header-top":"_practice-session__header-top_i40nv_19","practice-session__header-left":"_practice-session__header-left_i40nv_26","practice-session__title":"_practice-session__title_i40nv_32","practice-session__task-counter":"_practice-session__task-counter_i40nv_37","practice-session__task-id":"_practice-session__task-id_i40nv_42","practice-session__cancel-btn":"_practice-session__cancel-btn_i40nv_48","practice-session__progress-bar":"_practice-session__progress-bar_i40nv_58","practice-session__progress-fill":"_practice-session__progress-fill_i40nv_66","practice-session__question-area":"_practice-session__question-area_i40nv_74","practice-session__question-header":"_practice-session__question-header_i40nv_85","practice-session__question-text":"_practice-session__question-text_i40nv_92","practice-session__mc-options":"_practice-session__mc-options_i40nv_101","practice-session__mc-option":"_practice-session__mc-option_i40nv_101","practice-session__mc-option--selected":"_practice-session__mc-option--selected_i40nv_125","practice-session__mc-option--correct":"_practice-session__mc-option--correct_i40nv_130","practice-session__mc-option--incorrect":"_practice-session__mc-option--incorrect_i40nv_135","practice-session__mc-option--disabled":"_practice-session__mc-option--disabled_i40nv_140","practice-session__cloze-container":"_practice-session__cloze-container_i40nv_146","practice-session__cloze-text":"_practice-session__cloze-text_i40nv_151","practice-session__cloze-input":"_practice-session__cloze-input_i40nv_156","practice-session__cloze-feedback":"_practice-session__cloze-feedback_i40nv_162","practice-session__cloze-feedback-title":"_practice-session__cloze-feedback-title_i40nv_169","practice-session__cloze-answer":"_practice-session__cloze-answer_i40nv_176","practice-session__cloze-answer--correct":"_practice-session__cloze-answer--correct_i40nv_181","practice-session__cloze-answer--neutral":"_practice-session__cloze-answer--neutral_i40nv_185","practice-session__cloze-answer-correct":"_practice-session__cloze-answer-correct_i40nv_189","practice-session__cloze-alternatives":"_practice-session__cloze-alternatives_i40nv_193","practice-session__tf-container":"_practice-session__tf-container_i40nv_200","practice-session__tf-statement":"_practice-session__tf-statement_i40nv_208","practice-session__tf-buttons":"_practice-session__tf-buttons_i40nv_214","practice-session__tf-button":"_practice-session__tf-button_i40nv_214","practice-session__tf-button--selected":"_practice-session__tf-button--selected_i40nv_231","practice-session__tf-button--correct":"_practice-session__tf-button--correct_i40nv_236","practice-session__tf-button--incorrect":"_practice-session__tf-button--incorrect_i40nv_241","practice-session__tf-button--disabled":"_practice-session__tf-button--disabled_i40nv_246","practice-session__ordering-container":"_practice-session__ordering-container_i40nv_252","practice-session__ordering-instruction":"_practice-session__ordering-instruction_i40nv_257","practice-session__ordering-items":"_practice-session__ordering-items_i40nv_263","practice-session__ordering-item":"_practice-session__ordering-item_i40nv_263","practice-session__ordering-item--correct":"_practice-session__ordering-item--correct_i40nv_279","practice-session__ordering-item-number":"_practice-session__ordering-item-number_i40nv_284","practice-session__ordering-item-text":"_practice-session__ordering-item-text_i40nv_290","practice-session__ordering-hint":"_practice-session__ordering-hint_i40nv_294","practice-session__ordering-controls":"_practice-session__ordering-controls_i40nv_300","practice-session__ordering-btn":"_practice-session__ordering-btn_i40nv_305","practice-session__ordering-feedback":"_practice-session__ordering-feedback_i40nv_313","practice-session__ordering-feedback-title":"_practice-session__ordering-feedback-title_i40nv_320","practice-session__ordering-feedback-item":"_practice-session__ordering-feedback-item_i40nv_327","practice-session__matching-container":"_practice-session__matching-container_i40nv_335","practice-session__matching-instruction":"_practice-session__matching-instruction_i40nv_340","practice-session__matching-grid":"_practice-session__matching-grid_i40nv_346","practice-session__matching-left-item":"_practice-session__matching-left-item_i40nv_352","practice-session__matching-feedback":"_practice-session__matching-feedback_i40nv_363","practice-session__matching-feedback-title":"_practice-session__matching-feedback-title_i40nv_370","practice-session__matching-feedback-item":"_practice-session__matching-feedback-item_i40nv_377","practice-session__ms-container":"_practice-session__ms-container_i40nv_385","practice-session__ms-instruction":"_practice-session__ms-instruction_i40nv_390","practice-session__ms-options":"_practice-session__ms-options_i40nv_396","practice-session__ms-option":"_practice-session__ms-option_i40nv_396","practice-session__ms-option--selected":"_practice-session__ms-option--selected_i40nv_413","practice-session__ms-option--correct":"_practice-session__ms-option--correct_i40nv_418","practice-session__ms-option--incorrect":"_practice-session__ms-option--incorrect_i40nv_423","practice-session__ms-option-label":"_practice-session__ms-option-label_i40nv_428","practice-session__ms-status-icon":"_practice-session__ms-status-icon_i40nv_433","practice-session__ms-status-icon--correct":"_practice-session__ms-status-icon--correct_i40nv_439","practice-session__ms-status-icon--incorrect":"_practice-session__ms-status-icon--incorrect_i40nv_443","practice-session__slider-container":"_practice-session__slider-container_i40nv_449","practice-session__slider-value-display":"_practice-session__slider-value-display_i40nv_457","practice-session__slider-value":"_practice-session__slider-value_i40nv_457","practice-session__slider-value--correct":"_practice-session__slider-value--correct_i40nv_467","practice-session__slider-value--incorrect":"_practice-session__slider-value--incorrect_i40nv_471","practice-session__slider-wrapper":"_practice-session__slider-wrapper_i40nv_475","practice-session__slider-feedback":"_practice-session__slider-feedback_i40nv_479","practice-session__slider-feedback-text":"_practice-session__slider-feedback-text_i40nv_486","practice-session__slider-correct-value":"_practice-session__slider-correct-value_i40nv_492","practice-session__slider-tolerance":"_practice-session__slider-tolerance_i40nv_497","practice-session__scramble-container":"_practice-session__scramble-container_i40nv_504","practice-session__scramble-display":"_practice-session__scramble-display_i40nv_512","practice-session__scramble-label":"_practice-session__scramble-label_i40nv_519","practice-session__scramble-word":"_practice-session__scramble-word_i40nv_525","practice-session__scramble-length":"_practice-session__scramble-length_i40nv_533","practice-session__scramble-input-label":"_practice-session__scramble-input-label_i40nv_539","practice-session__scramble-input":"_practice-session__scramble-input_i40nv_539","practice-session__scramble-input--correct":"_practice-session__scramble-input--correct_i40nv_558","practice-session__scramble-input--incorrect":"_practice-session__scramble-input--incorrect_i40nv_563","practice-session__scramble-feedback":"_practice-session__scramble-feedback_i40nv_568","practice-session__scramble-feedback-label":"_practice-session__scramble-feedback-label_i40nv_575","practice-session__scramble-feedback-word":"_practice-session__scramble-feedback-word_i40nv_582","practice-session__flashcard-container":"_practice-session__flashcard-container_i40nv_590","practice-session__flashcard":"_practice-session__flashcard_i40nv_590","practice-session__flashcard-lang":"_practice-session__flashcard-lang_i40nv_618","practice-session__flashcard-front":"_practice-session__flashcard-front_i40nv_626","practice-session__flashcard-reveal-btn":"_practice-session__flashcard-reveal-btn_i40nv_639","practice-session__flashcard-divider":"_practice-session__flashcard-divider_i40nv_657","practice-session__flashcard-back":"_practice-session__flashcard-back_i40nv_664","practice-session__flashcard-assessment":"_practice-session__flashcard-assessment_i40nv_677","practice-session__flashcard-btn":"_practice-session__flashcard-btn_i40nv_685","practice-session__flashcard-btn--unknown":"_practice-session__flashcard-btn--unknown_i40nv_699","practice-session__flashcard-btn--known":"_practice-session__flashcard-btn--known_i40nv_710","practice-session__flashcard-icon":"_practice-session__flashcard-icon_i40nv_721","practice-session__flashcard-explanation":"_practice-session__flashcard-explanation_i40nv_725","practice-session__text-input-container":"_practice-session__text-input-container_i40nv_738","practice-session__text-input-wrapper":"_practice-session__text-input-wrapper_i40nv_746","practice-session__text-input":"_practice-session__text-input_i40nv_738","practice-session__text-input-feedback":"_practice-session__text-input-feedback_i40nv_758","practice-session__text-input-hint":"_practice-session__text-input-hint_i40nv_770","practice-session__feedback":"_practice-session__feedback_i40nv_781","practice-session__footer":"_practice-session__footer_i40nv_788","practice-session__actions":"_practice-session__actions_i40nv_795","practice-session__btn-submit":"_practice-session__btn-submit_i40nv_801","practice-session__btn-submit--enabled":"_practice-session__btn-submit--enabled_i40nv_810","practice-session__btn-submit--disabled":"_practice-session__btn-submit--disabled_i40nv_815","practice-session__btn-skip":"_practice-session__btn-skip_i40nv_820","practice-session__btn-next":"_practice-session__btn-next_i40nv_831","practice-session__stats":"_practice-session__stats_i40nv_844","practice-session__stat":"_practice-session__stat_i40nv_844","practice-session__stat-value":"_practice-session__stat-value_i40nv_857","practice-session__stat-value--completed":"_practice-session__stat-value--completed_i40nv_862","practice-session__stat-value--correct":"_practice-session__stat-value--correct_i40nv_866","practice-session__stat-value--accuracy":"_practice-session__stat-value--accuracy_i40nv_870","practice-session__stat-label":"_practice-session__stat-label_i40nv_874","practice-session__loading":"_practice-session__loading_i40nv_881"};function Qs({topicId:n,learningPathIds:e,targetCount:t=10,includeReview:a=!0,onComplete:c,onCancel:o}){const[l,h]=y.useState(null),[i,p]=y.useState(null),[f,N]=y.useState(0),[P,z]=y.useState(null),[_,q]=y.useState(!1),[$,oe]=y.useState(!1),[Q,ie]=y.useState(Date.now()),[W,le]=y.useState([]),[X,be]=y.useState(0),[H,ae]=y.useState([]),[v,R]=y.useState(null),[M,ne]=y.useState([]),[U,ye]=y.useState({}),[Ie,xe]=y.useState([]),[m,T]=y.useState(new Set),[F,E]=y.useState(0),[O,ve]=y.useState(""),[Ee,Oe]=y.useState(!1),[Pe,Te]=y.useState(null),[we,qe]=y.useState(""),[ss,ts]=y.useState(!1);y.useEffect(()=>{is(),Ne.initialize().then(()=>{ts(!0)})},[]),y.useEffect(()=>{l&&l.execution.taskIds.length>0&&f===0&&We()},[l]),y.useEffect(()=>{l&&l.execution.taskIds.length>0&&f>0&&We()},[f]);async function is(){const g=await new $e(Le(),je(),Ae()).createSession({topicId:n,learningPathIds:e,targetCount:t,includeReview:a});h(g)}async function We(){if(!l||f>=l.execution.taskIds.length)return;const d=l.execution.taskIds[f];if(!d)return;const g=await I.tasks.get(d);if(g)if(p(g),ie(Date.now()),z(null),R(null),ae([]),ne([]),ye({}),xe([]),T(new Set),E(0),ve(""),Oe(!1),Te(null),qe(""),g.type==="multiple-choice"){const u=g.content,b=[...u.options],x=u.correctAnswer,w=b.map((C,G)=>G);for(let C=w.length-1;C>0;C--){const G=Math.floor(Math.random()*(C+1));[w[C],w[G]]=[w[G],w[C]]}const j=w.map(C=>b[C]),k=w.findIndex(C=>C===x);le(j),be(k)}else if(g.type==="cloze-deletion"){const u=g.content;ae(new Array(u.blanks.length).fill(""))}else if(g.type==="ordering"){const b=[...g.content.items].sort(()=>Math.random()-.5);ne(b)}else if(g.type==="matching"){const b=g.content.pairs.map((x,w)=>w);for(let x=b.length-1;x>0;x--){const w=Math.floor(Math.random()*(x+1));[b[x],b[w]]=[b[w],b[x]]}xe(b),ye({})}else if(g.type==="multiple-select")T(new Set);else if(g.type==="slider"){const u=g.content;E(Math.floor((u.min+u.max)/2))}else g.type==="word-scramble"&&ve("")}async function ze(){if(!i||!l)return;let d=!1;if(i.type==="multiple-choice"){if(P===null)return;d=P===X}else if(i.type==="cloze-deletion")d=i.content.blanks.every((k,C)=>{const G=H[C]?.trim().toLowerCase()||"",De=k.correctAnswer.toLowerCase(),ke=k.alternatives?.map(bs=>bs.toLowerCase())||[];return G===De||ke.includes(G)});else if(i.type==="true-false"){if(v===null)return;const j=i.content;d=v===j.correctAnswer}else if(i.type==="ordering"){const j=i.content;d=M.every((k,C)=>{const G=j.items.indexOf(k);return j.correctOrder[C]===G})}else if(i.type==="matching")d=i.content.pairs.every((k,C)=>U[C]===C);else if(i.type==="multiple-select"){const j=i.content;if(m.size===0)return;d=j.correctAnswers.length===m.size&&j.correctAnswers.every(k=>m.has(k))}else if(i.type==="slider"){const j=i.content,k=j.tolerance||0;d=Math.abs(F-j.correctValue)<=k}else if(i.type==="word-scramble"){if(!O.trim())return;const j=i.content;d=O.trim().toLowerCase()===j.correctWord.toLowerCase()}else if(i.type==="flashcard"){if(Pe===null)return;d=Pe}else if(i.type==="text-input"){if(!we.trim())return;const j=i.content,k=j.caseSensitive||!1,C=k?we.trim():we.trim().toLowerCase(),G=k?j.correctAnswer:j.correctAnswer.toLowerCase(),De=(j.alternatives||[]).map(ke=>k?ke:ke.toLowerCase());d=C===G||De.includes(C)}oe(d),q(!0);const g=Math.round((Date.now()-Q)/1e3);await new $e(Le(),je(),Ae()).recordSessionAnswer(l.id,d,g);const b=new Is(Ae(),je()),x=d?4:2;await b.recordAnswer(i.id,d,x);const w=await I.practiceSessions.get(l.id);w&&h(w)}function as(){l&&(q(!1),z(null),f<l.execution.taskIds.length-1&&N(f+1))}function ns(){q(!1),z(null),l&&f<l.execution.taskIds.length-1?N(f+1):He()}async function He(){if(!l)return;await new $e(Le(),je(),Ae()).completeSession(l.id),await new Promise(g=>setTimeout(g,100)),c()}function de(d){return!d||!ss?!1:Ne.hasAudio(d)}function Ge(){if(_)return!1;if(i?.type==="multiple-choice")return P!==null;if(i?.type==="cloze-deletion")return H.every(d=>d.trim().length>0);if(i?.type==="true-false")return v!==null;if(i?.type==="ordering")return M.length>0;if(i?.type==="matching"){const d=i.content;return Object.keys(U).length===d.pairs.length}return i?.type==="multiple-select"?m.size>0:i?.type==="slider"?!0:i?.type==="word-scramble"?O.trim().length>0:i?.type==="flashcard"?Pe!==null:i?.type==="text-input"?we.trim().length>0:!1}function rs(){return i?i.type==="multiple-choice"?cs():i.type==="cloze-deletion"?os():i.type==="true-false"?ls():i.type==="ordering"?ds():i.type==="matching"?_s():i.type==="multiple-select"?us():i.type==="slider"?ps():i.type==="word-scramble"?hs():i.type==="flashcard"?ms():i.type==="text-input"?gs():null:null}function cs(){return!i||i.type!=="multiple-choice"?null:s.jsx("div",{className:r["practice-session__mc-options"],children:W.map((d,g)=>{const u=de(d),x=_&&g===X&&u,w=[r["practice-session__mc-option"],_&&g===X&&r["practice-session__mc-option--correct"],_&&g===P&&!$&&r["practice-session__mc-option--incorrect"],!_&&P===g&&r["practice-session__mc-option--selected"],_&&r["practice-session__mc-option--disabled"]].filter(Boolean).join(" ");return s.jsxs("button",{onClick:()=>!_&&z(g),disabled:_,className:w,children:[s.jsx("span",{children:d}),x&&s.jsx(_e,{text:d,size:"small"})]},g)})})}function os(){if(!i||i.type!=="cloze-deletion")return null;const d=i.content,g=d.text.split(/\{\{blank\}\}/g);return s.jsxs("div",{className:r["practice-session__cloze-container"],children:[s.jsx("div",{className:r["practice-session__cloze-text"],children:g.map((u,b)=>s.jsxs("span",{children:[u,b<d.blanks.length&&(()=>{const x=H[b]?.trim().toLowerCase()||"",w=x===d.blanks[b].correctAnswer.toLowerCase()||d.blanks[b].alternatives?.map(k=>k.toLowerCase()).includes(x),j=H[b]?.trim()!=="";return s.jsx(Ze,{value:H[b]||"",onChange:k=>{const C=[...H];C[b]=k.target.value,ae(C)},disabled:_,error:!!(_&&j&&!w),success:!!(_&&w),className:r["practice-session__cloze-input"]})})()]},b))}),_&&s.jsxs("div",{className:r["practice-session__cloze-feedback"],children:[s.jsx("div",{className:r["practice-session__cloze-feedback-title"],children:"Richtige Antworten:"}),d.blanks.map((u,b)=>{const x=H[b]?.trim().toLowerCase()||"",j=x===u.correctAnswer.toLowerCase()||u.alternatives?.map(k=>k.toLowerCase()).includes(x)?r["practice-session__cloze-answer--correct"]:r["practice-session__cloze-answer--neutral"];return s.jsxs("div",{className:`${r["practice-session__cloze-answer"]} ${j}`,children:["L√ºcke ",b+1,": ",s.jsx("strong",{className:r["practice-session__cloze-answer-correct"],children:u.correctAnswer}),u.alternatives&&u.alternatives.length>0&&s.jsxs("span",{className:r["practice-session__cloze-alternatives"],children:[" ","(auch richtig: ",u.alternatives.join(", "),")"]})]},b)})]})]})}function ls(){if(!i||i.type!=="true-false")return null;const d=i.content;return s.jsxs("div",{className:r["practice-session__tf-container"],children:[s.jsx("div",{className:r["practice-session__tf-statement"],children:d.statement}),s.jsx("div",{className:r["practice-session__tf-buttons"],children:[!0,!1].map(g=>{const u=[r["practice-session__tf-button"],_&&g===d.correctAnswer&&r["practice-session__tf-button--correct"],_&&g===v&&!$&&r["practice-session__tf-button--incorrect"],!_&&v===g&&r["practice-session__tf-button--selected"],_&&r["practice-session__tf-button--disabled"]].filter(Boolean).join(" ");return s.jsx("button",{onClick:()=>!_&&R(g),disabled:_,className:u,children:g?"Richtig":"Falsch"},g.toString())})})]})}function ds(){if(!i||i.type!=="ordering")return null;const d=i.content;return s.jsxs("div",{className:r["practice-session__ordering-container"],children:[s.jsx("div",{className:r["practice-session__ordering-instruction"],children:"Ordne die Elemente in die richtige Reihenfolge"}),s.jsx("div",{className:r["practice-session__ordering-items"],children:M.map((g,u)=>{const b=d.items.indexOf(g),x=_&&d.correctOrder[u]===b,w=_?d.correctOrder.indexOf(b):-1,j=[r["practice-session__ordering-item"],_&&x&&r["practice-session__ordering-item--correct"]].filter(Boolean).join(" ");return s.jsxs("div",{className:j,children:[s.jsxs("div",{className:r["practice-session__ordering-item-number"],children:[u+1,"."]}),s.jsxs("div",{className:r["practice-session__ordering-item-text"],children:[g,_&&!x&&s.jsxs("span",{className:r["practice-session__ordering-hint"],children:["‚Üí Position ",w+1]})]}),!_&&s.jsxs("div",{className:r["practice-session__ordering-controls"],children:[u>0&&s.jsx("button",{onClick:()=>{const k=[...M];[k[u],k[u-1]]=[k[u-1],k[u]],ne(k)},className:r["practice-session__ordering-btn"],children:"‚Üë"}),u<M.length-1&&s.jsx("button",{onClick:()=>{const k=[...M];[k[u],k[u+1]]=[k[u+1],k[u]],ne(k)},className:r["practice-session__ordering-btn"],children:"‚Üì"})]})]},u)})}),_&&!$&&s.jsxs("div",{className:r["practice-session__ordering-feedback"],children:[s.jsx("div",{className:r["practice-session__ordering-feedback-title"],children:"Richtige Reihenfolge:"}),d.correctOrder.map((g,u)=>s.jsxs("div",{className:r["practice-session__ordering-feedback-item"],children:[u+1,". ",s.jsx("strong",{children:d.items[g]})]},u))]})]})}function _s(){if(!i||i.type!=="matching")return null;const d=i.content;return s.jsxs("div",{className:r["practice-session__matching-container"],children:[s.jsx("div",{className:r["practice-session__matching-instruction"],children:"Ordne die passenden Paare zu"}),s.jsx("div",{className:r["practice-session__matching-grid"],children:d.pairs.map((g,u)=>{const b=_&&U[u]===u,x=U[u]!==void 0&&U[u]!==null;return s.jsxs(fe.Fragment,{children:[s.jsxs("div",{className:r["practice-session__matching-left-item"],children:[s.jsx("span",{children:g.left}),de(g.left)&&s.jsx(_e,{text:g.left,size:"small"})]}),s.jsx(Ks,{value:U[u]?.toString()??"",onChange:w=>{const j=parseInt(w);ye({...U,[u]:j})},options:Ie.map(w=>({value:w.toString(),label:d.pairs[w].right})),disabled:_,placeholder:"W√§hle...",error:_&&x&&!b,success:_&&b,fullWidth:!0})]},u)})}),_&&!$&&s.jsxs("div",{className:r["practice-session__matching-feedback"],children:[s.jsx("div",{className:r["practice-session__matching-feedback-title"],children:"Richtige Zuordnungen:"}),d.pairs.map((g,u)=>s.jsxs("div",{className:r["practice-session__matching-feedback-item"],children:[s.jsx("strong",{children:g.left})," ‚Üí ",s.jsx("strong",{children:g.right})]},u))]})]})}function us(){if(!i||i.type!=="multiple-select")return null;const d=i.content,g=u=>{if(_)return;const b=new Set(m);b.has(u)?b.delete(u):b.add(u),T(b)};return s.jsxs("div",{className:r["practice-session__ms-container"],children:[s.jsx("div",{className:r["practice-session__ms-instruction"],children:"W√§hle alle zutreffenden Antworten"}),s.jsx("div",{className:r["practice-session__ms-options"],children:d.options.map((u,b)=>{const x=m.has(b),w=d.correctAnswers.includes(b);let j="";_&&(w?j=x?"‚úì":"‚óã":x&&!w&&(j="‚úó"));const k=[r["practice-session__ms-option"],_&&w&&r["practice-session__ms-option--correct"],_&&x&&!w&&r["practice-session__ms-option--incorrect"],!_&&x&&r["practice-session__ms-option--selected"]].filter(Boolean).join(" "),C=w?r["practice-session__ms-status-icon--correct"]:r["practice-session__ms-status-icon--incorrect"];return s.jsxs("div",{className:k,children:[s.jsx(Us,{checked:x,onChange:()=>g(b),disabled:_,label:s.jsx("span",{className:r["practice-session__ms-option-label"],children:u}),error:_&&x&&!w,success:_&&w&&x,style:{flex:1}}),_&&j&&s.jsx("span",{className:`${r["practice-session__ms-status-icon"]} ${C}`,children:j})]},b)})})]})}function ps(){if(!i||i.type!=="slider")return null;const d=i.content,g=d.step||1,u=d.tolerance||0,b=Math.abs(F-d.correctValue)<=u,x=_?b?r["practice-session__slider-value--correct"]:r["practice-session__slider-value--incorrect"]:"";return s.jsxs("div",{className:r["practice-session__slider-container"],children:[s.jsx("div",{className:r["practice-session__slider-value-display"],children:s.jsxs("div",{className:`${r["practice-session__slider-value"]} ${x}`,children:[F,d.unit||""]})}),s.jsx("div",{className:r["practice-session__slider-wrapper"],children:s.jsx(Ys,{value:F,onChange:E,min:d.min,max:d.max,step:g,disabled:_,unit:d.unit||"",showValue:!1})}),_&&s.jsx("div",{className:r["practice-session__slider-feedback"],children:s.jsxs("div",{className:r["practice-session__slider-feedback-text"],children:["Richtige Antwort: ",s.jsxs("strong",{className:r["practice-session__slider-correct-value"],children:[d.correctValue,d.unit||""]}),u>0&&s.jsxs("span",{className:r["practice-session__slider-tolerance"],children:[" ","(¬±",u,")"]})]})})]})}function hs(){if(!i||i.type!=="word-scramble")return null;const d=i.content,g=O.trim().toLowerCase()===d.correctWord.toLowerCase(),u=O.trim()!=="",b=_?g?r["practice-session__scramble-input--correct"]:u?r["practice-session__scramble-input--incorrect"]:"":"";return s.jsxs("div",{className:r["practice-session__scramble-container"],children:[s.jsxs("div",{className:r["practice-session__scramble-display"],children:[s.jsx("div",{className:r["practice-session__scramble-label"],children:"Buchstabensalat:"}),s.jsx("div",{className:r["practice-session__scramble-word"],children:d.scrambledWord}),d.showLength&&s.jsxs("div",{className:r["practice-session__scramble-length"],children:["(",d.correctWord.length," Buchstaben)"]})]}),s.jsxs("div",{children:[s.jsx("label",{className:r["practice-session__scramble-input-label"],children:"Deine L√∂sung:"}),s.jsx("input",{type:"text",value:O,onChange:x=>ve(x.target.value),disabled:_,placeholder:"Entschl√ºssle das Wort...",className:`${r["practice-session__scramble-input"]} ${b}`})]}),_&&!$&&s.jsxs("div",{className:r["practice-session__scramble-feedback"],children:[s.jsx("div",{className:r["practice-session__scramble-feedback-label"],children:"Richtige L√∂sung:"}),s.jsx("div",{className:r["practice-session__scramble-feedback-word"],children:d.correctWord})]})]})}function ms(){if(!i||i.type!=="flashcard")return null;const d=i.content;return s.jsxs("div",{className:r["practice-session__flashcard-container"],children:[s.jsxs("div",{className:r["practice-session__flashcard"],children:[s.jsx("div",{className:r["practice-session__flashcard-lang"],children:d.frontLanguage==="de"?"Deutsch":d.frontLanguage==="es"?"Espa√±ol":"English"}),s.jsxs("div",{className:r["practice-session__flashcard-front"],children:[s.jsx("div",{children:d.front}),de(d.front)&&s.jsx(_e,{text:d.front,size:"large"})]}),Ee?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:r["practice-session__flashcard-divider"]}),s.jsx("div",{className:r["practice-session__flashcard-lang"],children:d.backLanguage==="de"?"Deutsch":d.backLanguage==="es"?"Espa√±ol":"English"}),s.jsxs("div",{className:r["practice-session__flashcard-back"],children:[s.jsx("div",{children:d.back}),de(d.back)&&s.jsx(_e,{text:d.back,size:"large"})]})]}):s.jsx("button",{onClick:()=>Oe(!0),disabled:_,className:r["practice-session__flashcard-reveal-btn"],children:"Ergebnis anzeigen"})]}),Ee&&!_&&s.jsxs("div",{className:r["practice-session__flashcard-assessment"],children:[s.jsxs("button",{onClick:()=>{Te(!1),ze()},className:`${r["practice-session__flashcard-btn"]} ${r["practice-session__flashcard-btn--unknown"]}`,children:[s.jsx("span",{className:r["practice-session__flashcard-icon"],children:"‚úó"}),s.jsx("span",{children:"Nicht gewusst"})]}),s.jsxs("button",{onClick:()=>{Te(!0),ze()},className:`${r["practice-session__flashcard-btn"]} ${r["practice-session__flashcard-btn--known"]}`,children:[s.jsx("span",{className:r["practice-session__flashcard-icon"],children:"‚úì"}),s.jsx("span",{children:"Gewusst"})]})]}),_&&d.explanation&&s.jsxs("div",{className:r["practice-session__flashcard-explanation"],children:[s.jsx("strong",{children:"Hinweis:"})," ",d.explanation]})]})}function gs(){if(!i||i.type!=="text-input")return null;const d=i.content;return s.jsxs("div",{className:r["practice-session__text-input-container"],children:[s.jsxs("div",{className:r["practice-session__text-input-wrapper"],children:[s.jsx(Ze,{value:we,onChange:g=>qe(g.target.value),disabled:_,placeholder:"Deine Antwort...",error:_&&!$,success:_&&$,fullWidth:!0,className:r["practice-session__text-input"]}),_&&!$&&s.jsxs("div",{className:r["practice-session__text-input-feedback"],children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Richtige Antwort:"})," ",d.correctAnswer]}),de(d.correctAnswer)&&s.jsx(_e,{text:d.correctAnswer,size:"small"})]})]}),d.hint&&!_&&s.jsxs("div",{className:r["practice-session__text-input-hint"],children:["üí° ",s.jsx("strong",{children:"Tipp:"})," ",d.hint]})]})}if(!l||!i)return s.jsx("div",{className:r["practice-session__loading"],children:s.jsx("p",{children:"Wird geladen..."})});const fs=(f+1)/l.execution.taskIds.length*100;return s.jsxs("div",{className:r["practice-session"],children:[s.jsxs("div",{className:r["practice-session__header"],children:[s.jsxs("div",{className:r["practice-session__header-top"],children:[s.jsxs("div",{className:r["practice-session__header-left"],children:[s.jsx("h2",{className:r["practice-session__title"],children:"√úbungssitzung"}),s.jsxs("span",{className:r["practice-session__task-counter"],children:[f+1,"/",l.execution.taskIds.length]}),s.jsxs("span",{className:r["practice-session__task-id"],children:["ID: ",i.id]})]}),s.jsx("button",{onClick:o,className:r["practice-session__cancel-btn"],children:"Abbrechen"})]}),s.jsx("div",{className:r["practice-session__progress-bar"],children:s.jsx("div",{className:r["practice-session__progress-fill"],style:{width:`${fs}%`}})})]}),s.jsxs("div",{className:r["practice-session__question-area"],children:[(i.type==="multiple-choice"||i.type==="ordering"||i.type==="matching"||i.type==="multiple-select"||i.type==="slider"||i.type==="word-scramble"||i.type==="text-input")&&s.jsxs("div",{className:r["practice-session__question-header"],children:[s.jsx("h3",{className:r["practice-session__question-text"],children:i.content.question}),de(i.content.question)&&s.jsx(_e,{text:i.content.question,size:"medium"})]}),rs()]}),_&&s.jsx("div",{className:r["practice-session__feedback"],children:s.jsx(es,{variant:$?"success":"error",title:$?"Richtig!":"Nicht ganz richtig",children:i.content.explanation&&s.jsx("p",{style:{margin:0},children:i.content.explanation})})}),s.jsxs("div",{className:r["practice-session__footer"],children:[s.jsx("div",{className:r["practice-session__actions"],children:_?s.jsx("button",{onClick:ns,className:r["practice-session__btn-next"],children:f<l.execution.taskIds.length-1?"N√§chste Aufgabe ‚Üí":"Sitzung beenden"}):s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:ze,disabled:!Ge(),className:Ge()?`${r["practice-session__btn-submit"]} ${r["practice-session__btn-submit--enabled"]}`:`${r["practice-session__btn-submit"]} ${r["practice-session__btn-submit--disabled"]}`,children:"Antwort √ºberpr√ºfen"}),s.jsx("button",{onClick:f<l.execution.taskIds.length-1?as:He,className:r["practice-session__btn-skip"],children:f<l.execution.taskIds.length-1?"√úberspringen ‚Üí":"Sitzung beenden"})]})}),s.jsxs("div",{className:r["practice-session__stats"],children:[s.jsxs("div",{className:r["practice-session__stat"],children:[s.jsx("div",{className:`${r["practice-session__stat-value"]} ${r["practice-session__stat-value--completed"]}`,children:l.execution.completedCount}),s.jsx("div",{className:r["practice-session__stat-label"],children:"beantwortet"})]}),s.jsxs("div",{className:r["practice-session__stat"],children:[s.jsx("div",{className:`${r["practice-session__stat-value"]} ${r["practice-session__stat-value--correct"]}`,children:l.execution.correctCount}),s.jsx("div",{className:r["practice-session__stat-label"],children:"richtig"})]}),s.jsxs("div",{className:r["practice-session__stat"],children:[s.jsxs("div",{className:`${r["practice-session__stat-value"]} ${r["practice-session__stat-value--accuracy"]}`,children:[l.execution.completedCount>0?Math.round(l.execution.correctCount/l.execution.completedCount*100):0,"%"]}),s.jsx("div",{className:r["practice-session__stat-label"],children:"genau"})]})]})]})]})}const pe={"stat-card__container":"_stat-card__container_jhf3g_4","stat-card__header":"_stat-card__header_jhf3g_11","stat-card__title":"_stat-card__title_jhf3g_18","stat-card__icon":"_stat-card__icon_jhf3g_28","stat-card__value":"_stat-card__value_jhf3g_35","stat-card__subtitle":"_stat-card__subtitle_jhf3g_43"};function te({title:n,value:e,subtitle:t,color:a=A.primary[500],icon:c,className:o,style:l,...h}){return s.jsx(ce,{...h,padding:"medium",shadow:!0,border:!0,style:{borderLeft:`4px solid ${a}`,...l},className:o,children:s.jsxs("div",{className:pe["stat-card__container"],children:[s.jsxs("div",{className:pe["stat-card__header"],children:[s.jsx("h3",{className:pe["stat-card__title"],children:n}),c&&s.jsx("div",{className:pe["stat-card__icon"],style:{color:a},children:c})]}),s.jsx("div",{className:pe["stat-card__value"],children:e}),t&&s.jsx("div",{className:pe["stat-card__subtitle"],children:t})]})})}const Xs="_button_1pgvq_4",et="_button__icon_1pgvq_115",st="_button__spinner_1pgvq_130",tt="_spin_1pgvq_1",se={button:Xs,"button--loading":"_button--loading_1pgvq_21","button--full-width":"_button--full-width_1pgvq_27","button--primary":"_button--primary_1pgvq_32","button--secondary":"_button--secondary_1pgvq_47","button--ghost":"_button--ghost_1pgvq_62","button--danger":"_button--danger_1pgvq_79","button--small":"_button--small_1pgvq_94","button--medium":"_button--medium_1pgvq_101","button--large":"_button--large_1pgvq_108",button__icon:et,button__spinner:st,spin:tt};function Re({variant:n="primary",size:e="medium",loading:t=!1,fullWidth:a=!1,disabled:c=!1,startIcon:o,endIcon:l,children:h,className:i,...p}){return s.jsx("button",{...p,disabled:c||t,className:D(se.button,se[`button--${n}`],se[`button--${e}`],t&&se["button--loading"],a&&se["button--full-width"],i),children:t?s.jsxs(s.Fragment,{children:[s.jsx(it,{size:e}),h]}):s.jsxs(s.Fragment,{children:[o&&s.jsx("span",{className:se.button__icon,children:o}),h,l&&s.jsx("span",{className:se.button__icon,children:l})]})})}function it({size:n}){const e=n==="small"?"12px":n==="large"?"18px":"16px";return s.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:se.button__spinner,children:[s.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeDasharray:"31.4 31.4",opacity:"0.25"}),s.jsx("path",{d:"M12 2a10 10 0 0 1 10 10",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round"})]})}const B={"session-results":"_session-results_p4d1d_4","session-results__header":"_session-results__header_p4d1d_12","session-results__emoji":"_session-results__emoji_p4d1d_16","session-results__title":"_session-results__title_p4d1d_21","session-results__rating":"_session-results__rating_p4d1d_25","session-results__stats":"_session-results__stats_p4d1d_32","session-results__time-card":"_session-results__time-card_p4d1d_40","session-results__time-text":"_session-results__time-text_p4d1d_45","session-results__progress-card":"_session-results__progress-card_p4d1d_51","session-results__progress-title":"_session-results__progress-title_p4d1d_55","session-results__progress-text":"_session-results__progress-text_p4d1d_59","session-results__sr-card":"_session-results__sr-card_p4d1d_67","session-results__sr-title":"_session-results__sr-title_p4d1d_71","session-results__sr-text":"_session-results__sr-text_p4d1d_75","session-results__actions":"_session-results__actions_p4d1d_82"};function at({session:n,onClose:e,onStartNew:t}){const a=n.results.accuracy,c=Math.round(n.results.averageTime);let o="",l="";a>=90?(o="Ausgezeichnet!",l=A.success[500]):a>=75?(o="Sehr gut!",l=A.primary[500]):a>=60?(o="Gut gemacht!",l=A.warning[500]):(o="Weiter √ºben!",l=A.error[500]);function h(i){const p=Math.floor(i/60),f=i%60;return p>0?`${p}:${f.toString().padStart(2,"0")} min`:`${f} sek`}return s.jsxs("div",{className:B["session-results"],children:[s.jsxs("div",{className:B["session-results__header"],children:[s.jsx("div",{className:B["session-results__emoji"],children:"üéâ"}),s.jsx("h1",{className:B["session-results__title"],children:"Sitzung abgeschlossen!"}),s.jsx("p",{className:B["session-results__rating"],style:{color:l},children:o})]}),s.jsxs("div",{className:B["session-results__stats"],children:[s.jsx(te,{title:"Aufgaben bearbeitet",value:n.execution.completedCount,color:A.primary[500]}),s.jsx(te,{title:"Richtige Antworten",value:n.execution.correctCount,color:A.success[500]}),s.jsx(te,{title:"Genauigkeit",value:`${Math.round(a)}%`,color:l}),s.jsx(te,{title:"√ò Zeit pro Aufgabe",value:h(c),color:A.warning[500]})]}),s.jsx(ce,{padding:"medium",className:B["session-results__time-card"],children:s.jsxs("p",{className:B["session-results__time-text"],children:[s.jsx("strong",{children:"Gesamtzeit:"})," ",h(n.execution.totalTimeSpent)]})}),s.jsxs(ce,{padding:"large",className:B["session-results__progress-card"],children:[s.jsx("h3",{className:B["session-results__progress-title"],children:"üìà Dein Fortschritt"}),s.jsxs("p",{className:B["session-results__progress-text"],children:[a>=90&&"Hervorragende Leistung! Du beherrschst dieses Thema sehr gut.",a>=75&&a<90&&"Sehr gute Arbeit! Du machst gro√üe Fortschritte.",a>=60&&a<75&&"Gute Arbeit! Weiter so, du verbesserst dich stetig.",a<60&&"Bleib dran! √úbung macht den Meister. Die n√§chste Sitzung wird noch besser!"]})]}),s.jsxs(es,{variant:"success",className:B["session-results__sr-card"],children:[s.jsx("h4",{className:B["session-results__sr-title"],children:"üß† Spaced Repetition aktiviert"}),s.jsx("p",{className:B["session-results__sr-text"],children:"Deine Antworten wurden gespeichert. Aufgaben, die du nicht sofort beherrscht hast, werden dir in optimalen Abst√§nden wieder vorgelegt, um dein Langzeitged√§chtnis zu trainieren."})]}),s.jsxs("div",{className:B["session-results__actions"],children:[s.jsx(Re,{onClick:t,variant:"primary",children:"Neue Sitzung starten"}),s.jsx(Re,{onClick:e,variant:"secondary",children:"Zur√ºck zur √úbersicht"})]})]})}const he={"mastery-bar":"_mastery-bar_csvhg_4","mastery-bar__header":"_mastery-bar__header_csvhg_9","mastery-bar__label":"_mastery-bar__label_csvhg_16","mastery-bar__count":"_mastery-bar__count_csvhg_22","mastery-bar__track":"_mastery-bar__track_csvhg_28","mastery-bar__fill":"_mastery-bar__fill_csvhg_36"};function Be({label:n,count:e,color:t,max:a}){const c=a&&a>0?e/a*100:e>0?100:0;return s.jsxs("div",{className:he["mastery-bar"],children:[s.jsxs("div",{className:he["mastery-bar__header"],children:[s.jsx("span",{className:he["mastery-bar__label"],children:n}),s.jsx("span",{className:he["mastery-bar__count"],children:e})]}),s.jsx("div",{className:he["mastery-bar__track"],children:s.jsx("div",{className:he["mastery-bar__fill"],style:{background:t,width:`${c}%`}})})]})}const nt="_dashboard_1oze0_4",rt="_dashboard__empty_1oze0_12",ct="_dashboard__header_1oze0_22",ot="_dashboard__title_1oze0_26",lt="_dashboard__subtitle_1oze0_30",dt="_dashboard__metrics_1oze0_36",S={dashboard:nt,dashboard__empty:rt,"dashboard__back-button":"_dashboard__back-button_1oze0_17",dashboard__header:ct,dashboard__title:ot,dashboard__subtitle:lt,dashboard__metrics:dt,"dashboard__mastery-card":"_dashboard__mastery-card_1oze0_44","dashboard__mastery-title":"_dashboard__mastery-title_1oze0_48","dashboard__mastery-bars":"_dashboard__mastery-bars_1oze0_52","dashboard__topic-card":"_dashboard__topic-card_1oze0_59","dashboard__topic-title":"_dashboard__topic-title_1oze0_63","dashboard__topic-grid":"_dashboard__topic-grid_1oze0_67","dashboard__topic-item":"_dashboard__topic-item_1oze0_75","dashboard__topic-header":"_dashboard__topic-header_1oze0_79","dashboard__topic-name":"_dashboard__topic-name_1oze0_85","dashboard__topic-meta":"_dashboard__topic-meta_1oze0_89","dashboard__topic-bar-container":"_dashboard__topic-bar-container_1oze0_94","dashboard__topic-bar-fill":"_dashboard__topic-bar-fill_1oze0_101","dashboard__topic-stats":"_dashboard__topic-stats_1oze0_106","dashboard__sessions-title":"_dashboard__sessions-title_1oze0_113","dashboard__sessions-list":"_dashboard__sessions-list_1oze0_117","dashboard__session-item":"_dashboard__session-item_1oze0_125","dashboard__session-left":"_dashboard__session-left_1oze0_134","dashboard__session-topic":"_dashboard__session-topic_1oze0_138","dashboard__session-date":"_dashboard__session-date_1oze0_142","dashboard__session-right":"_dashboard__session-right_1oze0_147","dashboard__session-accuracy":"_dashboard__session-accuracy_1oze0_151","dashboard__session-stats":"_dashboard__session-stats_1oze0_155"};function _t({onClose:n}){const[e,t]=y.useState(null),[a,c]=y.useState(!0);y.useEffect(()=>{o()},[]);async function o(){try{const i=await I.practiceSessions.toArray(),p=i.filter(v=>v.execution.status==="completed"),f=await I.topics.toArray(),N=new Map(f.map(v=>[v.id,v])),P=await I.spacedRepetition.toArray(),z=p.reduce((v,R)=>v+(R.execution?.completedCount||0),0),_=p.reduce((v,R)=>v+(R.execution?.correctCount||0),0),q=z>0?_/z*100:0,$=p.reduce((v,R)=>R.execution.startedAt&&R.execution.completedAt?v+(new Date(R.execution.completedAt).getTime()-new Date(R.execution.startedAt).getTime())/1e3:v,0),oe=p.length>0?$/p.length:0,Q=new Map;for(const v of p){const R=v.configuration.topicId;Q.has(R)||Q.set(R,{sessions:0,correct:0,total:0});const M=Q.get(R);M.sessions++,M.correct+=v.execution?.correctCount||0,M.total+=v.execution?.completedCount||0}const ie=Array.from(Q.entries()).map(([v,R])=>({topicId:v,topicName:N.get(v)?.title||v,sessionsCompleted:R.sessions,accuracy:R.total>0?R.correct/R.total*100:0,tasksReviewed:R.total})),W=new Date,le=P.filter(v=>v.algorithm.efactor>=2.5).length,X=P.filter(v=>v.algorithm.efactor<2.5&&v.algorithm.repetition>0).length,be=P.filter(v=>v.algorithm.repetition===0).length,H=P.filter(v=>new Date(v.schedule.nextReview)<=W).length,ae=p.sort((v,R)=>{const M=v.execution.completedAt?new Date(v.execution.completedAt).getTime():0;return(R.execution.completedAt?new Date(R.execution.completedAt).getTime():0)-M}).slice(0,5);t({totalSessions:i.length,completedSessions:p.length,totalQuestions:z,correctAnswers:_,accuracyRate:q,averageSessionTime:oe,currentStreak:0,totalStudyTime:$,topicProgress:ie,recentSessions:ae,upcomingReviews:H,masteryLevels:{mastered:le,learning:X,new:be}})}catch(i){console.error("Failed to load dashboard stats:",i)}finally{c(!1)}}function l(i){const p=Math.floor(i/3600),f=Math.floor(i%3600/60);return p>0?`${p}h ${f}m`:`${f}m`}function h(i){return(typeof i=="string"?new Date(i):i).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric"})}return a?s.jsxs("div",{className:S.dashboard__empty,style:{textAlign:"center"},children:[s.jsx("h1",{children:"üìä Dashboard"}),s.jsx("p",{children:"Lade Statistiken..."})]}):e?s.jsxs("div",{className:S.dashboard,children:[s.jsxs("div",{className:S.dashboard__header,children:[s.jsx(Re,{variant:"secondary",onClick:n,className:S["dashboard__back-button"],children:"‚Üê Zur√ºck"}),s.jsx("h1",{className:S.dashboard__title,children:"üìä Lern-Dashboard"}),s.jsx("p",{className:S.dashboard__subtitle,children:"Deine Fortschritte und Statistiken im √úberblick"})]}),s.jsxs("div",{className:S.dashboard__metrics,children:[s.jsx(te,{title:"Gesamt Sitzungen",value:e.completedSessions.toString(),subtitle:`von ${e.totalSessions} gestartet`,color:A.primary[500]}),s.jsx(te,{title:"Genauigkeit",value:`${Math.round(e.accuracyRate)}%`,subtitle:`${e.correctAnswers}/${e.totalQuestions} richtig`,color:A.success[500]}),s.jsx(te,{title:"Lernzeit",value:l(e.totalStudyTime),subtitle:`√ò ${l(e.averageSessionTime)} pro Sitzung`,color:A.warning[500]}),s.jsx(te,{title:"Anstehende Wiederholungen",value:e.upcomingReviews.toString(),subtitle:"bereit zum √úben",color:A.info[500]})]}),s.jsxs(ce,{padding:"medium",className:S["dashboard__mastery-card"],children:[s.jsx("h2",{className:S["dashboard__mastery-title"],children:"üéØ Beherrschungsniveau"}),s.jsxs("div",{className:S["dashboard__mastery-bars"],children:[s.jsx(Be,{label:"Gemeistert",count:e.masteryLevels.mastered,color:A.success[500]}),s.jsx(Be,{label:"In Arbeit",count:e.masteryLevels.learning,color:A.warning[500]}),s.jsx(Be,{label:"Neu",count:e.masteryLevels.new,color:A.primary[500]})]})]}),e.topicProgress.length>0&&s.jsxs(ce,{padding:"medium",className:S["dashboard__topic-card"],children:[s.jsx("h2",{className:S["dashboard__topic-title"],children:"üìö Fortschritt nach Thema"}),s.jsx("div",{className:S["dashboard__topic-grid"],children:e.topicProgress.map(i=>s.jsxs("div",{className:S["dashboard__topic-item"],children:[s.jsxs("div",{className:S["dashboard__topic-header"],children:[s.jsx("span",{className:S["dashboard__topic-name"],children:i.topicName}),s.jsxs("span",{className:S["dashboard__topic-meta"],children:[i.sessionsCompleted," Sitzungen ‚Ä¢ ",Math.round(i.accuracy),"% genau"]})]}),s.jsx("div",{className:S["dashboard__topic-bar-container"],children:s.jsx("div",{className:S["dashboard__topic-bar-fill"],style:{background:i.accuracy>=75?A.success[500]:i.accuracy>=50?A.warning[500]:A.error[500],width:`${i.accuracy}%`}})}),s.jsxs("div",{className:S["dashboard__topic-stats"],children:[i.tasksReviewed," Aufgaben bearbeitet"]})]},i.topicId))})]}),e.recentSessions.length>0&&s.jsxs(ce,{padding:"medium",children:[s.jsx("h2",{className:S["dashboard__sessions-title"],children:"üïê Letzte Sitzungen"}),s.jsx("div",{className:S["dashboard__sessions-list"],children:e.recentSessions.map(i=>s.jsxs("div",{className:S["dashboard__session-item"],children:[s.jsxs("div",{className:S["dashboard__session-left"],children:[s.jsx("div",{className:S["dashboard__session-topic"],children:i.configuration.topicId}),s.jsx("div",{className:S["dashboard__session-date"],children:i.execution.completedAt&&h(i.execution.completedAt)})]}),s.jsxs("div",{className:S["dashboard__session-right"],children:[s.jsxs("div",{className:S["dashboard__session-accuracy"],style:{color:i.results.accuracy>=75?A.success[500]:A.warning[500]},children:[Math.round(i.results.accuracy),"%"]}),s.jsxs("div",{className:S["dashboard__session-stats"],children:[i.execution.correctCount,"/",i.execution.completedCount]})]})]},i.id))})]})]}):s.jsxs("div",{className:S.dashboard__empty,children:[s.jsx(Re,{variant:"secondary",onClick:n,className:S["dashboard__back-button"],children:"‚Üê Zur√ºck"}),s.jsx("h1",{children:"üìä Dashboard"}),s.jsx("p",{children:"Keine Daten verf√ºgbar."})]})}const ut=({topic:n,onSelect:e,className:t,disabled:a=!1,"data-testid":c})=>{const[o,l]=fe.useState(!1),h={padding:"2rem",background:n.color||"#dbeafe",borderRadius:"12px",cursor:a?"not-allowed":"pointer",transition:"transform 0.2s, box-shadow 0.2s",border:"2px solid transparent",borderColor:o?"#3b82f6":"transparent",transform:o&&!a?"translateY(-4px)":"translateY(0)",boxShadow:o&&!a?"0 10px 25px rgba(0,0,0,0.1)":"none",opacity:a?.5:1},i=`Thema ${n.name} √∂ffnen - ${n.description}`;return s.jsxs("button",{type:"button",onClick:()=>e(n.id),className:t,"data-testid":c,style:h,onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),disabled:a,"aria-label":i,children:[n.icon&&s.jsx("span",{"aria-hidden":"true",style:{fontSize:"48px",display:"block",marginBottom:"16px"},children:n.icon}),s.jsx("h3",{style:{fontSize:"20px",fontWeight:600,marginBottom:"8px"},children:n.name}),s.jsx("p",{style:{fontSize:"14px",color:"#666",lineHeight:1.5,margin:0},children:n.description})]})};function pt(){const[n,e]=y.useState([]),[t,a]=y.useState(null),[c,o]=y.useState([]),[l,h]=y.useState({}),[i,p]=y.useState(null),[f,N]=y.useState(!0),[P,z]=y.useState(!1),[_,q]=y.useState(null),[$,oe]=y.useState(!1),[Q,ie]=y.useState(!1),[W,le]=y.useState({targetCount:10,includeReview:!0}),X=y.useRef(!1);y.useEffect(()=>{X.current||(X.current=!0,be())},[]);async function be(){try{const m=await I.topics.count(),T=await I.tasks.count();console.log(`Database status: ${m} topics, ${T} tasks`),m===0||T===0?(console.log("Database empty or incomplete, seeding..."),await Ve(I)):console.log("Database already seeded, skipping seed");const F=await I.topics.toArray();e(F),N(!1)}catch(m){console.error("Failed to initialize app:",m),console.error("Error details:",{name:m?.name,message:m?.message,failures:m?.failures,stack:m?.stack}),N(!1)}}async function H(m){a(m);const T=await I.learningPaths.where("topicId").equals(m.id).toArray();console.log(`Loading learning paths for topic ${m.id}:`,T),T.sort((E,O)=>new Date(O.createdAt).getTime()-new Date(E.createdAt).getTime());const F={};for(const E of T){const O=await I.tasks.where("learningPathId").equals(E.id).toArray();F[E.id]=O.length,console.log(`Learning path "${E.title}" (${E.id}): ${O.length} tasks in DB, taskIds array length: ${E.taskIds?.length||0}`),console.log("Task IDs:",O.map(ve=>ve.id))}h(F),o(T)}function ae(m){p(m),ie(!0)}function v(){ie(!1),z(!0)}function R(){ie(!1),p(null)}async function M(){if(z(!1),i&&t){const m=await I.practiceSessions.where("execution.status").equals("completed").reverse().limit(1).toArray();m.length>0&&m[0]&&q(m[0])}}function ne(){z(!1),p(null)}function U(){q(null)}function ye(){q(null),i&&z(!0)}if(f)return s.jsxs("div",{style:{padding:"2rem",fontFamily:"system-ui, sans-serif",textAlign:"center"},children:[s.jsx("h1",{children:"üß† MindForge Academy"}),s.jsx("p",{children:"Wird geladen..."})]});if($)return s.jsx("div",{style:{fontFamily:"system-ui, sans-serif"},children:s.jsx(_t,{onClose:()=>oe(!1)})});if(_)return s.jsx("div",{style:{fontFamily:"system-ui, sans-serif"},children:s.jsx(at,{session:_,onClose:U,onStartNew:ye})});if(Q&&i&&t)return s.jsxs("div",{style:{padding:"2rem",fontFamily:"system-ui, sans-serif",maxWidth:"600px",margin:"0 auto"},children:[s.jsx("button",{onClick:R,style:{padding:"0.5rem 1rem",background:"#e5e7eb",border:"none",borderRadius:"4px",cursor:"pointer",marginBottom:"1rem"},children:"‚Üê Zur√ºck"}),s.jsx("h1",{style:{marginBottom:"0.5rem"},children:"Sitzung konfigurieren"}),s.jsx("p",{style:{color:"#6b7280",marginBottom:"2rem"},children:i.title}),s.jsxs("div",{style:{marginBottom:"2rem"},children:[s.jsx("label",{style:{display:"block",fontWeight:"500",marginBottom:"0.5rem"},children:"Anzahl der Fragen"}),s.jsx("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[5,10,15,20].map(m=>s.jsx("button",{onClick:()=>le({...W,targetCount:m}),style:{padding:"0.75rem 1.5rem",background:W.targetCount===m?"#3b82f6":"#f3f4f6",color:W.targetCount===m?"white":"#374151",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"1rem",fontWeight:"500"},children:m},m))})]}),s.jsxs("div",{style:{marginBottom:"2rem"},children:[s.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[s.jsx("input",{type:"checkbox",checked:W.includeReview,onChange:m=>le({...W,includeReview:m.target.checked}),style:{marginRight:"0.5rem",width:"1.25rem",height:"1.25rem",cursor:"pointer"}}),s.jsx("span",{children:"Wiederholungsfragen einbeziehen"})]}),s.jsx("p",{style:{fontSize:"0.875rem",color:"#6b7280",marginTop:"0.5rem",marginLeft:"1.75rem"},children:"Fragen, die du bereits beantwortet hast und die zur Wiederholung f√§llig sind"})]}),s.jsx("button",{onClick:v,style:{padding:"1rem 2rem",background:"#3b82f6",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"1.1rem",fontWeight:"500",width:"100%"},children:"Sitzung starten ‚Üí"})]});if(P&&i&&t)return s.jsx("div",{style:{fontFamily:"system-ui, sans-serif"},children:s.jsx(Qs,{topicId:t.id,learningPathIds:[i.id],targetCount:W.targetCount,includeReview:W.includeReview,onComplete:M,onCancel:ne})});if(t)return s.jsxs("div",{style:{padding:"2rem",fontFamily:"system-ui, sans-serif"},children:[s.jsx("button",{onClick:()=>a(null),style:{padding:"0.5rem 1rem",background:"#e5e7eb",border:"none",borderRadius:"4px",cursor:"pointer",marginBottom:"1rem"},children:"‚Üê Zur√ºck zu Themen"}),s.jsxs("h1",{children:["üìö ",t.title]}),s.jsx("h2",{style:{marginTop:"2rem",marginBottom:"1rem"},children:"Lernpfade"}),s.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"1rem"},children:c.map(m=>s.jsxs("div",{style:{padding:"1.5rem",background:"#ffffff",border:"2px solid #e5e7eb",borderRadius:"8px",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:T=>{T.currentTarget.style.borderColor="#3b82f6",T.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:T=>{T.currentTarget.style.borderColor="#e5e7eb",T.currentTarget.style.transform="translateY(0)"},children:[s.jsx("h3",{style:{marginBottom:"0.5rem"},children:m.title}),s.jsx("p",{style:{fontSize:"0.9rem",color:"#6b7280",marginBottom:"1rem"},children:m.description}),s.jsxs("div",{style:{fontSize:"0.85rem",color:"#9ca3af"},children:[s.jsx("span",{style:{marginRight:"1rem"},children:m.difficulty==="easy"?"üü¢ Leicht":m.difficulty==="medium"?"üü° Mittel":"üî¥ Schwer"}),s.jsxs("span",{children:[l[m.id]||m.taskIds?.length||0," Aufgaben"]})]}),s.jsx("button",{onClick:()=>ae(m),style:{marginTop:"1rem",padding:"0.5rem 1rem",background:"#3b82f6",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",width:"100%"},children:"Lernpfad starten ‚Üí"})]},m.id))})]});async function Ie(){if(confirm("Datenbank neu laden? Dies wird alle Lernpfade aktualisieren, aber dein Fortschritt bleibt erhalten."))try{await I.topics.clear(),await I.learningPaths.clear(),await I.tasks.clear(),await Ve(I);const m=await I.topics.toArray();e(m),alert("‚úÖ Datenbank erfolgreich aktualisiert!")}catch(m){console.error("Reseed failed:",m),alert("‚ùå Fehler beim Aktualisieren der Datenbank")}}function xe(m){const T=m.id==="test"?"üéØ":m.id==="mathematik"?"üî¢":"üß¨",F=m.id==="test"?"#fef3c7":m.id==="mathematik"?"#dbeafe":"#dcfce7";return{id:m.id,name:m.title,description:`${m.learningPathIds.length} Lernpfade`,icon:T,color:F}}return s.jsxs("div",{style:{padding:"2rem",fontFamily:"system-ui, sans-serif"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem"},children:[s.jsxs("div",{children:[s.jsx("h1",{children:"üß† MindForge Academy"}),s.jsx("p",{style:{fontSize:"1.1rem",color:"#6b7280",marginTop:"0.5rem"},children:"Erweitere dein Wissen, eine Frage nach der anderen"})]}),s.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[s.jsx("button",{onClick:Ie,style:{padding:"0.75rem 1.5rem",background:"#f59e0b",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"1rem",fontWeight:"500",display:"flex",alignItems:"center",gap:"0.5rem"},children:"üîÑ DB Aktualisieren"}),s.jsx("button",{onClick:()=>oe(!0),style:{padding:"0.75rem 1.5rem",background:"#3b82f6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"1rem",fontWeight:"500",display:"flex",alignItems:"center",gap:"0.5rem"},children:"üìä Dashboard"})]})]}),s.jsx("h2",{style:{marginTop:0,marginBottom:"1rem"},children:"Themen ausw√§hlen"}),s.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(250px, 1fr))",gap:"1.5rem"},children:n.map(m=>s.jsx(ut,{topic:xe(m),onSelect:T=>{const F=n.find(E=>E.id===T);F&&H(F)},"data-testid":`topic-card-${m.id}`},m.id))})]})}Me.createRoot(document.getElementById("root")).render(s.jsx(fe.StrictMode,{children:s.jsx(pt,{})}));
//# sourceMappingURL=index-Gn6H6x1Z.js.map
