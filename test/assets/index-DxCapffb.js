import{r as k,a as ct,R as K}from"./react-DnQQq7lD.js";import{D as dt}from"./storage-7oeF2ZJA.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(o){if(o.ep)return;o.ep=!0;const a=r(o);fetch(o.href,a)}})();var Oe={exports:{}},we={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ut=k,ht=Symbol.for("react.element"),ft=Symbol.for("react.fragment"),gt=Object.prototype.hasOwnProperty,pt=ut.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,mt={key:!0,ref:!0,__self:!0,__source:!0};function He(i,e,r){var n,o={},a=null,l=null;r!==void 0&&(a=""+r),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(l=e.ref);for(n in e)gt.call(e,n)&&!mt.hasOwnProperty(n)&&(o[n]=e[n]);if(i&&i.defaultProps)for(n in e=i.defaultProps,e)o[n]===void 0&&(o[n]=e[n]);return{$$typeof:ht,type:i,key:a,ref:l,props:o,_owner:pt.current}}we.Fragment=ft;we.jsx=He;we.jsxs=He;Oe.exports=we;var t=Oe.exports,Te={},Fe=ct;Te.createRoot=Fe.createRoot,Te.hydrateRoot=Fe.hydrateRoot;class yt extends dt{topics;learningPaths;tasks;answerHistory;userProgress;practiceSessions;spacedRepetition;constructor(){super("mindforge-academy-test"),this.version(1).stores({topics:"id, title, isActive, createdAt",learningPaths:"id, topicId, difficulty, isActive, createdAt",tasks:"id, learningPathId, type, *metadata.tags, metadata.difficulty, createdAt",answerHistory:"id, taskId, sessionId, timestamp, isCorrect",userProgress:"id, topicId, learningPathId, *milestones.lastActivity",practiceSessions:"id, execution.status, execution.startedAt, execution.completedAt, createdAt",spacedRepetition:"id, taskId, schedule.nextReview, algorithm.interval, createdAt"})}}const L=new yt;async function xt(){const i=new Map,e=[],r=[],n={mathematik:["algebra-basics.json","geometry-basics.json","advanced-tasks.json","brueche-grundlagen.json"],biologie:["zellbiologie.json","genetik-basics.json"],spanisch:["spanisch-grundlagen.json","begruessung-vorstellung.json","familie-persoenliches.json","zahlen-farben-tiere.json","vokabeltest-karteikarten.json"],test:["all-task-types.json"]};for(const[o,a]of Object.entries(n)){if(!i.has(o)){const l=bt(o);i.set(o,l)}for(const l of a)try{const s=`/learning-platform/test/learning-paths/${o}/${l}`,f=await fetch(s);if(!f.ok){console.warn(`Failed to load ${s}: ${f.status}`);continue}const x=await f.json(),z=x.tasks.map(d=>d.id),R={...x.learningPath,taskIds:z,createdAt:x.learningPath.createdAt?new Date(x.learningPath.createdAt):new Date("2024-01-01"),updatedAt:x.learningPath.createdAt?new Date(x.learningPath.createdAt):new Date("2024-01-01")};e.push(R);const I=i.get(o);I.learningPathIds.includes(R.id)||I.learningPathIds.push(R.id);for(const d of x.tasks){const $={...d,createdAt:new Date("2024-01-01"),updatedAt:new Date("2024-01-01")};r.push($)}}catch(m){console.error(`Failed to load learning path ${o}/${l}:`,m)}}return{topics:Array.from(i.values()),learningPaths:e,tasks:r}}function bt(i){const r={test:{id:"test",title:"Test & Demo",description:"Demonstriert alle Aufgabentypen der Plattform",metadata:{estimatedHours:1,difficultyLevel:"beginner",prerequisites:[]}},mathematik:{id:"mathematik",title:"Mathematik",description:"Grundlagen der Mathematik: Algebra, Geometrie und mehr",metadata:{estimatedHours:40,difficultyLevel:"intermediate",prerequisites:[]}},biologie:{id:"biologie",title:"Biologie",description:"Einf√ºhrung in die Biologie: Zellen, Genetik und √ñkosysteme",metadata:{estimatedHours:35,difficultyLevel:"beginner",prerequisites:[]}},spanisch:{id:"spanisch",title:"Spanisch",description:"Lerne Spanisch: Vokabeln, Grammatik und Konversation",metadata:{estimatedHours:50,difficultyLevel:"beginner",prerequisites:[]}},chemie:{id:"chemie",title:"Chemie",description:"Grundlagen der Chemie: Atome, Molek√ºle und Reaktionen",metadata:{estimatedHours:40,difficultyLevel:"intermediate",prerequisites:[]}},physik:{id:"physik",title:"Physik",description:"Einf√ºhrung in die Physik: Kr√§fte, Energie und Bewegung",metadata:{estimatedHours:45,difficultyLevel:"intermediate",prerequisites:[]}}}[i]||{id:i,title:i.charAt(0).toUpperCase()+i.slice(1),description:`Lernmaterialien f√ºr ${i}`,metadata:{estimatedHours:30,difficultyLevel:"beginner",prerequisites:[]}};return{id:r.id,title:r.title,description:r.description,learningPathIds:[],isActive:!0,metadata:r.metadata,createdAt:new Date("2024-01-01"),updatedAt:new Date("2024-01-01")}}async function We(i){console.log("üóëÔ∏è Clearing existing database...");const e=await i.topics.count(),r=await i.learningPaths.count(),n=await i.tasks.count();console.log(`Before clear: ${e} topics, ${r} paths, ${n} tasks`),await i.topics.clear(),await i.learningPaths.clear(),await i.tasks.clear();const o=await i.tasks.count();console.log(`After clear: ${o} tasks remaining`),console.log("üìÇ Loading learning paths from JSON files...");const a=await xt();if(a.topics.length===0)throw new Error("No learning paths found in JSON files!");console.log(`Saving to database: ${a.topics.length} topics, ${a.learningPaths.length} learning paths, ${a.tasks.length} tasks`),console.log("Topics:",a.topics.map(f=>f.id)),console.log("Learning paths:",a.learningPaths.map(f=>`${f.id} (${f.taskIds?.length||0} taskIds)`)),console.log("Tasks:",a.tasks.map(f=>`${f.id} (learningPathId: ${f.learningPathId})`));try{await i.topics.bulkAdd(a.topics),console.log("‚úì Topics saved")}catch{console.log("‚ö†Ô∏è Topics exist, using bulkPut to update..."),await i.topics.bulkPut(a.topics),console.log("‚úì Topics updated")}try{await i.learningPaths.bulkAdd(a.learningPaths),console.log("‚úì Learning paths saved")}catch{console.log("‚ö†Ô∏è Learning paths exist, using bulkPut to update..."),await i.learningPaths.bulkPut(a.learningPaths),console.log("‚úì Learning paths updated")}try{await i.tasks.bulkAdd(a.tasks),console.log("‚úì Tasks saved")}catch(f){console.error("‚ùå Error saving tasks with bulkAdd:",f.message),console.log("‚ö†Ô∏è Some tasks already exist, using bulkPut to update...");try{await i.tasks.bulkPut(a.tasks),console.log("‚úì Tasks updated with bulkPut")}catch(x){console.error("‚ùå Error with bulkPut:",x.message)}}console.log(`‚úÖ Loaded from JSON: ${a.topics.length} topics, ${a.learningPaths.length} learning paths, ${a.tasks.length} tasks`);const l=await i.topics.count(),m=await i.learningPaths.count(),s=await i.tasks.count();console.log(`‚úÖ Verified in DB: ${l} topics, ${m} learning paths, ${s} tasks`)}class Ne extends Error{constructor(e,r,n){super(e),this.code=r,this.context=n,this.name="LearningPlatformError"}}class re extends Ne{constructor(e,r){super(e,"VALIDATION_ERROR",r),this.name="ValidationError"}}class le extends Ne{constructor(e,r){super(`${e} with id ${r} not found`,"NOT_FOUND",{resource:e,id:r}),this.name="NotFoundError"}}class U{id;configuration;execution;results;createdAt;updatedAt;constructor(e){U.validate(e),this.id=e.id,this.configuration={...e.configuration,learningPathIds:[...e.configuration.learningPathIds]},this.execution={taskIds:[...e.execution.taskIds],completedCount:e.execution.completedCount,correctCount:e.execution.correctCount,status:e.execution.status,totalTimeSpent:e.execution.totalTimeSpent},e.execution.startedAt&&(this.execution.startedAt=new Date(e.execution.startedAt)),e.execution.completedAt&&(this.execution.completedAt=new Date(e.execution.completedAt)),this.results={...e.results,difficultyDistribution:{...e.results.difficultyDistribution},improvementAreas:[...e.results.improvementAreas]},this.createdAt=e.createdAt||new Date,this.updatedAt=e.updatedAt||new Date}static validate(e){if(e.configuration?.targetCount!==void 0&&(e.configuration.targetCount<5||e.configuration.targetCount>50))throw new re("Target count must be between 5 and 50",{field:"targetCount",value:e.configuration.targetCount});if(e.execution?.status!==void 0){const r=["planned","active","paused","completed","abandoned"];if(!r.includes(e.execution.status))throw new re("Invalid session status",{field:"status",value:e.execution.status,validValues:r})}}static create(e,r,n,o,a){const l={topicId:r,learningPathIds:n,targetCount:a.targetCount,includeReview:a.includeReview};return a.difficultyFilter&&(l.difficultyFilter=a.difficultyFilter),new U({id:e,configuration:l,execution:{taskIds:o,completedCount:0,correctCount:0,status:"planned",totalTimeSpent:0},results:{accuracy:0,averageTime:0,difficultyDistribution:{},improvementAreas:[]}})}start(){if(this.execution.status!=="planned"&&this.execution.status!=="paused")throw new Error("Can only start planned or paused sessions");this.execution.status="active",this.execution.startedAt||(this.execution.startedAt=new Date),this.updatedAt=new Date}pause(){if(this.execution.status!=="active")throw new Error("Can only pause active sessions");this.execution.status="paused",this.updatedAt=new Date}resume(){if(this.execution.status!=="paused")throw new Error("Can only resume paused sessions");this.execution.status="active",this.updatedAt=new Date}recordAnswer(e,r){if(this.execution.status!=="active")throw new Error("Session must be active to record answers");this.execution.completedCount++,e&&this.execution.correctCount++,this.execution.totalTimeSpent+=r,this.updateResults(),this.updatedAt=new Date}complete(){if(this.execution.status==="completed"||this.execution.status==="abandoned")throw new Error("Session already finalized");this.execution.status="completed",this.execution.completedAt=new Date,this.updateResults(),this.updatedAt=new Date}abandon(){if(this.execution.status==="completed"||this.execution.status==="abandoned")throw new Error("Session already finalized");this.execution.status="abandoned",this.updatedAt=new Date}updateResults(){this.execution.completedCount>0&&(this.results.accuracy=this.execution.correctCount/this.execution.completedCount*100),this.execution.completedCount>0&&(this.results.averageTime=this.execution.totalTimeSpent/this.execution.completedCount)}getProgress(){return this.execution.completedCount/this.configuration.targetCount*100}isComplete(){return this.execution.completedCount>=this.configuration.targetCount}getRemainingCount(){return Math.max(0,this.configuration.targetCount-this.execution.completedCount)}toJSON(){const e={id:this.id,configuration:{...this.configuration,learningPathIds:[...this.configuration.learningPathIds]},execution:{...this.execution,taskIds:[...this.execution.taskIds]},results:{...this.results,difficultyDistribution:{...this.results.difficultyDistribution},improvementAreas:[...this.results.improvementAreas]},createdAt:this.createdAt,updatedAt:this.updatedAt};return this.configuration.difficultyFilter&&(e.configuration.difficultyFilter=this.configuration.difficultyFilter),this.execution.startedAt&&(e.execution.startedAt=this.execution.startedAt),this.execution.completedAt&&(e.execution.completedAt=this.execution.completedAt),e}static fromJSON(e){return new U(e)}}class Ce{constructor(e,r,n){this.sessionRepository=e,this.taskRepository=r,this.spacedRepRepository=n}async createSession(e){const r=await this.selectTasksForSession(e),n=`session-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,o={targetCount:e.targetCount,includeReview:e.includeReview};e.difficultyFilter&&(o.difficultyFilter=e.difficultyFilter);const a=U.create(n,e.topicId,e.learningPathIds,r,o);return await this.sessionRepository.create(a.toJSON())}async getSession(e){return await this.sessionRepository.getById(e)}async updateSession(e,r){await this.sessionRepository.update(e,r)}async completeSession(e){const r=await this.sessionRepository.getById(e);if(!r)throw new le("PracticeSession",e);const n=U.fromJSON(r);return n.complete(),await this.sessionRepository.update(e,n.toJSON())}async pauseSession(e){const r=await this.sessionRepository.getById(e);if(!r)throw new le("PracticeSession",e);const n=U.fromJSON(r);n.pause(),await this.sessionRepository.update(e,n.toJSON())}async resumeSession(e){const r=await this.sessionRepository.getById(e);if(!r)throw new le("PracticeSession",e);const n=U.fromJSON(r);n.resume(),await this.sessionRepository.update(e,n.toJSON())}async abandonSession(e){const r=await this.sessionRepository.getById(e);if(!r)throw new le("PracticeSession",e);const n=U.fromJSON(r);n.abandon(),await this.sessionRepository.update(e,n.toJSON())}async getActiveSessions(e){return await this.sessionRepository.getActive(e)}async getRecentSessions(e,r){return await this.sessionRepository.getRecent(e,r)}async recordSessionAnswer(e,r,n){const o=await this.sessionRepository.getById(e);if(!o)throw new le("PracticeSession",e);const a=U.fromJSON(o);a.execution.status==="planned"&&a.start(),a.recordAnswer(r,n),a.isComplete()&&a.complete(),await this.sessionRepository.update(e,a.toJSON())}async selectTasksForSession(e){const r=[];let n=e.targetCount;if(console.log(`Selecting tasks: targetCount=${e.targetCount}, learningPaths=${e.learningPathIds.join(",")}`),e.includeReview&&n>0){const o=await this.spacedRepRepository.getDue(new Date),a=o.slice(0,Math.min(o.length,Math.ceil(e.targetCount*.3))).map(l=>l.taskId);console.log(`Review tasks found: ${a.length}`),r.push(...a),n-=a.length}if(n>0){const o={learningPathIds:e.learningPathIds,excludeIds:r};e.difficultyFilter&&(o.difficulty=e.difficultyFilter),console.log(`Requesting ${n} new tasks with filters:`,o);const a=await this.taskRepository.getRandomTasks(n,o);console.log(`Got ${a.length} tasks:`,a.map(l=>l.id)),r.push(...a.map(l=>l.id))}return console.log(`Total selected tasks: ${r.length}`),r}}class ce{id;taskId;algorithm;schedule;performance;metadata;createdAt;updatedAt;constructor(e){ce.validate(e),this.id=e.id,this.taskId=e.taskId,this.algorithm={...e.algorithm},this.schedule={...e.schedule,nextReview:new Date(e.schedule.nextReview)},e.schedule.lastReviewed&&(this.schedule.lastReviewed=new Date(e.schedule.lastReviewed)),this.performance={...e.performance},this.metadata={...e.metadata,introduced:new Date(e.metadata.introduced)},this.createdAt=e.createdAt||new Date,this.updatedAt=e.updatedAt||new Date}static validate(e){if(e.algorithm?.efactor!==void 0&&(e.algorithm.efactor<1.3||e.algorithm.efactor>2.5))throw new re("Efactor must be between 1.3 and 2.5",{field:"efactor",value:e.algorithm.efactor});if(e.algorithm?.interval!==void 0&&(e.algorithm.interval<0||e.algorithm.interval>365))throw new re("Interval must be between 0 and 365 days",{field:"interval",value:e.algorithm.interval});if(e.performance?.lastGrade!==void 0&&(e.performance.lastGrade<0||e.performance.lastGrade>5))throw new re("Grade must be between 0 and 5",{field:"lastGrade",value:e.performance.lastGrade});if(e.performance?.averageAccuracy!==void 0&&(e.performance.averageAccuracy<0||e.performance.averageAccuracy>100))throw new re("Average accuracy must be between 0 and 100",{field:"averageAccuracy",value:e.performance.averageAccuracy})}static createNew(e,r){return new ce({id:r,taskId:e,algorithm:{interval:1,repetition:0,efactor:2.5},schedule:{nextReview:new Date(Date.now()+24*60*60*1e3),totalReviews:0,consecutiveCorrect:0},performance:{averageAccuracy:0,averageTime:0,difficultyRating:3,lastGrade:0},metadata:{introduced:new Date,graduated:!1,lapseCount:0}})}recordAnswer(e,r){if(e<0||e>5)throw new re("Grade must be between 0 and 5",{field:"grade",value:e});if(this.performance.lastGrade=e,this.updateAverageAccuracy(e>=3),this.updateAverageTime(r),this.schedule.totalReviews++,this.schedule.lastReviewed=new Date,e<3)this.algorithm.repetition=0,this.algorithm.interval=1,this.schedule.consecutiveCorrect=0,this.metadata.lapseCount++,this.metadata.graduated=!1;else{this.schedule.consecutiveCorrect++;const n=.1-(5-e)*(.08+(5-e)*.02);this.algorithm.efactor=Math.max(1.3,this.algorithm.efactor+n),this.algorithm.efactor=Math.min(2.5,this.algorithm.efactor),this.algorithm.repetition===0?this.algorithm.interval=1:this.algorithm.repetition===1?this.algorithm.interval=6:this.algorithm.interval=Math.round(this.algorithm.interval*this.algorithm.efactor),this.algorithm.interval=Math.min(365,this.algorithm.interval),this.algorithm.repetition++,this.algorithm.repetition>=2&&(this.metadata.graduated=!0)}this.schedule.nextReview=new Date(Date.now()+this.algorithm.interval*24*60*60*1e3),this.updatedAt=new Date}updateAverageAccuracy(e){const r=this.schedule.totalReviews,o=this.performance.averageAccuracy/100*(r-1)+(e?1:0);this.performance.averageAccuracy=o/r*100}updateAverageTime(e){const r=this.schedule.totalReviews,o=this.performance.averageTime*(r-1)+e;this.performance.averageTime=o/r}isDue(){return this.schedule.nextReview.getTime()<=Date.now()}daysUntilReview(){const e=this.schedule.nextReview.getTime()-Date.now();return Math.ceil(e/(24*60*60*1e3))}toJSON(){const e={id:this.id,taskId:this.taskId,algorithm:{...this.algorithm},schedule:{nextReview:this.schedule.nextReview,totalReviews:this.schedule.totalReviews,consecutiveCorrect:this.schedule.consecutiveCorrect},performance:{...this.performance},metadata:{introduced:this.metadata.introduced,graduated:this.metadata.graduated,lapseCount:this.metadata.lapseCount},createdAt:this.createdAt,updatedAt:this.updatedAt};return this.schedule.lastReviewed&&(e.schedule.lastReviewed=this.schedule.lastReviewed),e}static fromJSON(e){return new ce(e)}}class wt{constructor(e,r){this.spacedRepRepository=e,this.taskRepository=r}async getNextTasks(e,r){const a=(await this.spacedRepRepository.getDue(new Date)).sort((m,s)=>s.metadata.lapseCount!==m.metadata.lapseCount?s.metadata.lapseCount-m.metadata.lapseCount:m.schedule.nextReview.getTime()-s.schedule.nextReview.getTime()).slice(0,r),l=[];for(const m of a){const s=await this.taskRepository.getById(m.taskId);s&&l.push(s)}return l}async recordAnswer(e,r,n){if(n<0||n>5)throw new Error("Grade must be between 0 and 5");let o=await this.spacedRepRepository.getByTaskId(e);if(!o){const l=ce.createNew(e,`sr-${e}-${Date.now()}`);o=await this.spacedRepRepository.create(l.toJSON())}const a=ce.fromJSON(o);a.recordAnswer(n,0),await this.spacedRepRepository.update(o.id,a.toJSON())}async getRepetitionData(e){return await this.spacedRepRepository.getByTaskId(e)}async getTasksDue(e){const r=await this.spacedRepRepository.getDue(new Date),n=[];for(const o of r){const a=await this.taskRepository.getById(o.taskId);a&&n.push(a)}return n}async getReviewSchedule(e,r){const n=[],o=new Date;for(let a=0;a<r;a++){const l=new Date(o);l.setDate(l.getDate()+a),l.setHours(23,59,59,999);const m=await this.spacedRepRepository.getByNextReviewDate(l);let s=0;for(const f of m)s+=f.performance.averageTime||3e4;n.push({date:l,taskCount:m.length,estimatedTime:Math.round(s/1e3)})}return n}async rescheduleTask(e,r){const n=await this.spacedRepRepository.getByTaskId(e);if(!n)throw new le("SpacedRepetitionItem",e);await this.spacedRepRepository.updateSchedule(n.id,{...n.schedule,nextReview:r})}async getStatistics(e){const r=await this.spacedRepRepository.getAll(),n=await this.spacedRepRepository.getDue(new Date),o=r.filter(m=>m.metadata.graduated).length,a=r.reduce((m,s)=>m+s.algorithm.interval,0),l=r.reduce((m,s)=>m+s.performance.averageAccuracy,0);return{totalItems:r.length,dueToday:n.length,graduated:o,averageInterval:r.length>0?a/r.length:0,averageAccuracy:r.length>0?l/r.length:0}}}class vt{constructor(e){this.table=e}async create(e){return await this.table.add(e),e}async getById(e){return await this.table.get(e)||null}async getAll(){return await this.table.toArray()}async update(e,r){return await this.table.update(e,r),await this.table.get(e)}async delete(e){await this.table.delete(e)}async getActive(){return await this.table.where("isActive").equals(1).toArray()}async search(e){const r=e.toLowerCase();return await this.table.filter(n=>n.title.toLowerCase().includes(r)).toArray()}async getByTitle(e){return null}async createMany(e){return[]}async updateMany(e){}async deleteMany(e){}async count(){return await this.table.count()}async exists(e){return!!await this.table.get(e)}}class St{constructor(e){this.table=e}async create(e){return await this.table.add(e),e}async getById(e){return await this.table.get(e)||null}async getAll(){return await this.table.toArray()}async update(e,r){return await this.table.update(e,r),await this.table.get(e)}async delete(e){await this.table.delete(e)}async getByTopicId(e){return await this.table.where("topicId").equals(e).toArray()}async getByDifficulty(e){return await this.table.where("difficulty").equals(e).toArray()}async getActive(){return await this.table.where("isActive").equals(1).toArray()}async searchByTitle(e){return[]}async createMany(e){return[]}async updateMany(e){}async deleteMany(e){}async count(){return await this.table.count()}async exists(e){return!!await this.table.get(e)}}class kt{constructor(e){this.table=e}async create(e){return await this.table.add(e),e}async getById(e){return await this.table.get(e)||null}async getAll(){return await this.table.toArray()}async update(e,r){return await this.table.update(e,r),await this.table.get(e)}async delete(e){await this.table.delete(e)}async getByLearningPathId(e){return await this.table.where("learningPathId").equals(e).toArray()}async getRandomTasks(e,r){console.log(`[TaskRepository] getRandomTasks called: count=${e}, filters=`,r);let n;if(r?.learningPathIds?(n=await this.table.where("learningPathId").anyOf(r.learningPathIds).toArray(),console.log(`[TaskRepository] Found ${n.length} tasks for learning paths:`,r.learningPathIds),console.log("[TaskRepository] Task IDs:",n.map(l=>l.id))):(n=await this.table.toArray(),console.log(`[TaskRepository] Found ${n.length} tasks (no filter)`)),r?.excludeIds){const l=n.length;n=n.filter(m=>!r.excludeIds.includes(m.id)),console.log(`[TaskRepository] After excluding IDs: ${l} -> ${n.length} tasks`)}const o=n.sort(()=>Math.random()-.5),a=[];if(o.length===0)return console.log("[TaskRepository] No tasks available!"),a;for(let l=0;l<e;l++){const m=o[l%o.length];m&&a.push(m)}return console.log(`[TaskRepository] Returning ${a.length} tasks (${o.length} unique, repeated to reach ${e})`),a}async getByLearningPathIds(e){return[]}async getByType(e){return[]}async getByDifficulty(e){return[]}async getByTags(e){return[]}async search(e){return[]}async createMany(e){return[]}async updateMany(e){}async deleteMany(e){}async count(){return await this.table.count()}async exists(e){return!!await this.table.get(e)}}class jt{constructor(e){this.table=e}async create(e){return await this.table.add(e),e}async getById(e){return await this.table.get(e)||null}async getAll(){return await this.table.toArray()}async update(e,r){return await this.table.update(e,r),await this.table.get(e)}async delete(e){await this.table.delete(e)}async getByTaskId(e){return await this.table.where("taskId").equals(e).toArray()}async getBySessionId(e){return await this.table.where("sessionId").equals(e).toArray()}async getByUserId(e,r){return[]}async getByDateRange(e,r){return[]}async getCorrectAnswers(e){return await this.table.where("taskId").equals(e).filter(r=>r.isCorrect).toArray()}async getIncorrectAnswers(e){return await this.table.where("taskId").equals(e).filter(r=>!r.isCorrect).toArray()}async getAccuracyForPeriod(e,r,n){return 0}async createMany(e){return[]}async updateMany(e){}async deleteMany(e){}async count(){return await this.table.count()}async exists(e){return!!await this.table.get(e)}}class Rt{constructor(e){this.table=e}async create(e){return await this.table.add(e),e}async getById(e){return await this.table.get(e)||null}async getAll(){return await this.table.toArray()}async update(e,r){return await this.table.update(e,r),await this.table.get(e)}async delete(e){await this.table.delete(e)}async getByTopicId(e){return(await this.table.where("topicId").equals(e).toArray())[0]||null}async getByLearningPathId(e){return(await this.table.where("learningPathId").equals(e).toArray())[0]||null}async getByUserId(e){return[]}async updateStatistics(e,r){}async incrementTaskCount(e,r){}async updateStreak(e,r){}async createMany(e){return[]}async updateMany(e){}async deleteMany(e){}async count(){return await this.table.count()}async exists(e){return!!await this.table.get(e)}}class At{constructor(e){this.table=e}async create(e){return await this.table.add(e),e}async getById(e){return await this.table.get(e)||null}async getAll(){return await this.table.toArray()}async update(e,r){return await this.table.update(e,r),await this.table.get(e)}async delete(e){await this.table.delete(e)}async getActive(e){return await this.table.where("execution.status").anyOf(["planned","active","paused"]).toArray()}async getRecent(e,r){return await this.table.orderBy("createdAt").reverse().limit(r).toArray()}async getByStatus(e){return await this.table.where("execution.status").equals(e).toArray()}async getByUserId(e){return[]}async getByDateRange(e,r){return[]}async updateStatus(e,r){}async incrementProgress(e,r,n){}async createMany(e){return[]}async updateMany(e){}async deleteMany(e){}async count(){return await this.table.count()}async exists(e){return!!await this.table.get(e)}}class Ct{constructor(e){this.table=e}async create(e){return await this.table.add(e),e}async getById(e){return await this.table.get(e)||null}async getAll(){return await this.table.toArray()}async update(e,r){return await this.table.update(e,r),await this.table.get(e)}async delete(e){await this.table.delete(e)}async getByTaskId(e){return(await this.table.where("taskId").equals(e).toArray())[0]||null}async getDue(e){return await this.table.where("schedule.nextReview").belowOrEqual(e).toArray()}async getByNextReviewDate(e){return[]}async updateAlgorithmData(e,r){}async updateSchedule(e,r){}async updatePerformance(e,r){}async getReviewCalendar(e,r){return[]}async createMany(e){return[]}async updateMany(e){}async deleteMany(e){}async count(){return await this.table.count()}async exists(e){return!!await this.table.get(e)}}class De{static topicRepo;static learningPathRepo;static taskRepo;static answerHistoryRepo;static userProgressRepo;static practiceSessionRepo;static spacedRepetitionRepo;static getTopicRepository(){return this.topicRepo||(this.topicRepo=new vt(L.topics)),this.topicRepo}static getLearningPathRepository(){return this.learningPathRepo||(this.learningPathRepo=new St(L.learningPaths)),this.learningPathRepo}static getTaskRepository(){return this.taskRepo||(this.taskRepo=new kt(L.tasks)),this.taskRepo}static getAnswerHistoryRepository(){return this.answerHistoryRepo||(this.answerHistoryRepo=new jt(L.answerHistory)),this.answerHistoryRepo}static getUserProgressRepository(){return this.userProgressRepo||(this.userProgressRepo=new Rt(L.userProgress)),this.userProgressRepo}static getPracticeSessionRepository(){return this.practiceSessionRepo||(this.practiceSessionRepo=new At(L.practiceSessions)),this.practiceSessionRepo}static getSpacedRepetitionRepository(){return this.spacedRepetitionRepo||(this.spacedRepetitionRepo=new Ct(L.spacedRepetition)),this.spacedRepetitionRepo}static reset(){this.topicRepo=null,this.learningPathRepo=null,this.taskRepo=null,this.answerHistoryRepo=null,this.userProgressRepo=null,this.practiceSessionRepo=null,this.spacedRepetitionRepo=null}}const me=()=>De.getTaskRepository(),ze=()=>De.getPracticeSessionRepository(),ye=()=>De.getSpacedRepetitionRepository();class zt{manifest=null;audioCache=new Map;getBasePath=()=>window.location.pathname.startsWith("/learning-platform/")?"/learning-platform/":"/";get manifestPath(){return`${this.getBasePath()}audio/spanish/manifest.json`}get audioBasePath(){return`${this.getBasePath()}audio/spanish/`}isInitialized=!1;currentlyPlaying=null;async initialize(){if(!this.isInitialized)try{const e=await fetch(this.manifestPath);if(!e.ok)throw new Error(`Failed to load audio manifest: ${e.statusText}`);this.manifest=await e.json(),this.isInitialized=!0,console.log("‚úì Audio service initialized with",Object.keys(this.manifest||{}).length,"audio files")}catch(e){console.warn("‚ö†Ô∏è Failed to initialize audio service:",e),this.manifest={},this.isInitialized=!0}}async playSpanish(e){if(this.isInitialized||await this.initialize(),!this.manifest||!this.manifest[e])throw console.warn(`‚ö†Ô∏è No audio file found for: "${e}"`),new Error(`Audio not available for: ${e}`);const r=this.manifest[e],n=this.audioBasePath+r;this.currentlyPlaying&&(this.currentlyPlaying.pause(),this.currentlyPlaying.currentTime=0);let o=this.audioCache.get(n);return o||(o=new Audio(n),this.audioCache.set(n,o)),this.currentlyPlaying=o,new Promise((a,l)=>{if(!o){l(new Error("Audio element not found"));return}const m=()=>{f(),this.currentlyPlaying=null,a()},s=()=>{f(),this.currentlyPlaying=null,l(new Error(`Failed to play audio: ${n}`))},f=()=>{o.removeEventListener("ended",m),o.removeEventListener("error",s)};o.addEventListener("ended",m),o.addEventListener("error",s),o.currentTime=0,o.play().catch(x=>{f(),this.currentlyPlaying=null,l(x)})})}hasAudio(e){return this.isInitialized?!!(this.manifest&&this.manifest[e]):!1}stopPlayback(){this.currentlyPlaying&&(this.currentlyPlaying.pause(),this.currentlyPlaying.currentTime=0,this.currentlyPlaying=null)}clearCache(){this.audioCache.clear()}}const xe=new zt,_e=({size:i})=>t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",style:{width:i,height:i},children:t.jsx("path",{d:"M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"})}),It=({size:i})=>t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",style:{width:i,height:i},children:t.jsx("path",{d:"M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"})});function oe({text:i,className:e="",disabled:r=!1,size:n="medium"}){const[o,a]=k.useState(!1),[l,m]=k.useState(null),s=xe.hasAudio(i),f=async()=>{if(!(o||r||!s)){a(!0),m(null);try{await xe.playSpanish(i)}catch(d){console.error("Failed to play audio:",d),m("Audio playback failed")}finally{a(!1)}}},x={small:"w-7 h-7",medium:"w-9 h-9",large:"w-11 h-11"},z={small:"16px",medium:"20px",large:"24px"},R=r||!s,I=`
    ${x[n]}
    inline-flex items-center justify-center
    rounded-lg
    transition-all duration-200
    shadow-sm hover:shadow-md
    ${R?"bg-gray-100 text-gray-400 cursor-not-allowed border border-gray-200":o?"bg-blue-600 text-white scale-95":"bg-gradient-to-br from-blue-500 to-blue-600 text-white hover:from-blue-600 hover:to-blue-700 active:scale-95 cursor-pointer"}
    ${e}
  `;return t.jsx("button",{onClick:f,disabled:R,className:I,title:s?o?"Spielt ab...":`Aussprache abspielen: ${i}`:"Audio nicht verf√ºgbar","aria-label":`Spanische Aussprache f√ºr ${i} abspielen`,type:"button",children:o?t.jsx("div",{style:{animation:"pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite"},children:t.jsx(_e,{size:z[n]})}):!s||l?t.jsx(It,{size:z[n]}):t.jsx(_e,{size:z[n]})})}const p={primary:{100:"#dbeafe",300:"#93c5fd",500:"#3b82f6",600:"#2563eb"},success:{100:"#dcfce7",300:"#86efac",500:"#10b981"},error:{100:"#fee2e2",300:"#fca5a5",500:"#ef4444",600:"#dc2626"},warning:{100:"#fef3c7",400:"#fbbf24",500:"#f59e0b"},info:{100:"#f3e8ff",300:"#d8b4fe",500:"#8b5cf6"},neutral:{0:"#ffffff",50:"#f9fafb",100:"#f3f4f6",200:"#e5e7eb",300:"#d1d5db",400:"#9ca3af",500:"#6b7280",600:"#4b5563",700:"#374151",900:"#111827"}},h={text:{primary:p.neutral[900],secondary:p.neutral[600],tertiary:p.neutral[500],disabled:p.neutral[400]},background:{primary:p.neutral[0],secondary:p.neutral[50],tertiary:p.neutral[100]},border:{light:p.neutral[200],base:p.neutral[300],dark:p.neutral[400]},interactive:{primary:p.primary[500]},feedback:{success:p.success[500],successLight:p.success[100],successBorder:p.success[300],error:p.error[500],errorLight:p.error[100],errorBorder:p.error[300],warning:p.warning[500],warningLight:p.warning[100],warningBorder:p.warning[400],info:p.info[500],infoLight:p.info[100],infoBorder:p.info[300]}},y={.5:"0.125rem",1:"0.25rem",2:"0.5rem",2.5:"0.625rem",3:"0.75rem",4:"1rem",6:"1.5rem",8:"2rem",10:"2.5rem",12:"3rem"},w={fontFamily:{sans:'system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif'},fontSize:{xs:"0.75rem",sm:"0.875rem",base:"1rem",lg:"1.125rem",xl:"1.25rem","2xl":"1.5rem","3xl":"1.875rem"},fontWeight:{medium:"500",semibold:"600",bold:"700"},lineHeight:{none:"1",tight:"1.25",normal:"1.5",relaxed:"1.625"},letterSpacing:{wide:"0.025em"}},Tt={sm:"0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.1)"},N={sm:"0.25rem",md:"0.5rem",lg:"0.75rem",full:"9999px"},ne={presets:{fast:"all 150ms cubic-bezier(0.4, 0, 0.2, 1)",base:"all 200ms cubic-bezier(0.4, 0, 0.2, 1)",colors:"background-color 200ms cubic-bezier(0.4, 0, 0.2, 1), border-color 200ms cubic-bezier(0.4, 0, 0.2, 1), color 200ms cubic-bezier(0.4, 0, 0.2, 1)"}},W={button:{height:{sm:y[8],md:y[10],lg:y[12]},padding:{sm:`${y[2]} ${y[3]}`,md:`${y[2.5]} ${y[4]}`,lg:`${y[3]} ${y[6]}`},fontSize:{sm:w.fontSize.sm,md:w.fontSize.base,lg:w.fontSize.lg},borderRadius:N.md},card:{padding:{sm:y[4],md:y[6],lg:y[8]},borderRadius:N.lg,shadow:Tt.sm}};function se({padding:i="medium",shadow:e=!0,border:r=!0,borderColor:n,backgroundColor:o,children:a,className:l="",style:m={},...s}){const f=Dt(i),x={backgroundColor:o||h.background.primary,borderRadius:W.card.borderRadius,border:r?`1px solid ${n||h.border.light}`:"none",boxShadow:e?W.card.shadow:"none",padding:f,transition:ne.presets.fast,...m};return t.jsx("div",{...s,style:x,className:l,children:a})}function Dt(i){switch(i){case"small":return W.card.padding.sm;case"medium":return W.card.padding.md;case"large":return W.card.padding.lg}}function qe({variant:i,title:e,message:r,dismissible:n=!1,onDismiss:o,children:a,className:l="",style:m={},...s}){const f=K.useMemo(()=>Pt(i),[i]),x=K.useMemo(()=>Bt(i),[i]),z=K.useMemo(()=>({backgroundColor:f.background,borderColor:f.border,position:"relative",...m}),[f.background,f.border,m]);return t.jsx(se,{...s,padding:"medium",shadow:!1,border:!0,borderColor:f.border,backgroundColor:f.background,style:z,className:l,role:i==="error"||i==="warning"?"alert":"status","aria-live":i==="error"||i==="warning"?"assertive":"polite","aria-atomic":"true",children:t.jsxs("div",{style:{display:"flex",gap:y[3],alignItems:"flex-start"},children:[t.jsx("div",{style:{fontSize:w.fontSize.xl,lineHeight:w.lineHeight.none,flexShrink:0,marginTop:y[.5]},"aria-hidden":"true",children:x}),t.jsxs("div",{style:{flex:1},children:[e&&t.jsx("h4",{style:{margin:0,marginBottom:y[1],fontSize:w.fontSize.base,fontWeight:w.fontWeight.semibold,color:f.text},children:e}),a?t.jsx("div",{style:{fontSize:w.fontSize.sm,color:f.text,lineHeight:w.lineHeight.relaxed},children:a}):r&&t.jsx("p",{style:{margin:0,fontSize:w.fontSize.sm,color:f.text,lineHeight:w.lineHeight.relaxed},children:r})]}),n&&o&&t.jsx("button",{onClick:o,style:{background:"none",border:"none",padding:y[1],cursor:"pointer",fontSize:w.fontSize.lg,lineHeight:w.lineHeight.none,color:f.text,opacity:.6,transition:"opacity 150ms",borderRadius:N.sm},onMouseEnter:R=>{R.currentTarget.style.opacity="1"},onMouseLeave:R=>{R.currentTarget.style.opacity="0.6"},"aria-label":`Dismiss ${i} message`,children:t.jsx("span",{"aria-hidden":"true",children:"‚úï"})})]})})}function Pt(i){switch(i){case"success":return{background:h.feedback.successLight,border:h.feedback.successBorder,text:h.feedback.success};case"error":return{background:h.feedback.errorLight,border:h.feedback.errorBorder,text:h.feedback.error};case"warning":return{background:h.feedback.warningLight,border:h.feedback.warningBorder,text:h.feedback.warning};case"info":return{background:h.feedback.infoLight,border:h.feedback.infoBorder,text:h.feedback.info};default:return{background:h.feedback.infoLight,border:h.feedback.infoBorder,text:h.feedback.info}}}function Bt(i){switch(i){case"success":return"‚úì";case"error":return"‚úó";case"warning":return"‚ö†";case"info":return"‚Ñπ";default:return"‚Ñπ"}}function Ee({value:i,onChange:e,error:r=!1,success:n=!1,helperText:o,fullWidth:a=!1,disabled:l=!1,className:m="",style:s={},id:f,...x}){const[z,R]=K.useState(!1),I=o?`${f||"input"}-helper`:void 0,d=()=>l?h.border.light:r?h.feedback.errorBorder:n?h.feedback.successBorder:z?h.interactive.primary:h.border.base,$=()=>l?h.background.tertiary:r?h.feedback.errorLight:n?h.feedback.successLight:h.background.primary,T={width:a?"100%":"auto",padding:`${y[2]} ${y[3]}`,fontSize:w.fontSize.base,fontFamily:w.fontFamily.sans,color:l?h.text.disabled:h.text.primary,backgroundColor:$(),border:`2px solid ${d()}`,borderRadius:N.md,outline:"none",transition:ne.presets.fast,cursor:l?"not-allowed":"text",boxShadow:z&&!l?`0 0 0 3px ${h.interactive.primary}20`:"none",...s};return t.jsxs("div",{style:{display:"inline-block",width:a?"100%":"auto"},children:[t.jsx("input",{...x,id:f,type:"text",value:i,onChange:e,disabled:l,style:T,className:m,"aria-invalid":r?"true":"false","aria-describedby":I,onFocus:F=>{R(!0),x.onFocus?.(F)},onBlur:F=>{R(!1),x.onBlur?.(F)}}),o&&t.jsx("div",{id:I,style:{marginTop:y[1],fontSize:w.fontSize.sm,color:r?h.feedback.error:n?h.feedback.success:h.text.secondary},children:o})]})}function Lt({checked:i,onChange:e,label:r,error:n=!1,success:o=!1,disabled:a=!1,className:l="",style:m={},id:s,...f}){const x=K.useId(),z=s||`checkbox-${x}`,R=()=>a?h.border.light:n?h.feedback.errorBorder:o?h.feedback.successBorder:i?p.primary[500]:h.border.base,I=()=>a&&i?h.background.tertiary:i?p.primary[500]:n?h.feedback.errorLight:o?h.feedback.successLight:h.background.primary,d={display:"inline-flex",alignItems:"center",cursor:a?"not-allowed":"pointer",userSelect:"none",...m},$={width:"1.25rem",height:"1.25rem",marginRight:r?y[2]:0,appearance:"none",backgroundColor:I(),border:`2px solid ${R()}`,borderRadius:N.sm,cursor:a?"not-allowed":"pointer",transition:ne.presets.fast,position:"relative",flexShrink:0},T=i?{position:"absolute",left:"0.35rem",top:"0.15rem",width:"0.4rem",height:"0.7rem",border:"solid white",borderWidth:"0 2px 2px 0",transform:"rotate(45deg)",pointerEvents:"none"}:{display:"none"};return t.jsxs("label",{htmlFor:z,style:d,className:l,children:[t.jsxs("div",{style:{position:"relative",display:"inline-flex"},children:[t.jsx("input",{...f,type:"checkbox",id:z,checked:i,onChange:e,disabled:a,style:$,"aria-checked":i,"aria-invalid":n,onFocus:F=>{a||(F.currentTarget.style.outline=`2px solid ${p.primary[300]}`,F.currentTarget.style.outlineOffset="2px"),f.onFocus?.(F)},onBlur:F=>{F.currentTarget.style.outline="none",f.onBlur?.(F)}}),t.jsx("div",{style:T})]}),r&&t.jsx("span",{style:{fontSize:w.fontSize.base,color:a?h.text.disabled:h.text.primary,lineHeight:w.lineHeight.normal},children:r})]})}function $t({value:i,onChange:e,options:r,disabled:n=!1,placeholder:o,error:a=!1,success:l=!1,fullWidth:m=!1,className:s="",style:f={},id:x}){const[z,R]=K.useState(!1),I=()=>n?h.border.light:a?h.feedback.errorBorder:l?h.feedback.successBorder:z?h.interactive.primary:h.border.base,d=()=>n?h.background.tertiary:a?h.feedback.errorLight:l?h.feedback.successLight:h.background.primary,$={width:m?"100%":"auto",padding:`${y[2]} ${y[3]}`,paddingRight:y[8],fontSize:w.fontSize.base,fontFamily:w.fontFamily.sans,color:n?h.text.disabled:h.text.primary,backgroundColor:d(),border:`2px solid ${I()}`,borderRadius:N.md,outline:"none",transition:ne.presets.fast,cursor:n?"not-allowed":"pointer",appearance:"none",backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23666' d='M6 9L1 4h10z'/%3E%3C/svg%3E")`,backgroundRepeat:"no-repeat",backgroundPosition:`right ${y[2]} center`,boxShadow:z&&!n?`0 0 0 3px ${h.interactive.primary}20`:"none",...f};return t.jsxs("select",{id:x,value:i,onChange:T=>e(T.target.value),disabled:n,style:$,className:s,"aria-invalid":a?"true":"false",onFocus:()=>R(!0),onBlur:()=>R(!1),children:[o&&t.jsx("option",{value:"",disabled:!0,children:o}),r.map(T=>t.jsx("option",{value:T.value,disabled:T.disabled,children:T.label},T.value))]})}function Mt({value:i,onChange:e,min:r,max:n,step:o=1,disabled:a=!1,unit:l="",showValue:m=!0,className:s="",style:f={},id:x,"aria-label":z}){const R=(i-r)/(n-r)*100,I={display:"flex",flexDirection:"column",gap:y[2],width:"100%",...f},d={position:"relative",width:"100%",height:"8px",backgroundColor:h.background.tertiary,borderRadius:N.full,overflow:"visible"},$={position:"absolute",left:0,top:0,height:"100%",width:`${R}%`,backgroundColor:a?h.border.dark:p.primary[500],borderRadius:N.full,transition:"width 0.1s ease"},T={position:"absolute",width:"100%",height:"100%",opacity:0,cursor:a?"not-allowed":"pointer",margin:0,zIndex:2},F={position:"absolute",left:`calc(${R}% - 12px)`,top:"50%",transform:"translateY(-50%)",width:"24px",height:"24px",backgroundColor:a?h.border.dark:p.primary[600],borderRadius:N.full,border:`3px solid ${h.background.primary}`,boxShadow:"0 2px 4px rgba(0,0,0,0.2)",pointerEvents:"none",transition:"left 0.1s ease",zIndex:1},V={display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:w.fontSize.sm,color:h.text.secondary};return t.jsxs("div",{style:I,className:s,children:[t.jsxs("div",{style:d,children:[t.jsx("div",{style:$}),t.jsx("div",{style:F}),t.jsx("input",{type:"range",id:x,min:r,max:n,step:o,value:i,onChange:Y=>e(Number(Y.target.value)),disabled:a,style:T,"aria-label":z,"aria-valuenow":i,"aria-valuemin":r,"aria-valuemax":n,"aria-valuetext":`${i}${l}`})]}),m&&t.jsxs("div",{style:V,children:[t.jsxs("span",{children:[r,l]}),t.jsxs("span",{style:{fontWeight:w.fontWeight.semibold,color:h.text.primary,fontSize:w.fontSize.base},children:[i,l]}),t.jsxs("span",{children:[n,l]})]})]})}function Ft({topicId:i,learningPathIds:e,targetCount:r=10,includeReview:n=!0,onComplete:o,onCancel:a}){const[l,m]=k.useState(null),[s,f]=k.useState(null),[x,z]=k.useState(0),[R,I]=k.useState(null),[d,$]=k.useState(!1),[T,F]=k.useState(!1),[V,Y]=k.useState(Date.now()),[q,ie]=k.useState([]),[Q,de]=k.useState(0),[G,ee]=k.useState([]),[j,P]=k.useState(null),[_,te]=k.useState([]),[Z,ue]=k.useState({}),[ve,ge]=k.useState([]),[b,M]=k.useState(new Set),[E,H]=k.useState(0),[O,he]=k.useState(""),[Pe,Be]=k.useState(!1),[Se,ke]=k.useState(null),[fe,Le]=k.useState(""),[Ge,Je]=k.useState(!1);k.useEffect(()=>{Ve(),xe.initialize().then(()=>{Je(!0)})},[]),k.useEffect(()=>{l&&l.execution.taskIds.length>0&&x===0&&$e()},[l]),k.useEffect(()=>{l&&l.execution.taskIds.length>0&&x>0&&$e()},[x]);async function Ve(){const u=await new Ce(ze(),me(),ye()).createSession({topicId:i,learningPathIds:e,targetCount:r,includeReview:n});m(u)}async function $e(){if(!l||x>=l.execution.taskIds.length)return;const c=l.execution.taskIds[x];if(!c)return;const u=await L.tasks.get(c);if(u)if(f(u),Y(Date.now()),I(null),P(null),ee([]),te([]),ue({}),ge([]),M(new Set),H(0),he(""),Be(!1),ke(null),Le(""),u.type==="multiple-choice"){const g=u.content,v=[...g.options],C=g.correctAnswer,A=v.map((D,J)=>J);for(let D=A.length-1;D>0;D--){const J=Math.floor(Math.random()*(D+1));[A[D],A[J]]=[A[J],A[D]]}const S=A.map(D=>v[D]),B=A.findIndex(D=>D===C);ie(S),de(B)}else if(u.type==="cloze-deletion"){const g=u.content;ee(new Array(g.blanks.length).fill(""))}else if(u.type==="ordering"){const v=[...u.content.items].sort(()=>Math.random()-.5);te(v)}else if(u.type==="matching"){const v=u.content.pairs.map((C,A)=>A);for(let C=v.length-1;C>0;C--){const A=Math.floor(Math.random()*(C+1));[v[C],v[A]]=[v[A],v[C]]}ge(v),ue({})}else if(u.type==="multiple-select")M(new Set);else if(u.type==="slider"){const g=u.content;H(Math.floor((g.min+g.max)/2))}else u.type==="word-scramble"&&he("")}async function je(){if(!s||!l)return;let c=!1;if(s.type==="multiple-choice"){if(R===null)return;c=R===Q}else if(s.type==="cloze-deletion")c=s.content.blanks.every((B,D)=>{const J=G[D]?.trim().toLowerCase()||"",Ae=B.correctAnswer.toLowerCase(),pe=B.alternatives?.map(lt=>lt.toLowerCase())||[];return J===Ae||pe.includes(J)});else if(s.type==="true-false"){if(j===null)return;const S=s.content;c=j===S.correctAnswer}else if(s.type==="ordering"){const S=s.content;c=_.every((B,D)=>{const J=S.items.indexOf(B);return S.correctOrder[D]===J})}else if(s.type==="matching")c=s.content.pairs.every((B,D)=>Z[D]===D);else if(s.type==="multiple-select"){const S=s.content;if(b.size===0)return;c=S.correctAnswers.length===b.size&&S.correctAnswers.every(B=>b.has(B))}else if(s.type==="slider"){const S=s.content,B=S.tolerance||0;c=Math.abs(E-S.correctValue)<=B}else if(s.type==="word-scramble"){if(!O.trim())return;const S=s.content;c=O.trim().toLowerCase()===S.correctWord.toLowerCase()}else if(s.type==="flashcard"){if(Se===null)return;c=Se}else if(s.type==="text-input"){if(!fe.trim())return;const S=s.content,B=S.caseSensitive||!1,D=B?fe.trim():fe.trim().toLowerCase(),J=B?S.correctAnswer:S.correctAnswer.toLowerCase(),Ae=(S.alternatives||[]).map(pe=>B?pe:pe.toLowerCase());c=D===J||Ae.includes(D)}F(c),$(!0);const u=Math.round((Date.now()-V)/1e3);await new Ce(ze(),me(),ye()).recordSessionAnswer(l.id,c,u);const v=new wt(ye(),me()),C=c?4:2;await v.recordAnswer(s.id,c,C);const A=await L.practiceSessions.get(l.id);A&&m(A)}function Ue(){l&&($(!1),I(null),x<l.execution.taskIds.length-1&&z(x+1))}function Ye(){$(!1),I(null),l&&x<l.execution.taskIds.length-1?z(x+1):Me()}async function Me(){if(!l)return;await new Ce(ze(),me(),ye()).completeSession(l.id),await new Promise(u=>setTimeout(u,100)),o()}function ae(c){return!c||!Ge?!1:xe.hasAudio(c)}function Re(){if(d)return!1;if(s?.type==="multiple-choice")return R!==null;if(s?.type==="cloze-deletion")return G.every(c=>c.trim().length>0);if(s?.type==="true-false")return j!==null;if(s?.type==="ordering")return _.length>0;if(s?.type==="matching"){const c=s.content;return Object.keys(Z).length===c.pairs.length}return s?.type==="multiple-select"?b.size>0:s?.type==="slider"?!0:s?.type==="word-scramble"?O.trim().length>0:s?.type==="flashcard"?Se!==null:s?.type==="text-input"?fe.trim().length>0:!1}function Ze(){return s?s.type==="multiple-choice"?Ke():s.type==="cloze-deletion"?Qe():s.type==="true-false"?Xe():s.type==="ordering"?et():s.type==="matching"?tt():s.type==="multiple-select"?rt():s.type==="slider"?st():s.type==="word-scramble"?nt():s.type==="flashcard"?it():s.type==="text-input"?at():null:null}function Ke(){return!s||s.type!=="multiple-choice"?null:t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem",flex:1,minHeight:0},children:q.map((c,u)=>{let g="#ffffff",v="#d1d5db";d?u===Q?(g="#dcfce7",v="#86efac"):u===R&&!T&&(g="#fee2e2",v="#fca5a5"):R===u&&(g="#dbeafe",v="#3b82f6");const C=ae(c),S=d&&u===Q&&C;return t.jsxs("button",{onClick:()=>!d&&I(u),disabled:d,style:{padding:"0.875rem",background:g,border:`2px solid ${v}`,borderRadius:"6px",cursor:d?"default":"pointer",textAlign:"left",fontSize:"0.95rem",transition:"all 0.2s",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"0.5rem",opacity:1},children:[t.jsx("span",{children:c}),S&&t.jsx(oe,{text:c,size:"small"})]},u)})})}function Qe(){if(!s||s.type!=="cloze-deletion")return null;const c=s.content,u=c.text.split(/\{\{blank\}\}/g);return t.jsxs("div",{style:{flex:1,minHeight:0},children:[t.jsx("div",{style:{fontSize:"1rem",lineHeight:"1.8"},children:u.map((g,v)=>t.jsxs("span",{children:[g,v<c.blanks.length&&(()=>{const C=G[v]?.trim().toLowerCase()||"",A=C===c.blanks[v].correctAnswer.toLowerCase()||c.blanks[v].alternatives?.map(B=>B.toLowerCase()).includes(C),S=G[v]?.trim()!=="";return t.jsx(Ee,{value:G[v]||"",onChange:B=>{const D=[...G];D[v]=B.target.value,ee(D)},disabled:d,error:!!(d&&S&&!A),success:!!(d&&A),style:{fontSize:"0.95rem",minWidth:"100px",display:"inline-block"}})})()]},v))}),d&&t.jsxs("div",{style:{marginTop:"1rem",padding:"1rem",background:"#f9fafb",borderRadius:"6px"},children:[t.jsx("div",{style:{fontSize:"0.875rem",fontWeight:"500",marginBottom:"0.5rem",color:"#374151"},children:"Richtige Antworten:"}),c.blanks.map((g,v)=>{const C=G[v]?.trim().toLowerCase()||"",A=C===g.correctAnswer.toLowerCase()||g.alternatives?.map(S=>S.toLowerCase()).includes(C);return t.jsxs("div",{style:{fontSize:"0.875rem",marginTop:"0.25rem",color:A?"#10b981":"#374151"},children:["L√ºcke ",v+1,": ",t.jsx("strong",{style:{color:"#10b981"},children:g.correctAnswer}),g.alternatives&&g.alternatives.length>0&&t.jsxs("span",{style:{color:"#6b7280",fontSize:"0.8rem"},children:[" ","(auch richtig: ",g.alternatives.join(", "),")"]})]},v)})]})]})}function Xe(){if(!s||s.type!=="true-false")return null;const c=s.content;return t.jsxs("div",{style:{flex:1,minHeight:0,display:"flex",flexDirection:"column",gap:"1rem"},children:[t.jsx("div",{style:{fontSize:"1rem",lineHeight:"1.6",flex:1},children:c.statement}),t.jsx("div",{style:{display:"flex",gap:"1rem"},children:[!0,!1].map(u=>{let g="#ffffff",v="#d1d5db";return d?u===c.correctAnswer?(g="#dcfce7",v="#86efac"):u===j&&!T&&(g="#fee2e2",v="#fca5a5"):j===u&&(g="#dbeafe",v="#3b82f6"),t.jsx("button",{onClick:()=>!d&&P(u),disabled:d,style:{flex:1,padding:"1rem",background:g,border:`2px solid ${v}`,borderRadius:"6px",cursor:d?"default":"pointer",fontSize:"1rem",fontWeight:"500",transition:"all 0.2s"},children:u?"Richtig":"Falsch"},u.toString())})})]})}function et(){if(!s||s.type!=="ordering")return null;const c=s.content;return t.jsxs("div",{style:{flex:1,minHeight:0},children:[t.jsx("div",{style:{marginBottom:"0.5rem",fontSize:"0.875rem",color:"#6b7280"},children:"Ordne die Elemente in die richtige Reihenfolge"}),t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:_.map((u,g)=>{const v=c.items.indexOf(u),C=d&&c.correctOrder[g]===v,A=d?c.correctOrder.indexOf(v):-1;return t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.75rem",background:d&&C?"#dcfce7":"#ffffff",border:d&&C?"2px solid #86efac":"2px solid #d1d5db",borderRadius:"6px"},children:[t.jsxs("div",{style:{fontWeight:"500",color:"#6b7280",minWidth:"24px"},children:[g+1,"."]}),t.jsxs("div",{style:{flex:1},children:[u,d&&!C&&t.jsxs("span",{style:{fontSize:"0.8rem",color:"#ef4444",marginLeft:"0.5rem"},children:["‚Üí Position ",A+1]})]}),!d&&t.jsxs("div",{style:{display:"flex",gap:"0.25rem"},children:[g>0&&t.jsx("button",{onClick:()=>{const S=[..._];[S[g],S[g-1]]=[S[g-1],S[g]],te(S)},style:{padding:"0.25rem 0.5rem",background:"#f3f4f6",border:"none",borderRadius:"4px",cursor:"pointer"},children:"‚Üë"}),g<_.length-1&&t.jsx("button",{onClick:()=>{const S=[..._];[S[g],S[g+1]]=[S[g+1],S[g]],te(S)},style:{padding:"0.25rem 0.5rem",background:"#f3f4f6",border:"none",borderRadius:"4px",cursor:"pointer"},children:"‚Üì"})]})]},g)})}),d&&!T&&t.jsxs("div",{style:{marginTop:"1rem",padding:"1rem",background:"#f9fafb",borderRadius:"6px"},children:[t.jsx("div",{style:{fontSize:"0.875rem",fontWeight:"500",marginBottom:"0.5rem",color:"#374151"},children:"Richtige Reihenfolge:"}),c.correctOrder.map((u,g)=>t.jsxs("div",{style:{fontSize:"0.875rem",marginTop:"0.25rem",color:"#10b981"},children:[g+1,". ",t.jsx("strong",{children:c.items[u]})]},g))]})]})}function tt(){if(!s||s.type!=="matching")return null;const c=s.content;return t.jsxs("div",{style:{flex:1,minHeight:0},children:[t.jsx("div",{style:{marginBottom:"0.5rem",fontSize:"0.875rem",color:"#6b7280"},children:"Ordne die passenden Paare zu"}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.75rem"},children:c.pairs.map((u,g)=>{const v=d&&Z[g]===g,C=Z[g]!==void 0&&Z[g]!==null;return t.jsxs(K.Fragment,{children:[t.jsxs("div",{style:{padding:"0.75rem",background:"#f9fafb",border:"2px solid #d1d5db",borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"0.5rem"},children:[t.jsx("span",{children:u.left}),ae(u.left)&&t.jsx(oe,{text:u.left,size:"small"})]}),t.jsx($t,{value:Z[g]?.toString()??"",onChange:A=>{const S=parseInt(A);ue({...Z,[g]:S})},options:ve.map(A=>({value:A.toString(),label:c.pairs[A].right})),disabled:d,placeholder:"W√§hle...",error:d&&C&&!v,success:d&&v,fullWidth:!0})]},g)})}),d&&!T&&t.jsxs("div",{style:{marginTop:"1rem",padding:"1rem",background:"#f9fafb",borderRadius:"6px"},children:[t.jsx("div",{style:{fontSize:"0.875rem",fontWeight:"500",marginBottom:"0.5rem",color:"#374151"},children:"Richtige Zuordnungen:"}),c.pairs.map((u,g)=>t.jsxs("div",{style:{fontSize:"0.875rem",marginTop:"0.25rem",color:"#10b981"},children:[t.jsx("strong",{children:u.left})," ‚Üí ",t.jsx("strong",{children:u.right})]},g))]})]})}function rt(){if(!s||s.type!=="multiple-select")return null;const c=s.content,u=g=>{if(d)return;const v=new Set(b);v.has(g)?v.delete(g):v.add(g),M(v)};return t.jsxs("div",{style:{flex:1,minHeight:0},children:[t.jsx("div",{style:{marginBottom:"0.75rem",fontSize:"0.875rem",color:"#6b7280"},children:"W√§hle alle zutreffenden Antworten"}),t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:c.options.map((g,v)=>{const C=b.has(v),A=c.correctAnswers.includes(v);let S="#ffffff",B="#d1d5db",D="";return d?A?(S="#dcfce7",B="#86efac",D=C?"‚úì":"‚óã"):C&&!A&&(S="#fee2e2",B="#fca5a5",D="‚úó"):C&&(S="#dbeafe",B="#3b82f6"),t.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"0.875rem",background:S,border:`2px solid ${B}`,borderRadius:"6px",transition:"all 0.2s",position:"relative"},children:[t.jsx(Lt,{checked:C,onChange:()=>u(v),disabled:d,label:t.jsx("span",{style:{fontSize:"0.95rem",flex:1},children:g}),error:d&&C&&!A,success:d&&A&&C,style:{flex:1}}),d&&D&&t.jsx("span",{style:{fontSize:"1.25rem",fontWeight:"bold",marginLeft:"0.5rem",color:A?"#10b981":"#ef4444"},children:D})]},v)})})]})}function st(){if(!s||s.type!=="slider")return null;const c=s.content,u=c.step||1,g=c.tolerance||0;return t.jsxs("div",{style:{flex:1,minHeight:0,display:"flex",flexDirection:"column",gap:"1.5rem"},children:[t.jsx("div",{style:{textAlign:"center"},children:t.jsxs("div",{style:{fontSize:"2.5rem",fontWeight:"bold",color:d?Math.abs(E-c.correctValue)<=g?"#10b981":"#ef4444":"#3b82f6"},children:[E,c.unit||""]})}),t.jsx("div",{style:{padding:"0 1rem"},children:t.jsx(Mt,{value:E,onChange:H,min:c.min,max:c.max,step:u,disabled:d,unit:c.unit||"",showValue:!1})}),d&&t.jsx("div",{style:{padding:"1rem",background:"#f9fafb",borderRadius:"6px",textAlign:"center"},children:t.jsxs("div",{style:{fontSize:"0.875rem",fontWeight:"500",color:"#374151"},children:["Richtige Antwort: ",t.jsxs("strong",{style:{color:"#10b981",fontSize:"1.1rem"},children:[c.correctValue,c.unit||""]}),g>0&&t.jsxs("span",{style:{fontSize:"0.8rem",color:"#6b7280"},children:[" ","(¬±",g,")"]})]})})]})}function nt(){if(!s||s.type!=="word-scramble")return null;const c=s.content;return t.jsxs("div",{style:{flex:1,minHeight:0,display:"flex",flexDirection:"column",gap:"1.5rem"},children:[t.jsxs("div",{style:{padding:"1.5rem",background:"#f9fafb",borderRadius:"8px",textAlign:"center"},children:[t.jsx("div",{style:{fontSize:"0.875rem",color:"#6b7280",marginBottom:"0.5rem"},children:"Buchstabensalat:"}),t.jsx("div",{style:{fontSize:"2rem",fontWeight:"bold",letterSpacing:"0.5rem",color:"#3b82f6",fontFamily:"monospace"},children:c.scrambledWord}),c.showLength&&t.jsxs("div",{style:{fontSize:"0.875rem",color:"#6b7280",marginTop:"0.5rem"},children:["(",c.correctWord.length," Buchstaben)"]})]}),t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",marginBottom:"0.5rem",color:"#374151"},children:"Deine L√∂sung:"}),t.jsx("input",{type:"text",value:O,onChange:u=>he(u.target.value),disabled:d,placeholder:"Entschl√ºssle das Wort...",style:{width:"100%",padding:"0.875rem",fontSize:"1.1rem",border:d?O.trim().toLowerCase()===c.correctWord.toLowerCase()?"2px solid #86efac":O.trim()?"2px solid #fca5a5":"2px solid #d1d5db":"2px solid #d1d5db",borderRadius:"6px",backgroundColor:d?O.trim().toLowerCase()===c.correctWord.toLowerCase()?"#dcfce7":O.trim()?"#fee2e2":"#ffffff":"#ffffff",textAlign:"center",fontWeight:"500"}})]}),d&&!T&&t.jsxs("div",{style:{padding:"1rem",background:"#f9fafb",borderRadius:"6px",textAlign:"center"},children:[t.jsx("div",{style:{fontSize:"0.875rem",fontWeight:"500",marginBottom:"0.5rem",color:"#374151"},children:"Richtige L√∂sung:"}),t.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#10b981"},children:c.correctWord})]})]})}function it(){if(!s||s.type!=="flashcard")return null;const c=s.content;return t.jsxs("div",{style:{flex:1,minHeight:0,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:"2rem",padding:"2rem"},children:[t.jsxs("div",{style:{width:"100%",maxWidth:"500px",minHeight:"300px",background:"white",border:"3px solid #e5e7eb",borderRadius:"16px",padding:"3rem",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:"1.5rem",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",transition:"all 0.3s ease"},children:[t.jsx("div",{style:{fontSize:"0.75rem",fontWeight:"600",color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.05em"},children:c.frontLanguage==="de"?"Deutsch":c.frontLanguage==="es"?"Espa√±ol":"English"}),t.jsxs("div",{style:{fontSize:"2.5rem",fontWeight:"bold",color:"#1f2937",textAlign:"center",minHeight:"80px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"1rem"},children:[t.jsx("div",{children:c.front}),ae(c.front)&&t.jsx(oe,{text:c.front,size:"large"})]}),Pe?t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{width:"100%",height:"2px",background:"#e5e7eb",margin:"0.5rem 0"}}),t.jsx("div",{style:{fontSize:"0.75rem",fontWeight:"600",color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.05em"},children:c.backLanguage==="de"?"Deutsch":c.backLanguage==="es"?"Espa√±ol":"English"}),t.jsxs("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"#10b981",textAlign:"center",minHeight:"60px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"1rem"},children:[t.jsx("div",{children:c.back}),ae(c.back)&&t.jsx(oe,{text:c.back,size:"large"})]})]}):t.jsx("button",{onClick:()=>Be(!0),disabled:d,style:{padding:"1rem 2.5rem",background:"#3b82f6",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"1.125rem",fontWeight:"500",transition:"all 0.2s",boxShadow:"0 2px 4px rgba(59, 130, 246, 0.3)"},onMouseEnter:u=>{u.currentTarget.style.background="#2563eb",u.currentTarget.style.transform="translateY(-1px)"},onMouseLeave:u=>{u.currentTarget.style.background="#3b82f6",u.currentTarget.style.transform="translateY(0)"},children:"Ergebnis anzeigen"})]}),Pe&&!d&&t.jsxs("div",{style:{display:"flex",gap:"1.5rem",justifyContent:"center",width:"100%",maxWidth:"500px"},children:[t.jsxs("button",{onClick:()=>{ke(!1),je()},style:{flex:1,padding:"1.25rem",background:"#fee2e2",color:"#dc2626",border:"2px solid #fca5a5",borderRadius:"12px",cursor:"pointer",fontSize:"1.125rem",fontWeight:"600",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.75rem",transition:"all 0.2s"},onMouseEnter:u=>{u.currentTarget.style.background="#fecaca",u.currentTarget.style.transform="scale(1.02)"},onMouseLeave:u=>{u.currentTarget.style.background="#fee2e2",u.currentTarget.style.transform="scale(1)"},children:[t.jsx("span",{style:{fontSize:"1.75rem"},children:"‚úó"}),t.jsx("span",{children:"Nicht gewusst"})]}),t.jsxs("button",{onClick:()=>{ke(!0),je()},style:{flex:1,padding:"1.25rem",background:"#dcfce7",color:"#16a34a",border:"2px solid #86efac",borderRadius:"12px",cursor:"pointer",fontSize:"1.125rem",fontWeight:"600",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.75rem",transition:"all 0.2s"},onMouseEnter:u=>{u.currentTarget.style.background="#bbf7d0",u.currentTarget.style.transform="scale(1.02)"},onMouseLeave:u=>{u.currentTarget.style.background="#dcfce7",u.currentTarget.style.transform="scale(1)"},children:[t.jsx("span",{style:{fontSize:"1.75rem"},children:"‚úì"}),t.jsx("span",{children:"Gewusst"})]})]}),d&&c.explanation&&t.jsxs("div",{style:{width:"100%",maxWidth:"500px",padding:"1rem",background:"#f3f4f6",borderRadius:"8px",fontSize:"0.95rem",color:"#4b5563",lineHeight:"1.6"},children:[t.jsx("strong",{children:"Hinweis:"})," ",c.explanation]})]})}function at(){if(!s||s.type!=="text-input")return null;const c=s.content;return t.jsxs("div",{style:{flex:1,minHeight:0,display:"flex",flexDirection:"column",gap:"1.5rem"},children:[t.jsxs("div",{style:{padding:"2rem",background:"#ffffff",borderRadius:"12px",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"},children:[t.jsx(Ee,{value:fe,onChange:u=>Le(u.target.value),disabled:d,placeholder:"Deine Antwort...",error:d&&!T,success:d&&T,fullWidth:!0,style:{fontSize:"1.125rem",padding:"1rem"}}),d&&!T&&t.jsxs("div",{style:{marginTop:"1rem",padding:"0.75rem",background:"#f3f4f6",borderRadius:"6px",fontSize:"0.95rem",color:"#4b5563",display:"flex",alignItems:"center",gap:"0.5rem"},children:[t.jsxs("div",{children:[t.jsx("strong",{children:"Richtige Antwort:"})," ",c.correctAnswer]}),ae(c.correctAnswer)&&t.jsx(oe,{text:c.correctAnswer,size:"small"})]})]}),c.hint&&!d&&t.jsxs("div",{style:{padding:"0.75rem 1rem",background:"#fef3c7",border:"1px solid #fbbf24",borderRadius:"6px",fontSize:"0.9rem",color:"#92400e"},children:["üí° ",t.jsx("strong",{children:"Tipp:"})," ",c.hint]})]})}if(!l||!s)return t.jsx("div",{style:{padding:"2rem",textAlign:"center"},children:t.jsx("p",{children:"Wird geladen..."})});const ot=(x+1)/l.execution.taskIds.length*100;return t.jsxs("div",{style:{minHeight:"100vh",display:"flex",flexDirection:"column",padding:"1rem",maxWidth:"900px",margin:"0 auto"},children:[t.jsxs("div",{style:{marginBottom:"1rem",flexShrink:0},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[t.jsx("h2",{style:{margin:0,fontSize:"1.25rem"},children:"√úbungssitzung"}),t.jsxs("span",{style:{fontSize:"0.875rem",color:"#6b7280"},children:[x+1,"/",l.execution.taskIds.length]}),t.jsxs("span",{style:{fontSize:"0.75rem",color:"#9ca3af",fontFamily:"monospace"},children:["ID: ",s.id]})]}),t.jsx("button",{onClick:a,style:{padding:"0.5rem 1rem",background:"#e5e7eb",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"0.875rem"},children:"Abbrechen"})]}),t.jsx("div",{style:{width:"100%",height:"6px",background:"#e5e7eb",borderRadius:"3px",overflow:"hidden"},children:t.jsx("div",{style:{width:`${ot}%`,height:"100%",background:"#3b82f6",transition:"width 0.3s ease"}})})]}),t.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",background:"#f9fafb",padding:"1.5rem",borderRadius:"8px",marginBottom:"1rem",minHeight:0},children:[(s.type==="multiple-choice"||s.type==="ordering"||s.type==="matching"||s.type==="multiple-select"||s.type==="slider"||s.type==="word-scramble"||s.type==="text-input")&&t.jsxs("div",{style:{marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.75rem"},children:[t.jsx("h3",{style:{margin:0,fontSize:"1.1rem",lineHeight:"1.4",flex:1},children:s.content.question}),ae(s.content.question)&&t.jsx(oe,{text:s.content.question,size:"medium"})]}),Ze()]}),d&&t.jsx("div",{style:{marginBottom:"1rem",flexShrink:0},children:t.jsx(qe,{variant:T?"success":"error",title:T?"Richtig!":"Nicht ganz richtig",children:s.content.explanation&&t.jsx("p",{style:{margin:0},children:s.content.explanation})})}),t.jsxs("div",{style:{flexShrink:0,display:"flex",flexDirection:"column",gap:"1rem"},children:[t.jsx("div",{style:{display:"flex",justifyContent:"center",gap:"1rem"},children:d?t.jsx("button",{onClick:Ye,style:{padding:"0.875rem 2rem",background:"#3b82f6",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"1rem",fontWeight:"500"},children:x<l.execution.taskIds.length-1?"N√§chste Aufgabe ‚Üí":"Sitzung beenden"}):t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:je,disabled:!Re(),style:{padding:"0.875rem 2rem",background:Re()?"#3b82f6":"#9ca3af",color:"white",border:"none",borderRadius:"8px",cursor:Re()?"pointer":"not-allowed",fontSize:"1rem",fontWeight:"500"},children:"Antwort √ºberpr√ºfen"}),t.jsx("button",{onClick:x<l.execution.taskIds.length-1?Ue:Me,style:{padding:"0.875rem 2rem",background:"#f3f4f6",color:"#6b7280",border:"1px solid #d1d5db",borderRadius:"8px",cursor:"pointer",fontSize:"1rem",fontWeight:"500"},children:x<l.execution.taskIds.length-1?"√úberspringen ‚Üí":"Sitzung beenden"})]})}),t.jsxs("div",{style:{padding:"0.75rem 1rem",background:"#f9fafb",borderRadius:"6px",display:"flex",justifyContent:"space-around",gap:"1rem"},children:[t.jsxs("div",{style:{textAlign:"center"},children:[t.jsx("div",{style:{fontSize:"1.25rem",fontWeight:"bold",color:"#3b82f6"},children:l.execution.completedCount}),t.jsx("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:"beantwortet"})]}),t.jsxs("div",{style:{textAlign:"center"},children:[t.jsx("div",{style:{fontSize:"1.25rem",fontWeight:"bold",color:"#10b981"},children:l.execution.correctCount}),t.jsx("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:"richtig"})]}),t.jsxs("div",{style:{textAlign:"center"},children:[t.jsxs("div",{style:{fontSize:"1.25rem",fontWeight:"bold",color:"#f59e0b"},children:[l.execution.completedCount>0?Math.round(l.execution.correctCount/l.execution.completedCount*100):0,"%"]}),t.jsx("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:"genau"})]})]})]})]})}function X({title:i,value:e,subtitle:r,color:n=p.primary[500],icon:o,className:a="",style:l={},...m}){const s={borderLeft:`4px solid ${n}`,...l};return t.jsx(se,{...m,padding:"medium",shadow:!0,border:!0,style:s,className:a,children:t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:y[2]},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx("h3",{style:{margin:0,fontSize:w.fontSize.sm,fontWeight:w.fontWeight.medium,color:h.text.secondary,textTransform:"uppercase",letterSpacing:w.letterSpacing.wide},children:i}),o&&t.jsx("div",{style:{display:"flex",alignItems:"center",color:n,fontSize:w.fontSize.xl},children:o})]}),t.jsx("div",{style:{fontSize:w.fontSize["3xl"],fontWeight:w.fontWeight.bold,color:h.text.primary,lineHeight:w.lineHeight.tight},children:e}),r&&t.jsx("div",{style:{fontSize:w.fontSize.sm,color:h.text.tertiary},children:r})]})})}function be({variant:i="primary",size:e="medium",loading:r=!1,fullWidth:n=!1,disabled:o=!1,startIcon:a,endIcon:l,children:m,className:s="",style:f={},...x}){const z=Wt(i),R=Et(e),I={display:"inline-flex",alignItems:"center",justifyContent:"center",gap:y[2],border:"none",borderRadius:W.button.borderRadius,fontFamily:w.fontFamily.sans,fontWeight:w.fontWeight.medium,cursor:o||r?"not-allowed":"pointer",transition:ne.presets.colors,textDecoration:"none",userSelect:"none",outline:"none",width:n?"100%":"auto",...z,...R,opacity:o||r?.6:1,...f};return t.jsx("button",{...x,disabled:o||r,style:I,className:s,onMouseEnter:d=>{if(!o&&!r){const $=_t(i);Object.assign(d.currentTarget.style,$)}x.onMouseEnter?.(d)},onMouseLeave:d=>{!o&&!r&&Object.assign(d.currentTarget.style,z),x.onMouseLeave?.(d)},onFocus:d=>{!o&&!r&&(d.currentTarget.style.outline=`2px solid ${p.primary[300]}`,d.currentTarget.style.outlineOffset="2px"),x.onFocus?.(d)},onBlur:d=>{d.currentTarget.style.outline="none",x.onBlur?.(d)},children:r?t.jsxs(t.Fragment,{children:[t.jsx(Ot,{size:e}),m]}):t.jsxs(t.Fragment,{children:[a&&t.jsx("span",{style:{display:"flex",alignItems:"center"},children:a}),m,l&&t.jsx("span",{style:{display:"flex",alignItems:"center"},children:l})]})})}function Wt(i){const e={border:"2px solid transparent"};switch(i){case"primary":return{...e,backgroundColor:p.primary[500],color:p.neutral[0]};case"secondary":return{...e,backgroundColor:p.neutral[200],color:p.neutral[700]};case"ghost":return{...e,backgroundColor:"transparent",color:p.neutral[700],border:`2px solid ${p.neutral[300]}`};case"danger":return{...e,backgroundColor:p.error[500],color:p.neutral[0]};default:return e}}function _t(i){switch(i){case"primary":return{backgroundColor:p.primary[600]};case"secondary":return{backgroundColor:p.neutral[300]};case"ghost":return{backgroundColor:p.neutral[50],borderColor:p.neutral[400]};case"danger":return{backgroundColor:p.error[600]};default:return{}}}function Et(i){switch(i){case"small":return{height:W.button.height.sm,padding:W.button.padding.sm,fontSize:W.button.fontSize.sm};case"medium":return{height:W.button.height.md,padding:W.button.padding.md,fontSize:W.button.fontSize.md};case"large":return{height:W.button.height.lg,padding:W.button.padding.lg,fontSize:W.button.fontSize.lg};default:return{}}}function Ot({size:i}){const e=i==="small"?"12px":i==="large"?"18px":"16px";return t.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{animation:"spin 1s linear infinite"},children:[t.jsx("style",{children:`
        @keyframes spin {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
      `}),t.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeDasharray:"31.4 31.4",opacity:"0.25"}),t.jsx("path",{d:"M12 2a10 10 0 0 1 10 10",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round"})]})}function Ht({session:i,onClose:e,onStartNew:r}){const n=i.results.accuracy,o=Math.round(i.results.averageTime);let a="",l="";n>=90?(a="Ausgezeichnet!",l=p.success[500]):n>=75?(a="Sehr gut!",l=p.primary[500]):n>=60?(a="Gut gemacht!",l=p.warning[500]):(a="Weiter √ºben!",l=p.error[500]);function m(s){const f=Math.floor(s/60),x=s%60;return f>0?`${f}:${x.toString().padStart(2,"0")} min`:`${x} sek`}return t.jsxs("div",{style:{padding:y[8],maxWidth:"600px",margin:"0 auto",textAlign:"center"},children:[t.jsxs("div",{style:{marginBottom:y[8]},children:[t.jsx("div",{style:{fontSize:"4rem",marginBottom:y[4]},children:"üéâ"}),t.jsx("h1",{style:{marginBottom:y[2]},children:"Sitzung abgeschlossen!"}),t.jsx("p",{style:{fontSize:w.fontSize["2xl"],fontWeight:w.fontWeight.bold,color:l,margin:0},children:a})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:y[4],marginBottom:y[8]},children:[t.jsx(X,{title:"Aufgaben bearbeitet",value:i.execution.completedCount,color:p.primary[500]}),t.jsx(X,{title:"Richtige Antworten",value:i.execution.correctCount,color:p.success[500]}),t.jsx(X,{title:"Genauigkeit",value:`${Math.round(n)}%`,color:l}),t.jsx(X,{title:"√ò Zeit pro Aufgabe",value:m(o),color:p.warning[500]})]}),t.jsx(se,{padding:"medium",style:{backgroundColor:p.primary[100],marginBottom:y[8]},children:t.jsxs("p",{style:{margin:0,fontSize:w.fontSize.base},children:[t.jsx("strong",{children:"Gesamtzeit:"})," ",m(i.execution.totalTimeSpent)]})}),t.jsxs(se,{padding:"large",style:{marginBottom:y[8]},children:[t.jsx("h3",{style:{marginBottom:y[2]},children:"üìà Dein Fortschritt"}),t.jsxs("p",{style:{margin:0,fontSize:w.fontSize.base,color:h.text.secondary,lineHeight:w.lineHeight.relaxed},children:[n>=90&&"Hervorragende Leistung! Du beherrschst dieses Thema sehr gut.",n>=75&&n<90&&"Sehr gute Arbeit! Du machst gro√üe Fortschritte.",n>=60&&n<75&&"Gute Arbeit! Weiter so, du verbesserst dich stetig.",n<60&&"Bleib dran! √úbung macht den Meister. Die n√§chste Sitzung wird noch besser!"]})]}),t.jsxs(qe,{variant:"success",style:{marginBottom:y[8]},children:[t.jsx("h4",{style:{marginBottom:y[2]},children:"üß† Spaced Repetition aktiviert"}),t.jsx("p",{style:{margin:0,fontSize:w.fontSize.sm,lineHeight:w.lineHeight.normal},children:"Deine Antworten wurden gespeichert. Aufgaben, die du nicht sofort beherrscht hast, werden dir in optimalen Abst√§nden wieder vorgelegt, um dein Langzeitged√§chtnis zu trainieren."})]}),t.jsxs("div",{style:{display:"flex",gap:y[4],justifyContent:"center"},children:[t.jsx(be,{onClick:r,variant:"primary",children:"Neue Sitzung starten"}),t.jsx(be,{onClick:e,variant:"secondary",children:"Zur√ºck zur √úbersicht"})]})]})}function Ie({label:i,count:e,color:r,max:n}){const o=n&&n>0?e/n*100:e>0?100:0;return t.jsxs("div",{style:{flex:1},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:y[2]},children:[t.jsx("span",{style:{fontSize:w.fontSize.sm,fontWeight:w.fontWeight.medium},children:i}),t.jsx("span",{style:{fontSize:w.fontSize.sm,color:h.text.secondary},children:e})]}),t.jsx("div",{style:{background:h.background.tertiary,height:"8px",borderRadius:N.md,overflow:"hidden"},children:t.jsx("div",{style:{background:r,height:"100%",width:`${o}%`,transition:ne.presets.base}})})]})}function Nt({onClose:i}){const[e,r]=k.useState(null),[n,o]=k.useState(!0);k.useEffect(()=>{a()},[]);async function a(){try{const s=await L.practiceSessions.toArray(),f=s.filter(j=>j.execution.status==="completed"),x=await L.topics.toArray(),z=new Map(x.map(j=>[j.id,j])),R=await L.spacedRepetition.toArray(),I=f.reduce((j,P)=>j+(P.execution?.completedCount||0),0),d=f.reduce((j,P)=>j+(P.execution?.correctCount||0),0),$=I>0?d/I*100:0,T=f.reduce((j,P)=>P.execution.startedAt&&P.execution.completedAt?j+(new Date(P.execution.completedAt).getTime()-new Date(P.execution.startedAt).getTime())/1e3:j,0),F=f.length>0?T/f.length:0,V=new Map;for(const j of f){const P=j.configuration.topicId;V.has(P)||V.set(P,{sessions:0,correct:0,total:0});const _=V.get(P);_.sessions++,_.correct+=j.execution?.correctCount||0,_.total+=j.execution?.completedCount||0}const Y=Array.from(V.entries()).map(([j,P])=>({topicId:j,topicName:z.get(j)?.title||j,sessionsCompleted:P.sessions,accuracy:P.total>0?P.correct/P.total*100:0,tasksReviewed:P.total})),q=new Date,ie=R.filter(j=>j.algorithm.efactor>=2.5).length,Q=R.filter(j=>j.algorithm.efactor<2.5&&j.algorithm.repetition>0).length,de=R.filter(j=>j.algorithm.repetition===0).length,G=R.filter(j=>new Date(j.schedule.nextReview)<=q).length,ee=f.sort((j,P)=>{const _=j.execution.completedAt?new Date(j.execution.completedAt).getTime():0;return(P.execution.completedAt?new Date(P.execution.completedAt).getTime():0)-_}).slice(0,5);r({totalSessions:s.length,completedSessions:f.length,totalQuestions:I,correctAnswers:d,accuracyRate:$,averageSessionTime:F,currentStreak:0,totalStudyTime:T,topicProgress:Y,recentSessions:ee,upcomingReviews:G,masteryLevels:{mastered:ie,learning:Q,new:de}})}catch(s){console.error("Failed to load dashboard stats:",s)}finally{o(!1)}}function l(s){const f=Math.floor(s/3600),x=Math.floor(s%3600/60);return f>0?`${f}h ${x}m`:`${x}m`}function m(s){return(typeof s=="string"?new Date(s):s).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric"})}return n?t.jsxs("div",{style:{padding:y[8],fontFamily:w.fontFamily.sans,textAlign:"center"},children:[t.jsx("h1",{children:"üìä Dashboard"}),t.jsx("p",{children:"Lade Statistiken..."})]}):e?t.jsxs("div",{style:{padding:y[8],fontFamily:w.fontFamily.sans,maxWidth:"1200px",margin:"0 auto"},children:[t.jsxs("div",{style:{marginBottom:y[8]},children:[t.jsx(be,{variant:"secondary",onClick:i,style:{marginBottom:y[4]},children:"‚Üê Zur√ºck"}),t.jsx("h1",{style:{margin:0},children:"üìä Lern-Dashboard"}),t.jsx("p",{style:{color:h.text.secondary,marginTop:y[2]},children:"Deine Fortschritte und Statistiken im √úberblick"})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:y[4],marginBottom:y[8]},children:[t.jsx(X,{title:"Gesamt Sitzungen",value:e.completedSessions.toString(),subtitle:`von ${e.totalSessions} gestartet`,color:p.primary[500]}),t.jsx(X,{title:"Genauigkeit",value:`${Math.round(e.accuracyRate)}%`,subtitle:`${e.correctAnswers}/${e.totalQuestions} richtig`,color:p.success[500]}),t.jsx(X,{title:"Lernzeit",value:l(e.totalStudyTime),subtitle:`√ò ${l(e.averageSessionTime)} pro Sitzung`,color:p.warning[500]}),t.jsx(X,{title:"Anstehende Wiederholungen",value:e.upcomingReviews.toString(),subtitle:"bereit zum √úben",color:p.info[500]})]}),t.jsxs(se,{padding:"medium",style:{marginBottom:y[8]},children:[t.jsx("h2",{style:{marginTop:0},children:"üéØ Beherrschungsniveau"}),t.jsxs("div",{style:{display:"flex",gap:y[4],marginTop:y[4]},children:[t.jsx(Ie,{label:"Gemeistert",count:e.masteryLevels.mastered,color:p.success[500]}),t.jsx(Ie,{label:"In Arbeit",count:e.masteryLevels.learning,color:p.warning[500]}),t.jsx(Ie,{label:"Neu",count:e.masteryLevels.new,color:p.primary[500]})]})]}),e.topicProgress.length>0&&t.jsxs(se,{padding:"medium",style:{marginBottom:y[8]},children:[t.jsx("h2",{style:{marginTop:0},children:"üìö Fortschritt nach Thema"}),t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:y[4],marginTop:y[4]},children:e.topicProgress.map(s=>t.jsxs("div",{children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:y[2]},children:[t.jsx("span",{style:{fontWeight:w.fontWeight.medium},children:s.topicName}),t.jsxs("span",{style:{color:h.text.secondary,fontSize:w.fontSize.sm},children:[s.sessionsCompleted," Sitzungen ‚Ä¢ ",Math.round(s.accuracy),"% genau"]})]}),t.jsx("div",{style:{background:h.background.tertiary,height:"8px",borderRadius:N.md,overflow:"hidden"},children:t.jsx("div",{style:{background:s.accuracy>=75?p.success[500]:s.accuracy>=50?p.warning[500]:p.error[500],height:"100%",width:`${s.accuracy}%`,transition:ne.presets.base}})}),t.jsxs("div",{style:{fontSize:w.fontSize.xs,color:h.text.secondary,marginTop:y[1]},children:[s.tasksReviewed," Aufgaben bearbeitet"]})]},s.topicId))})]}),e.recentSessions.length>0&&t.jsxs(se,{padding:"medium",children:[t.jsx("h2",{style:{marginTop:0},children:"üïê Letzte Sitzungen"}),t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:y[3],marginTop:y[4]},children:e.recentSessions.map(s=>t.jsxs("div",{style:{padding:y[4],background:h.background.secondary,borderRadius:N.md,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{fontWeight:w.fontWeight.medium},children:s.configuration.topicId}),t.jsx("div",{style:{fontSize:w.fontSize.sm,color:h.text.secondary},children:s.execution.completedAt&&m(s.execution.completedAt)})]}),t.jsxs("div",{style:{textAlign:"right"},children:[t.jsxs("div",{style:{fontWeight:w.fontWeight.medium,color:s.results.accuracy>=75?p.success[500]:p.warning[500]},children:[Math.round(s.results.accuracy),"%"]}),t.jsxs("div",{style:{fontSize:w.fontSize.sm,color:h.text.secondary},children:[s.execution.correctCount,"/",s.execution.completedCount]})]})]},s.id))})]})]}):t.jsxs("div",{style:{padding:y[8],fontFamily:w.fontFamily.sans},children:[t.jsx(be,{variant:"secondary",onClick:i,style:{marginBottom:y[4]},children:"‚Üê Zur√ºck"}),t.jsx("h1",{children:"üìä Dashboard"}),t.jsx("p",{children:"Keine Daten verf√ºgbar."})]})}const qt=({topic:i,onSelect:e,className:r,disabled:n=!1,"data-testid":o})=>{const[a,l]=K.useState(!1),m={padding:"2rem",background:i.color||"#dbeafe",borderRadius:"12px",cursor:n?"not-allowed":"pointer",transition:"transform 0.2s, box-shadow 0.2s",border:"2px solid transparent",borderColor:a?"#3b82f6":"transparent",transform:a&&!n?"translateY(-4px)":"translateY(0)",boxShadow:a&&!n?"0 10px 25px rgba(0,0,0,0.1)":"none",opacity:n?.5:1},s=`Thema ${i.name} √∂ffnen - ${i.description}`;return t.jsxs("button",{type:"button",onClick:()=>e(i.id),className:r,"data-testid":o,style:m,onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),disabled:n,"aria-label":s,children:[i.icon&&t.jsx("span",{"aria-hidden":"true",style:{fontSize:"48px",display:"block",marginBottom:"16px"},children:i.icon}),t.jsx("h3",{style:{fontSize:"20px",fontWeight:600,marginBottom:"8px"},children:i.name}),t.jsx("p",{style:{fontSize:"14px",color:"#666",lineHeight:1.5,margin:0},children:i.description})]})};function Gt(){const[i,e]=k.useState([]),[r,n]=k.useState(null),[o,a]=k.useState([]),[l,m]=k.useState({}),[s,f]=k.useState(null),[x,z]=k.useState(!0),[R,I]=k.useState(!1),[d,$]=k.useState(null),[T,F]=k.useState(!1),[V,Y]=k.useState(!1),[q,ie]=k.useState({targetCount:10,includeReview:!0}),Q=k.useRef(!1);k.useEffect(()=>{Q.current||(Q.current=!0,de())},[]);async function de(){try{const b=await L.topics.count(),M=await L.tasks.count();console.log(`Database status: ${b} topics, ${M} tasks`),b===0||M===0?(console.log("Database empty or incomplete, seeding..."),await We(L)):console.log("Database already seeded, skipping seed");const E=await L.topics.toArray();e(E),z(!1)}catch(b){console.error("Failed to initialize app:",b),console.error("Error details:",{name:b?.name,message:b?.message,failures:b?.failures,stack:b?.stack}),z(!1)}}async function G(b){n(b);const M=await L.learningPaths.where("topicId").equals(b.id).toArray();console.log(`Loading learning paths for topic ${b.id}:`,M),M.sort((H,O)=>new Date(O.createdAt).getTime()-new Date(H.createdAt).getTime());const E={};for(const H of M){const O=await L.tasks.where("learningPathId").equals(H.id).toArray();E[H.id]=O.length,console.log(`Learning path "${H.title}" (${H.id}): ${O.length} tasks in DB, taskIds array length: ${H.taskIds?.length||0}`),console.log("Task IDs:",O.map(he=>he.id))}m(E),a(M)}function ee(b){f(b),Y(!0)}function j(){Y(!1),I(!0)}function P(){Y(!1),f(null)}async function _(){if(I(!1),s&&r){const b=await L.practiceSessions.where("execution.status").equals("completed").reverse().limit(1).toArray();b.length>0&&b[0]&&$(b[0])}}function te(){I(!1),f(null)}function Z(){$(null)}function ue(){$(null),s&&I(!0)}if(x)return t.jsxs("div",{style:{padding:"2rem",fontFamily:"system-ui, sans-serif",textAlign:"center"},children:[t.jsx("h1",{children:"üß† MindForge Academy"}),t.jsx("p",{children:"Wird geladen..."})]});if(T)return t.jsx("div",{style:{fontFamily:"system-ui, sans-serif"},children:t.jsx(Nt,{onClose:()=>F(!1)})});if(d)return t.jsx("div",{style:{fontFamily:"system-ui, sans-serif"},children:t.jsx(Ht,{session:d,onClose:Z,onStartNew:ue})});if(V&&s&&r)return t.jsxs("div",{style:{padding:"2rem",fontFamily:"system-ui, sans-serif",maxWidth:"600px",margin:"0 auto"},children:[t.jsx("button",{onClick:P,style:{padding:"0.5rem 1rem",background:"#e5e7eb",border:"none",borderRadius:"4px",cursor:"pointer",marginBottom:"1rem"},children:"‚Üê Zur√ºck"}),t.jsx("h1",{style:{marginBottom:"0.5rem"},children:"Sitzung konfigurieren"}),t.jsx("p",{style:{color:"#6b7280",marginBottom:"2rem"},children:s.title}),t.jsxs("div",{style:{marginBottom:"2rem"},children:[t.jsx("label",{style:{display:"block",fontWeight:"500",marginBottom:"0.5rem"},children:"Anzahl der Fragen"}),t.jsx("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[5,10,15,20].map(b=>t.jsx("button",{onClick:()=>ie({...q,targetCount:b}),style:{padding:"0.75rem 1.5rem",background:q.targetCount===b?"#3b82f6":"#f3f4f6",color:q.targetCount===b?"white":"#374151",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"1rem",fontWeight:"500"},children:b},b))})]}),t.jsxs("div",{style:{marginBottom:"2rem"},children:[t.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[t.jsx("input",{type:"checkbox",checked:q.includeReview,onChange:b=>ie({...q,includeReview:b.target.checked}),style:{marginRight:"0.5rem",width:"1.25rem",height:"1.25rem",cursor:"pointer"}}),t.jsx("span",{children:"Wiederholungsfragen einbeziehen"})]}),t.jsx("p",{style:{fontSize:"0.875rem",color:"#6b7280",marginTop:"0.5rem",marginLeft:"1.75rem"},children:"Fragen, die du bereits beantwortet hast und die zur Wiederholung f√§llig sind"})]}),t.jsx("button",{onClick:j,style:{padding:"1rem 2rem",background:"#3b82f6",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"1.1rem",fontWeight:"500",width:"100%"},children:"Sitzung starten ‚Üí"})]});if(R&&s&&r)return t.jsx("div",{style:{fontFamily:"system-ui, sans-serif"},children:t.jsx(Ft,{topicId:r.id,learningPathIds:[s.id],targetCount:q.targetCount,includeReview:q.includeReview,onComplete:_,onCancel:te})});if(r)return t.jsxs("div",{style:{padding:"2rem",fontFamily:"system-ui, sans-serif"},children:[t.jsx("button",{onClick:()=>n(null),style:{padding:"0.5rem 1rem",background:"#e5e7eb",border:"none",borderRadius:"4px",cursor:"pointer",marginBottom:"1rem"},children:"‚Üê Zur√ºck zu Themen"}),t.jsxs("h1",{children:["üìö ",r.title]}),t.jsx("h2",{style:{marginTop:"2rem",marginBottom:"1rem"},children:"Lernpfade"}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"1rem"},children:o.map(b=>t.jsxs("div",{style:{padding:"1.5rem",background:"#ffffff",border:"2px solid #e5e7eb",borderRadius:"8px",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:M=>{M.currentTarget.style.borderColor="#3b82f6",M.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:M=>{M.currentTarget.style.borderColor="#e5e7eb",M.currentTarget.style.transform="translateY(0)"},children:[t.jsx("h3",{style:{marginBottom:"0.5rem"},children:b.title}),t.jsx("p",{style:{fontSize:"0.9rem",color:"#6b7280",marginBottom:"1rem"},children:b.description}),t.jsxs("div",{style:{fontSize:"0.85rem",color:"#9ca3af"},children:[t.jsx("span",{style:{marginRight:"1rem"},children:b.difficulty==="easy"?"üü¢ Leicht":b.difficulty==="medium"?"üü° Mittel":"üî¥ Schwer"}),t.jsxs("span",{children:[l[b.id]||b.taskIds?.length||0," Aufgaben"]})]}),t.jsx("button",{onClick:()=>ee(b),style:{marginTop:"1rem",padding:"0.5rem 1rem",background:"#3b82f6",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",width:"100%"},children:"Lernpfad starten ‚Üí"})]},b.id))})]});async function ve(){if(confirm("Datenbank neu laden? Dies wird alle Lernpfade aktualisieren, aber dein Fortschritt bleibt erhalten."))try{await L.topics.clear(),await L.learningPaths.clear(),await L.tasks.clear(),await We(L);const b=await L.topics.toArray();e(b),alert("‚úÖ Datenbank erfolgreich aktualisiert!")}catch(b){console.error("Reseed failed:",b),alert("‚ùå Fehler beim Aktualisieren der Datenbank")}}function ge(b){const M=b.id==="test"?"üéØ":b.id==="mathematik"?"üî¢":"üß¨",E=b.id==="test"?"#fef3c7":b.id==="mathematik"?"#dbeafe":"#dcfce7";return{id:b.id,name:b.title,description:`${b.learningPathIds.length} Lernpfade`,icon:M,color:E}}return t.jsxs("div",{style:{padding:"2rem",fontFamily:"system-ui, sans-serif"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem"},children:[t.jsxs("div",{children:[t.jsx("h1",{children:"üß† MindForge Academy"}),t.jsx("p",{style:{fontSize:"1.1rem",color:"#6b7280",marginTop:"0.5rem"},children:"Erweitere dein Wissen, eine Frage nach der anderen"})]}),t.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[t.jsx("button",{onClick:ve,style:{padding:"0.75rem 1.5rem",background:"#f59e0b",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"1rem",fontWeight:"500",display:"flex",alignItems:"center",gap:"0.5rem"},children:"üîÑ DB Aktualisieren"}),t.jsx("button",{onClick:()=>F(!0),style:{padding:"0.75rem 1.5rem",background:"#3b82f6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"1rem",fontWeight:"500",display:"flex",alignItems:"center",gap:"0.5rem"},children:"üìä Dashboard"})]})]}),t.jsx("h2",{style:{marginTop:0,marginBottom:"1rem"},children:"Themen ausw√§hlen"}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(250px, 1fr))",gap:"1.5rem"},children:i.map(b=>t.jsx(qt,{topic:ge(b),onSelect:M=>{const E=i.find(H=>H.id===M);E&&G(E)},"data-testid":`topic-card-${b.id}`},b.id))})]})}Te.createRoot(document.getElementById("root")).render(t.jsx(K.StrictMode,{children:t.jsx(Gt,{})}));
//# sourceMappingURL=index-DxCapffb.js.map
