import{r as x,a as it,R as ce}from"./react-DnQQq7lD.js";import{D as at}from"./storage-7oeF2ZJA.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function s(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=s(a);fetch(a.href,i)}})();var _e={exports:{}},me={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ot=x,lt=Symbol.for("react.element"),ct=Symbol.for("react.fragment"),dt=Object.prototype.hasOwnProperty,ut=ot.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ht={key:!0,ref:!0,__self:!0,__source:!0};function We(l,e,s){var n,a={},i=null,o=null;s!==void 0&&(i=""+s),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)dt.call(e,n)&&!ht.hasOwnProperty(n)&&(a[n]=e[n]);if(l&&l.defaultProps)for(n in e=l.defaultProps,e)a[n]===void 0&&(a[n]=e[n]);return{$$typeof:lt,type:l,key:i,ref:o,props:a,_owner:ut.current}}me.Fragment=ct;me.jsx=We;me.jsxs=We;_e.exports=me;var t=_e.exports,Ce={},Le=it;Ce.createRoot=Le.createRoot,Ce.hydrateRoot=Le.hydrateRoot;class ft extends at{topics;learningPaths;tasks;answerHistory;userProgress;practiceSessions;spacedRepetition;constructor(){super("mindforge-academy-test"),this.version(1).stores({topics:"id, title, isActive, createdAt",learningPaths:"id, topicId, difficulty, isActive, createdAt",tasks:"id, learningPathId, type, *metadata.tags, metadata.difficulty, createdAt",answerHistory:"id, taskId, sessionId, timestamp, isCorrect",userProgress:"id, topicId, learningPathId, *milestones.lastActivity",practiceSessions:"id, execution.status, execution.startedAt, execution.completedAt, createdAt",spacedRepetition:"id, taskId, schedule.nextReview, algorithm.interval, createdAt"})}}const A=new ft;async function gt(){const l=new Map,e=[],s=[],n={mathematik:["algebra-basics.json","geometry-basics.json","advanced-tasks.json","brueche-grundlagen.json"],biologie:["zellbiologie.json","genetik-basics.json"],spanisch:["spanisch-grundlagen.json","begruessung-vorstellung.json","familie-persoenliches.json","zahlen-farben-tiere.json","vokabeltest-karteikarten.json"],test:["all-task-types.json"]};for(const[a,i]of Object.entries(n)){if(!l.has(a)){const o=pt(a);l.set(a,o)}for(const o of i)try{const r=`/learning-platform/test/learning-paths/${a}/${o}`,g=await fetch(r);if(!g.ok){console.warn(`Failed to load ${r}: ${g.status}`);continue}const b=await g.json(),B=b.tasks.map(h=>h.id),C={...b.learningPath,taskIds:B,createdAt:b.learningPath.createdAt?new Date(b.learningPath.createdAt):new Date("2024-01-01"),updatedAt:b.learningPath.createdAt?new Date(b.learningPath.createdAt):new Date("2024-01-01")};e.push(C);const z=l.get(a);z.learningPathIds.includes(C.id)||z.learningPathIds.push(C.id);for(const h of b.tasks){const W={...h,createdAt:new Date("2024-01-01"),updatedAt:new Date("2024-01-01")};s.push(W)}}catch(m){console.error(`Failed to load learning path ${a}/${o}:`,m)}}return{topics:Array.from(l.values()),learningPaths:e,tasks:s}}function pt(l){const s={test:{id:"test",title:"Test & Demo",description:"Demonstriert alle Aufgabentypen der Plattform",metadata:{estimatedHours:1,difficultyLevel:"beginner",prerequisites:[]}},mathematik:{id:"mathematik",title:"Mathematik",description:"Grundlagen der Mathematik: Algebra, Geometrie und mehr",metadata:{estimatedHours:40,difficultyLevel:"intermediate",prerequisites:[]}},biologie:{id:"biologie",title:"Biologie",description:"Einf√ºhrung in die Biologie: Zellen, Genetik und √ñkosysteme",metadata:{estimatedHours:35,difficultyLevel:"beginner",prerequisites:[]}},spanisch:{id:"spanisch",title:"Spanisch",description:"Lerne Spanisch: Vokabeln, Grammatik und Konversation",metadata:{estimatedHours:50,difficultyLevel:"beginner",prerequisites:[]}},chemie:{id:"chemie",title:"Chemie",description:"Grundlagen der Chemie: Atome, Molek√ºle und Reaktionen",metadata:{estimatedHours:40,difficultyLevel:"intermediate",prerequisites:[]}},physik:{id:"physik",title:"Physik",description:"Einf√ºhrung in die Physik: Kr√§fte, Energie und Bewegung",metadata:{estimatedHours:45,difficultyLevel:"intermediate",prerequisites:[]}}}[l]||{id:l,title:l.charAt(0).toUpperCase()+l.slice(1),description:`Lernmaterialien f√ºr ${l}`,metadata:{estimatedHours:30,difficultyLevel:"beginner",prerequisites:[]}};return{id:s.id,title:s.title,description:s.description,learningPathIds:[],isActive:!0,metadata:s.metadata,createdAt:new Date("2024-01-01"),updatedAt:new Date("2024-01-01")}}async function Me(l){console.log("üóëÔ∏è Clearing existing database...");const e=await l.topics.count(),s=await l.learningPaths.count(),n=await l.tasks.count();console.log(`Before clear: ${e} topics, ${s} paths, ${n} tasks`),await l.topics.clear(),await l.learningPaths.clear(),await l.tasks.clear();const a=await l.tasks.count();console.log(`After clear: ${a} tasks remaining`),console.log("üìÇ Loading learning paths from JSON files...");const i=await gt();if(i.topics.length===0)throw new Error("No learning paths found in JSON files!");console.log(`Saving to database: ${i.topics.length} topics, ${i.learningPaths.length} learning paths, ${i.tasks.length} tasks`),console.log("Topics:",i.topics.map(g=>g.id)),console.log("Learning paths:",i.learningPaths.map(g=>`${g.id} (${g.taskIds?.length||0} taskIds)`)),console.log("Tasks:",i.tasks.map(g=>`${g.id} (learningPathId: ${g.learningPathId})`));try{await l.topics.bulkAdd(i.topics),console.log("‚úì Topics saved")}catch{console.log("‚ö†Ô∏è Topics exist, using bulkPut to update..."),await l.topics.bulkPut(i.topics),console.log("‚úì Topics updated")}try{await l.learningPaths.bulkAdd(i.learningPaths),console.log("‚úì Learning paths saved")}catch{console.log("‚ö†Ô∏è Learning paths exist, using bulkPut to update..."),await l.learningPaths.bulkPut(i.learningPaths),console.log("‚úì Learning paths updated")}try{await l.tasks.bulkAdd(i.tasks),console.log("‚úì Tasks saved")}catch(g){console.error("‚ùå Error saving tasks with bulkAdd:",g.message),console.log("‚ö†Ô∏è Some tasks already exist, using bulkPut to update...");try{await l.tasks.bulkPut(i.tasks),console.log("‚úì Tasks updated with bulkPut")}catch(b){console.error("‚ùå Error with bulkPut:",b.message)}}console.log(`‚úÖ Loaded from JSON: ${i.topics.length} topics, ${i.learningPaths.length} learning paths, ${i.tasks.length} tasks`);const o=await l.topics.count(),m=await l.learningPaths.count(),r=await l.tasks.count();console.log(`‚úÖ Verified in DB: ${o} topics, ${m} learning paths, ${r} tasks`)}class Ee extends Error{constructor(e,s,n){super(e),this.code=s,this.context=n,this.name="LearningPlatformError"}}class X extends Ee{constructor(e,s){super(e,"VALIDATION_ERROR",s),this.name="ValidationError"}}class ne extends Ee{constructor(e,s){super(`${e} with id ${s} not found`,"NOT_FOUND",{resource:e,id:s}),this.name="NotFoundError"}}class N{id;configuration;execution;results;createdAt;updatedAt;constructor(e){N.validate(e),this.id=e.id,this.configuration={...e.configuration,learningPathIds:[...e.configuration.learningPathIds]},this.execution={taskIds:[...e.execution.taskIds],completedCount:e.execution.completedCount,correctCount:e.execution.correctCount,status:e.execution.status,totalTimeSpent:e.execution.totalTimeSpent},e.execution.startedAt&&(this.execution.startedAt=new Date(e.execution.startedAt)),e.execution.completedAt&&(this.execution.completedAt=new Date(e.execution.completedAt)),this.results={...e.results,difficultyDistribution:{...e.results.difficultyDistribution},improvementAreas:[...e.results.improvementAreas]},this.createdAt=e.createdAt||new Date,this.updatedAt=e.updatedAt||new Date}static validate(e){if(e.configuration?.targetCount!==void 0&&(e.configuration.targetCount<5||e.configuration.targetCount>50))throw new X("Target count must be between 5 and 50",{field:"targetCount",value:e.configuration.targetCount});if(e.execution?.status!==void 0){const s=["planned","active","paused","completed","abandoned"];if(!s.includes(e.execution.status))throw new X("Invalid session status",{field:"status",value:e.execution.status,validValues:s})}}static create(e,s,n,a,i){const o={topicId:s,learningPathIds:n,targetCount:i.targetCount,includeReview:i.includeReview};return i.difficultyFilter&&(o.difficultyFilter=i.difficultyFilter),new N({id:e,configuration:o,execution:{taskIds:a,completedCount:0,correctCount:0,status:"planned",totalTimeSpent:0},results:{accuracy:0,averageTime:0,difficultyDistribution:{},improvementAreas:[]}})}start(){if(this.execution.status!=="planned"&&this.execution.status!=="paused")throw new Error("Can only start planned or paused sessions");this.execution.status="active",this.execution.startedAt||(this.execution.startedAt=new Date),this.updatedAt=new Date}pause(){if(this.execution.status!=="active")throw new Error("Can only pause active sessions");this.execution.status="paused",this.updatedAt=new Date}resume(){if(this.execution.status!=="paused")throw new Error("Can only resume paused sessions");this.execution.status="active",this.updatedAt=new Date}recordAnswer(e,s){if(this.execution.status!=="active")throw new Error("Session must be active to record answers");this.execution.completedCount++,e&&this.execution.correctCount++,this.execution.totalTimeSpent+=s,this.updateResults(),this.updatedAt=new Date}complete(){if(this.execution.status==="completed"||this.execution.status==="abandoned")throw new Error("Session already finalized");this.execution.status="completed",this.execution.completedAt=new Date,this.updateResults(),this.updatedAt=new Date}abandon(){if(this.execution.status==="completed"||this.execution.status==="abandoned")throw new Error("Session already finalized");this.execution.status="abandoned",this.updatedAt=new Date}updateResults(){this.execution.completedCount>0&&(this.results.accuracy=this.execution.correctCount/this.execution.completedCount*100),this.execution.completedCount>0&&(this.results.averageTime=this.execution.totalTimeSpent/this.execution.completedCount)}getProgress(){return this.execution.completedCount/this.configuration.targetCount*100}isComplete(){return this.execution.completedCount>=this.configuration.targetCount}getRemainingCount(){return Math.max(0,this.configuration.targetCount-this.execution.completedCount)}toJSON(){const e={id:this.id,configuration:{...this.configuration,learningPathIds:[...this.configuration.learningPathIds]},execution:{...this.execution,taskIds:[...this.execution.taskIds]},results:{...this.results,difficultyDistribution:{...this.results.difficultyDistribution},improvementAreas:[...this.results.improvementAreas]},createdAt:this.createdAt,updatedAt:this.updatedAt};return this.configuration.difficultyFilter&&(e.configuration.difficultyFilter=this.configuration.difficultyFilter),this.execution.startedAt&&(e.execution.startedAt=this.execution.startedAt),this.execution.completedAt&&(e.execution.completedAt=this.execution.completedAt),e}static fromJSON(e){return new N(e)}}class je{constructor(e,s,n){this.sessionRepository=e,this.taskRepository=s,this.spacedRepRepository=n}async createSession(e){const s=await this.selectTasksForSession(e),n=`session-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,a={targetCount:e.targetCount,includeReview:e.includeReview};e.difficultyFilter&&(a.difficultyFilter=e.difficultyFilter);const i=N.create(n,e.topicId,e.learningPathIds,s,a);return await this.sessionRepository.create(i.toJSON())}async getSession(e){return await this.sessionRepository.getById(e)}async updateSession(e,s){await this.sessionRepository.update(e,s)}async completeSession(e){const s=await this.sessionRepository.getById(e);if(!s)throw new ne("PracticeSession",e);const n=N.fromJSON(s);return n.complete(),await this.sessionRepository.update(e,n.toJSON())}async pauseSession(e){const s=await this.sessionRepository.getById(e);if(!s)throw new ne("PracticeSession",e);const n=N.fromJSON(s);n.pause(),await this.sessionRepository.update(e,n.toJSON())}async resumeSession(e){const s=await this.sessionRepository.getById(e);if(!s)throw new ne("PracticeSession",e);const n=N.fromJSON(s);n.resume(),await this.sessionRepository.update(e,n.toJSON())}async abandonSession(e){const s=await this.sessionRepository.getById(e);if(!s)throw new ne("PracticeSession",e);const n=N.fromJSON(s);n.abandon(),await this.sessionRepository.update(e,n.toJSON())}async getActiveSessions(e){return await this.sessionRepository.getActive(e)}async getRecentSessions(e,s){return await this.sessionRepository.getRecent(e,s)}async recordSessionAnswer(e,s,n){const a=await this.sessionRepository.getById(e);if(!a)throw new ne("PracticeSession",e);const i=N.fromJSON(a);i.execution.status==="planned"&&i.start(),i.recordAnswer(s,n),i.isComplete()&&i.complete(),await this.sessionRepository.update(e,i.toJSON())}async selectTasksForSession(e){const s=[];let n=e.targetCount;if(console.log(`Selecting tasks: targetCount=${e.targetCount}, learningPaths=${e.learningPathIds.join(",")}`),e.includeReview&&n>0){const a=await this.spacedRepRepository.getDue(new Date),i=a.slice(0,Math.min(a.length,Math.ceil(e.targetCount*.3))).map(o=>o.taskId);console.log(`Review tasks found: ${i.length}`),s.push(...i),n-=i.length}if(n>0){const a={learningPathIds:e.learningPathIds,excludeIds:s};e.difficultyFilter&&(a.difficulty=e.difficultyFilter),console.log(`Requesting ${n} new tasks with filters:`,a);const i=await this.taskRepository.getRandomTasks(n,a);console.log(`Got ${i.length} tasks:`,i.map(o=>o.id)),s.push(...i.map(o=>o.id))}return console.log(`Total selected tasks: ${s.length}`),s}}class ie{id;taskId;algorithm;schedule;performance;metadata;createdAt;updatedAt;constructor(e){ie.validate(e),this.id=e.id,this.taskId=e.taskId,this.algorithm={...e.algorithm},this.schedule={...e.schedule,nextReview:new Date(e.schedule.nextReview)},e.schedule.lastReviewed&&(this.schedule.lastReviewed=new Date(e.schedule.lastReviewed)),this.performance={...e.performance},this.metadata={...e.metadata,introduced:new Date(e.metadata.introduced)},this.createdAt=e.createdAt||new Date,this.updatedAt=e.updatedAt||new Date}static validate(e){if(e.algorithm?.efactor!==void 0&&(e.algorithm.efactor<1.3||e.algorithm.efactor>2.5))throw new X("Efactor must be between 1.3 and 2.5",{field:"efactor",value:e.algorithm.efactor});if(e.algorithm?.interval!==void 0&&(e.algorithm.interval<0||e.algorithm.interval>365))throw new X("Interval must be between 0 and 365 days",{field:"interval",value:e.algorithm.interval});if(e.performance?.lastGrade!==void 0&&(e.performance.lastGrade<0||e.performance.lastGrade>5))throw new X("Grade must be between 0 and 5",{field:"lastGrade",value:e.performance.lastGrade});if(e.performance?.averageAccuracy!==void 0&&(e.performance.averageAccuracy<0||e.performance.averageAccuracy>100))throw new X("Average accuracy must be between 0 and 100",{field:"averageAccuracy",value:e.performance.averageAccuracy})}static createNew(e,s){return new ie({id:s,taskId:e,algorithm:{interval:1,repetition:0,efactor:2.5},schedule:{nextReview:new Date(Date.now()+24*60*60*1e3),totalReviews:0,consecutiveCorrect:0},performance:{averageAccuracy:0,averageTime:0,difficultyRating:3,lastGrade:0},metadata:{introduced:new Date,graduated:!1,lapseCount:0}})}recordAnswer(e,s){if(e<0||e>5)throw new X("Grade must be between 0 and 5",{field:"grade",value:e});if(this.performance.lastGrade=e,this.updateAverageAccuracy(e>=3),this.updateAverageTime(s),this.schedule.totalReviews++,this.schedule.lastReviewed=new Date,e<3)this.algorithm.repetition=0,this.algorithm.interval=1,this.schedule.consecutiveCorrect=0,this.metadata.lapseCount++,this.metadata.graduated=!1;else{this.schedule.consecutiveCorrect++;const n=.1-(5-e)*(.08+(5-e)*.02);this.algorithm.efactor=Math.max(1.3,this.algorithm.efactor+n),this.algorithm.efactor=Math.min(2.5,this.algorithm.efactor),this.algorithm.repetition===0?this.algorithm.interval=1:this.algorithm.repetition===1?this.algorithm.interval=6:this.algorithm.interval=Math.round(this.algorithm.interval*this.algorithm.efactor),this.algorithm.interval=Math.min(365,this.algorithm.interval),this.algorithm.repetition++,this.algorithm.repetition>=2&&(this.metadata.graduated=!0)}this.schedule.nextReview=new Date(Date.now()+this.algorithm.interval*24*60*60*1e3),this.updatedAt=new Date}updateAverageAccuracy(e){const s=this.schedule.totalReviews,a=this.performance.averageAccuracy/100*(s-1)+(e?1:0);this.performance.averageAccuracy=a/s*100}updateAverageTime(e){const s=this.schedule.totalReviews,a=this.performance.averageTime*(s-1)+e;this.performance.averageTime=a/s}isDue(){return this.schedule.nextReview.getTime()<=Date.now()}daysUntilReview(){const e=this.schedule.nextReview.getTime()-Date.now();return Math.ceil(e/(24*60*60*1e3))}toJSON(){const e={id:this.id,taskId:this.taskId,algorithm:{...this.algorithm},schedule:{nextReview:this.schedule.nextReview,totalReviews:this.schedule.totalReviews,consecutiveCorrect:this.schedule.consecutiveCorrect},performance:{...this.performance},metadata:{introduced:this.metadata.introduced,graduated:this.metadata.graduated,lapseCount:this.metadata.lapseCount},createdAt:this.createdAt,updatedAt:this.updatedAt};return this.schedule.lastReviewed&&(e.schedule.lastReviewed=this.schedule.lastReviewed),e}static fromJSON(e){return new ie(e)}}class mt{constructor(e,s){this.spacedRepRepository=e,this.taskRepository=s}async getNextTasks(e,s){const i=(await this.spacedRepRepository.getDue(new Date)).sort((m,r)=>r.metadata.lapseCount!==m.metadata.lapseCount?r.metadata.lapseCount-m.metadata.lapseCount:m.schedule.nextReview.getTime()-r.schedule.nextReview.getTime()).slice(0,s),o=[];for(const m of i){const r=await this.taskRepository.getById(m.taskId);r&&o.push(r)}return o}async recordAnswer(e,s,n){if(n<0||n>5)throw new Error("Grade must be between 0 and 5");let a=await this.spacedRepRepository.getByTaskId(e);if(!a){const o=ie.createNew(e,`sr-${e}-${Date.now()}`);a=await this.spacedRepRepository.create(o.toJSON())}const i=ie.fromJSON(a);i.recordAnswer(n,0),await this.spacedRepRepository.update(a.id,i.toJSON())}async getRepetitionData(e){return await this.spacedRepRepository.getByTaskId(e)}async getTasksDue(e){const s=await this.spacedRepRepository.getDue(new Date),n=[];for(const a of s){const i=await this.taskRepository.getById(a.taskId);i&&n.push(i)}return n}async getReviewSchedule(e,s){const n=[],a=new Date;for(let i=0;i<s;i++){const o=new Date(a);o.setDate(o.getDate()+i),o.setHours(23,59,59,999);const m=await this.spacedRepRepository.getByNextReviewDate(o);let r=0;for(const g of m)r+=g.performance.averageTime||3e4;n.push({date:o,taskCount:m.length,estimatedTime:Math.round(r/1e3)})}return n}async rescheduleTask(e,s){const n=await this.spacedRepRepository.getByTaskId(e);if(!n)throw new ne("SpacedRepetitionItem",e);await this.spacedRepRepository.updateSchedule(n.id,{...n.schedule,nextReview:s})}async getStatistics(e){const s=await this.spacedRepRepository.getAll(),n=await this.spacedRepRepository.getDue(new Date),a=s.filter(m=>m.metadata.graduated).length,i=s.reduce((m,r)=>m+r.algorithm.interval,0),o=s.reduce((m,r)=>m+r.performance.averageAccuracy,0);return{totalItems:s.length,dueToday:n.length,graduated:a,averageInterval:s.length>0?i/s.length:0,averageAccuracy:s.length>0?o/s.length:0}}}class yt{constructor(e){this.table=e}async create(e){return await this.table.add(e),e}async getById(e){return await this.table.get(e)||null}async getAll(){return await this.table.toArray()}async update(e,s){return await this.table.update(e,s),await this.table.get(e)}async delete(e){await this.table.delete(e)}async getActive(){return await this.table.where("isActive").equals(1).toArray()}async search(e){const s=e.toLowerCase();return await this.table.filter(n=>n.title.toLowerCase().includes(s)).toArray()}async getByTitle(e){return null}async createMany(e){return[]}async updateMany(e){}async deleteMany(e){}async count(){return await this.table.count()}async exists(e){return!!await this.table.get(e)}}class xt{constructor(e){this.table=e}async create(e){return await this.table.add(e),e}async getById(e){return await this.table.get(e)||null}async getAll(){return await this.table.toArray()}async update(e,s){return await this.table.update(e,s),await this.table.get(e)}async delete(e){await this.table.delete(e)}async getByTopicId(e){return await this.table.where("topicId").equals(e).toArray()}async getByDifficulty(e){return await this.table.where("difficulty").equals(e).toArray()}async getActive(){return await this.table.where("isActive").equals(1).toArray()}async searchByTitle(e){return[]}async createMany(e){return[]}async updateMany(e){}async deleteMany(e){}async count(){return await this.table.count()}async exists(e){return!!await this.table.get(e)}}class bt{constructor(e){this.table=e}async create(e){return await this.table.add(e),e}async getById(e){return await this.table.get(e)||null}async getAll(){return await this.table.toArray()}async update(e,s){return await this.table.update(e,s),await this.table.get(e)}async delete(e){await this.table.delete(e)}async getByLearningPathId(e){return await this.table.where("learningPathId").equals(e).toArray()}async getRandomTasks(e,s){console.log(`[TaskRepository] getRandomTasks called: count=${e}, filters=`,s);let n;if(s?.learningPathIds?(n=await this.table.where("learningPathId").anyOf(s.learningPathIds).toArray(),console.log(`[TaskRepository] Found ${n.length} tasks for learning paths:`,s.learningPathIds),console.log("[TaskRepository] Task IDs:",n.map(o=>o.id))):(n=await this.table.toArray(),console.log(`[TaskRepository] Found ${n.length} tasks (no filter)`)),s?.excludeIds){const o=n.length;n=n.filter(m=>!s.excludeIds.includes(m.id)),console.log(`[TaskRepository] After excluding IDs: ${o} -> ${n.length} tasks`)}const a=n.sort(()=>Math.random()-.5),i=[];if(a.length===0)return console.log("[TaskRepository] No tasks available!"),i;for(let o=0;o<e;o++){const m=a[o%a.length];m&&i.push(m)}return console.log(`[TaskRepository] Returning ${i.length} tasks (${a.length} unique, repeated to reach ${e})`),i}async getByLearningPathIds(e){return[]}async getByType(e){return[]}async getByDifficulty(e){return[]}async getByTags(e){return[]}async search(e){return[]}async createMany(e){return[]}async updateMany(e){}async deleteMany(e){}async count(){return await this.table.count()}async exists(e){return!!await this.table.get(e)}}class wt{constructor(e){this.table=e}async create(e){return await this.table.add(e),e}async getById(e){return await this.table.get(e)||null}async getAll(){return await this.table.toArray()}async update(e,s){return await this.table.update(e,s),await this.table.get(e)}async delete(e){await this.table.delete(e)}async getByTaskId(e){return await this.table.where("taskId").equals(e).toArray()}async getBySessionId(e){return await this.table.where("sessionId").equals(e).toArray()}async getByUserId(e,s){return[]}async getByDateRange(e,s){return[]}async getCorrectAnswers(e){return await this.table.where("taskId").equals(e).filter(s=>s.isCorrect).toArray()}async getIncorrectAnswers(e){return await this.table.where("taskId").equals(e).filter(s=>!s.isCorrect).toArray()}async getAccuracyForPeriod(e,s,n){return 0}async createMany(e){return[]}async updateMany(e){}async deleteMany(e){}async count(){return await this.table.count()}async exists(e){return!!await this.table.get(e)}}class vt{constructor(e){this.table=e}async create(e){return await this.table.add(e),e}async getById(e){return await this.table.get(e)||null}async getAll(){return await this.table.toArray()}async update(e,s){return await this.table.update(e,s),await this.table.get(e)}async delete(e){await this.table.delete(e)}async getByTopicId(e){return(await this.table.where("topicId").equals(e).toArray())[0]||null}async getByLearningPathId(e){return(await this.table.where("learningPathId").equals(e).toArray())[0]||null}async getByUserId(e){return[]}async updateStatistics(e,s){}async incrementTaskCount(e,s){}async updateStreak(e,s){}async createMany(e){return[]}async updateMany(e){}async deleteMany(e){}async count(){return await this.table.count()}async exists(e){return!!await this.table.get(e)}}class St{constructor(e){this.table=e}async create(e){return await this.table.add(e),e}async getById(e){return await this.table.get(e)||null}async getAll(){return await this.table.toArray()}async update(e,s){return await this.table.update(e,s),await this.table.get(e)}async delete(e){await this.table.delete(e)}async getActive(e){return await this.table.where("execution.status").anyOf(["planned","active","paused"]).toArray()}async getRecent(e,s){return await this.table.orderBy("createdAt").reverse().limit(s).toArray()}async getByStatus(e){return await this.table.where("execution.status").equals(e).toArray()}async getByUserId(e){return[]}async getByDateRange(e,s){return[]}async updateStatus(e,s){}async incrementProgress(e,s,n){}async createMany(e){return[]}async updateMany(e){}async deleteMany(e){}async count(){return await this.table.count()}async exists(e){return!!await this.table.get(e)}}class kt{constructor(e){this.table=e}async create(e){return await this.table.add(e),e}async getById(e){return await this.table.get(e)||null}async getAll(){return await this.table.toArray()}async update(e,s){return await this.table.update(e,s),await this.table.get(e)}async delete(e){await this.table.delete(e)}async getByTaskId(e){return(await this.table.where("taskId").equals(e).toArray())[0]||null}async getDue(e){return await this.table.where("schedule.nextReview").belowOrEqual(e).toArray()}async getByNextReviewDate(e){return[]}async updateAlgorithmData(e,s){}async updateSchedule(e,s){}async updatePerformance(e,s){}async getReviewCalendar(e,s){return[]}async createMany(e){return[]}async updateMany(e){}async deleteMany(e){}async count(){return await this.table.count()}async exists(e){return!!await this.table.get(e)}}class Ie{static topicRepo;static learningPathRepo;static taskRepo;static answerHistoryRepo;static userProgressRepo;static practiceSessionRepo;static spacedRepetitionRepo;static getTopicRepository(){return this.topicRepo||(this.topicRepo=new yt(A.topics)),this.topicRepo}static getLearningPathRepository(){return this.learningPathRepo||(this.learningPathRepo=new xt(A.learningPaths)),this.learningPathRepo}static getTaskRepository(){return this.taskRepo||(this.taskRepo=new bt(A.tasks)),this.taskRepo}static getAnswerHistoryRepository(){return this.answerHistoryRepo||(this.answerHistoryRepo=new wt(A.answerHistory)),this.answerHistoryRepo}static getUserProgressRepository(){return this.userProgressRepo||(this.userProgressRepo=new vt(A.userProgress)),this.userProgressRepo}static getPracticeSessionRepository(){return this.practiceSessionRepo||(this.practiceSessionRepo=new St(A.practiceSessions)),this.practiceSessionRepo}static getSpacedRepetitionRepository(){return this.spacedRepetitionRepo||(this.spacedRepetitionRepo=new kt(A.spacedRepetition)),this.spacedRepetitionRepo}static reset(){this.topicRepo=null,this.learningPathRepo=null,this.taskRepo=null,this.answerHistoryRepo=null,this.userProgressRepo=null,this.practiceSessionRepo=null,this.spacedRepetitionRepo=null}}const fe=()=>Ie.getTaskRepository(),Re=()=>Ie.getPracticeSessionRepository(),ge=()=>Ie.getSpacedRepetitionRepository();class jt{manifest=null;audioCache=new Map;getBasePath=()=>window.location.pathname.startsWith("/learning-platform/")?"/learning-platform/":"/";get manifestPath(){return`${this.getBasePath()}audio/spanish/manifest.json`}get audioBasePath(){return`${this.getBasePath()}audio/spanish/`}isInitialized=!1;currentlyPlaying=null;async initialize(){if(!this.isInitialized)try{const e=await fetch(this.manifestPath);if(!e.ok)throw new Error(`Failed to load audio manifest: ${e.statusText}`);this.manifest=await e.json(),this.isInitialized=!0,console.log("‚úì Audio service initialized with",Object.keys(this.manifest||{}).length,"audio files")}catch(e){console.warn("‚ö†Ô∏è Failed to initialize audio service:",e),this.manifest={},this.isInitialized=!0}}async playSpanish(e){if(this.isInitialized||await this.initialize(),!this.manifest||!this.manifest[e])throw console.warn(`‚ö†Ô∏è No audio file found for: "${e}"`),new Error(`Audio not available for: ${e}`);const s=this.manifest[e],n=this.audioBasePath+s;this.currentlyPlaying&&(this.currentlyPlaying.pause(),this.currentlyPlaying.currentTime=0);let a=this.audioCache.get(n);return a||(a=new Audio(n),this.audioCache.set(n,a)),this.currentlyPlaying=a,new Promise((i,o)=>{if(!a){o(new Error("Audio element not found"));return}const m=()=>{g(),this.currentlyPlaying=null,i()},r=()=>{g(),this.currentlyPlaying=null,o(new Error(`Failed to play audio: ${n}`))},g=()=>{a.removeEventListener("ended",m),a.removeEventListener("error",r)};a.addEventListener("ended",m),a.addEventListener("error",r),a.currentTime=0,a.play().catch(b=>{g(),this.currentlyPlaying=null,o(b)})})}hasAudio(e){return this.isInitialized?!!(this.manifest&&this.manifest[e]):!1}stopPlayback(){this.currentlyPlaying&&(this.currentlyPlaying.pause(),this.currentlyPlaying.currentTime=0,this.currentlyPlaying=null)}clearCache(){this.audioCache.clear()}}const pe=new jt,$e=({size:l})=>t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",style:{width:l,height:l},children:t.jsx("path",{d:"M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"})}),Rt=({size:l})=>t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",style:{width:l,height:l},children:t.jsx("path",{d:"M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"})});function re({text:l,className:e="",disabled:s=!1,size:n="medium"}){const[a,i]=x.useState(!1),[o,m]=x.useState(null),r=pe.hasAudio(l),g=async()=>{if(!(a||s||!r)){i(!0),m(null);try{await pe.playSpanish(l)}catch(h){console.error("Failed to play audio:",h),m("Audio playback failed")}finally{i(!1)}}},b={small:"w-7 h-7",medium:"w-9 h-9",large:"w-11 h-11"},B={small:"16px",medium:"20px",large:"24px"},C=s||!r,z=`
    ${b[n]}
    inline-flex items-center justify-center
    rounded-lg
    transition-all duration-200
    shadow-sm hover:shadow-md
    ${C?"bg-gray-100 text-gray-400 cursor-not-allowed border border-gray-200":a?"bg-blue-600 text-white scale-95":"bg-gradient-to-br from-blue-500 to-blue-600 text-white hover:from-blue-600 hover:to-blue-700 active:scale-95 cursor-pointer"}
    ${e}
  `;return t.jsx("button",{onClick:g,disabled:C,className:z,title:r?a?"Spielt ab...":`Aussprache abspielen: ${l}`:"Audio nicht verf√ºgbar","aria-label":`Spanische Aussprache f√ºr ${l} abspielen`,type:"button",children:a?t.jsx("div",{style:{animation:"pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite"},children:t.jsx($e,{size:B[n]})}):!r||o?t.jsx(Rt,{size:B[n]}):t.jsx($e,{size:B[n]})})}const D={primary:{500:"#3b82f6"},success:{100:"#dcfce7",300:"#86efac",500:"#10b981"},error:{100:"#fee2e2",300:"#fca5a5",500:"#ef4444"},warning:{100:"#fef3c7",400:"#fbbf24",500:"#f59e0b"},info:{100:"#f3e8ff",300:"#d8b4fe",500:"#8b5cf6"},neutral:{0:"#ffffff",200:"#e5e7eb",500:"#6b7280",600:"#4b5563",900:"#111827"}},T={text:{primary:D.neutral[900],secondary:D.neutral[600],tertiary:D.neutral[500]},background:{primary:D.neutral[0]},border:{light:D.neutral[200]},feedback:{success:D.success[500],successLight:D.success[100],successBorder:D.success[300],error:D.error[500],errorLight:D.error[100],errorBorder:D.error[300],warning:D.warning[500],warningLight:D.warning[100],warningBorder:D.warning[400],info:D.info[500],infoLight:D.info[100],infoBorder:D.info[300]}},U={.5:"0.125rem",1:"0.25rem",2:"0.5rem",3:"0.75rem",4:"1rem",6:"1.5rem",8:"2rem"},P={fontSize:{sm:"0.875rem",base:"1rem",lg:"1.125rem",xl:"1.25rem","3xl":"1.875rem"},fontWeight:{medium:"500",semibold:"600",bold:"700"},lineHeight:{none:"1",tight:"1.25",relaxed:"1.625"},letterSpacing:{wide:"0.025em"}},At={sm:"0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.1)"},Fe={sm:"0.25rem",lg:"0.75rem"},Ct={presets:{fast:"all 150ms cubic-bezier(0.4, 0, 0.2, 1)"}},de={card:{padding:{sm:U[4],md:U[6],lg:U[8]},borderRadius:Fe.lg,shadow:At.sm}};function ue({padding:l="medium",shadow:e=!0,border:s=!0,borderColor:n,backgroundColor:a,children:i,className:o="",style:m={},...r}){const g=It(l),b={backgroundColor:a||T.background.primary,borderRadius:de.card.borderRadius,border:s?`1px solid ${n||T.border.light}`:"none",boxShadow:e?de.card.shadow:"none",padding:g,transition:Ct.presets.fast,...m};return t.jsx("div",{...r,style:b,className:o,children:i})}function It(l){switch(l){case"small":return de.card.padding.sm;case"medium":return de.card.padding.md;case"large":return de.card.padding.lg}}function Tt({variant:l,title:e,message:s,dismissible:n=!1,onDismiss:a,children:i,className:o="",style:m={},...r}){const g=ce.useMemo(()=>zt(l),[l]),b=ce.useMemo(()=>Dt(l),[l]),B=ce.useMemo(()=>({backgroundColor:g.background,borderColor:g.border,position:"relative",...m}),[g.background,g.border,m]);return t.jsx(ue,{...r,padding:"medium",shadow:!1,border:!0,borderColor:g.border,backgroundColor:g.background,style:B,className:o,role:l==="error"||l==="warning"?"alert":"status","aria-live":l==="error"||l==="warning"?"assertive":"polite","aria-atomic":"true",children:t.jsxs("div",{style:{display:"flex",gap:U[3],alignItems:"flex-start"},children:[t.jsx("div",{style:{fontSize:P.fontSize.xl,lineHeight:P.lineHeight.none,flexShrink:0,marginTop:U[.5]},"aria-hidden":"true",children:b}),t.jsxs("div",{style:{flex:1},children:[e&&t.jsx("h4",{style:{margin:0,marginBottom:U[1],fontSize:P.fontSize.base,fontWeight:P.fontWeight.semibold,color:g.text},children:e}),i?t.jsx("div",{style:{fontSize:P.fontSize.sm,color:g.text,lineHeight:P.lineHeight.relaxed},children:i}):s&&t.jsx("p",{style:{margin:0,fontSize:P.fontSize.sm,color:g.text,lineHeight:P.lineHeight.relaxed},children:s})]}),n&&a&&t.jsx("button",{onClick:a,style:{background:"none",border:"none",padding:U[1],cursor:"pointer",fontSize:P.fontSize.lg,lineHeight:P.lineHeight.none,color:g.text,opacity:.6,transition:"opacity 150ms",borderRadius:Fe.sm},onMouseEnter:C=>{C.currentTarget.style.opacity="1"},onMouseLeave:C=>{C.currentTarget.style.opacity="0.6"},"aria-label":`Dismiss ${l} message`,children:t.jsx("span",{"aria-hidden":"true",children:"‚úï"})})]})})}function zt(l){switch(l){case"success":return{background:T.feedback.successLight,border:T.feedback.successBorder,text:T.feedback.success};case"error":return{background:T.feedback.errorLight,border:T.feedback.errorBorder,text:T.feedback.error};case"warning":return{background:T.feedback.warningLight,border:T.feedback.warningBorder,text:T.feedback.warning};case"info":return{background:T.feedback.infoLight,border:T.feedback.infoBorder,text:T.feedback.info};default:return{background:T.feedback.infoLight,border:T.feedback.infoBorder,text:T.feedback.info}}}function Dt(l){switch(l){case"success":return"‚úì";case"error":return"‚úó";case"warning":return"‚ö†";case"info":return"‚Ñπ";default:return"‚Ñπ"}}function Pt({topicId:l,learningPathIds:e,targetCount:s=10,includeReview:n=!0,onComplete:a,onCancel:i}){const[o,m]=x.useState(null),[r,g]=x.useState(null),[b,B]=x.useState(0),[C,z]=x.useState(null),[h,W]=x.useState(!1),[L,ee]=x.useState(!1),[G,Y]=x.useState(Date.now()),[E,te]=x.useState([]),[J,ae]=x.useState(0),[M,K]=x.useState([]),[w,j]=x.useState(null),[$,Q]=x.useState([]),[H,oe]=x.useState({}),[ye,p]=x.useState([]),[k,V]=x.useState(new Set),[_,q]=x.useState(0),[O,xe]=x.useState(""),[Te,ze]=x.useState(!1),[be,we]=x.useState(null),[le,De]=x.useState(""),[Oe,Ne]=x.useState(!1);x.useEffect(()=>{He(),pe.initialize().then(()=>{Ne(!0)})},[]),x.useEffect(()=>{o&&o.execution.taskIds.length>0&&b===0&&Pe()},[o]),x.useEffect(()=>{o&&o.execution.taskIds.length>0&&b>0&&Pe()},[b]);async function He(){const d=await new je(Re(),fe(),ge()).createSession({topicId:l,learningPathIds:e,targetCount:s,includeReview:n});m(d)}async function Pe(){if(!o||b>=o.execution.taskIds.length)return;const c=o.execution.taskIds[b];if(!c)return;const d=await A.tasks.get(c);if(d)if(g(d),Y(Date.now()),z(null),j(null),K([]),Q([]),oe({}),p([]),V(new Set),q(0),xe(""),ze(!1),we(null),De(""),d.type==="multiple-choice"){const u=d.content,f=[...u.options],v=u.correctAnswer,S=f.map((R,F)=>F);for(let R=S.length-1;R>0;R--){const F=Math.floor(Math.random()*(R+1));[S[R],S[F]]=[S[F],S[R]]}const y=S.map(R=>f[R]),I=S.findIndex(R=>R===v);te(y),ae(I)}else if(d.type==="cloze-deletion"){const u=d.content;K(new Array(u.blanks.length).fill(""))}else if(d.type==="ordering"){const f=[...d.content.items].sort(()=>Math.random()-.5);Q(f)}else if(d.type==="matching"){const f=d.content.pairs.map((v,S)=>S);for(let v=f.length-1;v>0;v--){const S=Math.floor(Math.random()*(v+1));[f[v],f[S]]=[f[S],f[v]]}p(f),oe({})}else if(d.type==="multiple-select")V(new Set);else if(d.type==="slider"){const u=d.content;q(Math.floor((u.min+u.max)/2))}else d.type==="word-scramble"&&xe("")}async function ve(){if(!r||!o)return;let c=!1;if(r.type==="multiple-choice"){if(C===null)return;c=C===J}else if(r.type==="cloze-deletion")c=r.content.blanks.every((I,R)=>{const F=M[R]?.trim().toLowerCase()||"",ke=I.correctAnswer.toLowerCase(),he=I.alternatives?.map(nt=>nt.toLowerCase())||[];return F===ke||he.includes(F)});else if(r.type==="true-false"){if(w===null)return;const y=r.content;c=w===y.correctAnswer}else if(r.type==="ordering"){const y=r.content;c=$.every((I,R)=>{const F=y.items.indexOf(I);return y.correctOrder[R]===F})}else if(r.type==="matching")c=r.content.pairs.every((I,R)=>H[R]===R);else if(r.type==="multiple-select"){const y=r.content;if(k.size===0)return;c=y.correctAnswers.length===k.size&&y.correctAnswers.every(I=>k.has(I))}else if(r.type==="slider"){const y=r.content,I=y.tolerance||0;c=Math.abs(_-y.correctValue)<=I}else if(r.type==="word-scramble"){if(!O.trim())return;const y=r.content;c=O.trim().toLowerCase()===y.correctWord.toLowerCase()}else if(r.type==="flashcard"){if(be===null)return;c=be}else if(r.type==="text-input"){if(!le.trim())return;const y=r.content,I=y.caseSensitive||!1,R=I?le.trim():le.trim().toLowerCase(),F=I?y.correctAnswer:y.correctAnswer.toLowerCase(),ke=(y.alternatives||[]).map(he=>I?he:he.toLowerCase());c=R===F||ke.includes(R)}ee(c),W(!0);const d=Math.round((Date.now()-G)/1e3);await new je(Re(),fe(),ge()).recordSessionAnswer(o.id,c,d);const f=new mt(ge(),fe()),v=c?4:2;await f.recordAnswer(r.id,c,v);const S=await A.practiceSessions.get(o.id);S&&m(S)}function qe(){o&&(W(!1),z(null),b<o.execution.taskIds.length-1&&B(b+1))}function Ge(){W(!1),z(null),o&&b<o.execution.taskIds.length-1?B(b+1):Be()}async function Be(){if(!o)return;await new je(Re(),fe(),ge()).completeSession(o.id),await new Promise(d=>setTimeout(d,100)),a()}function se(c){return!c||!Oe?!1:pe.hasAudio(c)}function Se(){if(h)return!1;if(r?.type==="multiple-choice")return C!==null;if(r?.type==="cloze-deletion")return M.every(c=>c.trim().length>0);if(r?.type==="true-false")return w!==null;if(r?.type==="ordering")return $.length>0;if(r?.type==="matching"){const c=r.content;return Object.keys(H).length===c.pairs.length}return r?.type==="multiple-select"?k.size>0:r?.type==="slider"?!0:r?.type==="word-scramble"?O.trim().length>0:r?.type==="flashcard"?be!==null:r?.type==="text-input"?le.trim().length>0:!1}function Je(){return r?r.type==="multiple-choice"?Ve():r.type==="cloze-deletion"?Ue():r.type==="true-false"?Ze():r.type==="ordering"?Ye():r.type==="matching"?Ke():r.type==="multiple-select"?Qe():r.type==="slider"?Xe():r.type==="word-scramble"?et():r.type==="flashcard"?tt():r.type==="text-input"?st():null:null}function Ve(){return!r||r.type!=="multiple-choice"?null:t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem",flex:1,minHeight:0},children:E.map((c,d)=>{let u="#ffffff",f="#d1d5db";h?d===J?(u="#dcfce7",f="#86efac"):d===C&&!L&&(u="#fee2e2",f="#fca5a5"):C===d&&(u="#dbeafe",f="#3b82f6");const v=se(c),y=h&&d===J&&v;return t.jsxs("button",{onClick:()=>!h&&z(d),disabled:h,style:{padding:"0.875rem",background:u,border:`2px solid ${f}`,borderRadius:"6px",cursor:h?"default":"pointer",textAlign:"left",fontSize:"0.95rem",transition:"all 0.2s",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"0.5rem",opacity:1},children:[t.jsx("span",{children:c}),y&&t.jsx(re,{text:c,size:"small"})]},d)})})}function Ue(){if(!r||r.type!=="cloze-deletion")return null;const c=r.content,d=c.text.split(/\{\{blank\}\}/g);return t.jsxs("div",{style:{flex:1,minHeight:0},children:[t.jsx("div",{style:{fontSize:"1rem",lineHeight:"1.8"},children:d.map((u,f)=>t.jsxs("span",{children:[u,f<c.blanks.length&&t.jsx("input",{type:"text",value:M[f]||"",onChange:v=>{const S=[...M];S[f]=v.target.value,K(S)},disabled:h,style:{padding:"0.25rem 0.5rem",border:h?M[f]?.trim().toLowerCase()===c.blanks[f].correctAnswer.toLowerCase()||c.blanks[f].alternatives?.map(v=>v.toLowerCase()).includes(M[f]?.trim().toLowerCase()||"")?"2px solid #86efac":M[f]?.trim()?"2px solid #fca5a5":"2px solid #d1d5db":"2px solid #d1d5db",borderRadius:"4px",fontSize:"0.95rem",minWidth:"100px",backgroundColor:h?M[f]?.trim().toLowerCase()===c.blanks[f].correctAnswer.toLowerCase()||c.blanks[f].alternatives?.map(v=>v.toLowerCase()).includes(M[f]?.trim().toLowerCase()||"")?"#dcfce7":M[f]?.trim()?"#fee2e2":"#ffffff":"#ffffff"}})]},f))}),h&&t.jsxs("div",{style:{marginTop:"1rem",padding:"1rem",background:"#f9fafb",borderRadius:"6px"},children:[t.jsx("div",{style:{fontSize:"0.875rem",fontWeight:"500",marginBottom:"0.5rem",color:"#374151"},children:"Richtige Antworten:"}),c.blanks.map((u,f)=>{const v=M[f]?.trim().toLowerCase()||"",S=v===u.correctAnswer.toLowerCase()||u.alternatives?.map(y=>y.toLowerCase()).includes(v);return t.jsxs("div",{style:{fontSize:"0.875rem",marginTop:"0.25rem",color:S?"#10b981":"#374151"},children:["L√ºcke ",f+1,": ",t.jsx("strong",{style:{color:"#10b981"},children:u.correctAnswer}),u.alternatives&&u.alternatives.length>0&&t.jsxs("span",{style:{color:"#6b7280",fontSize:"0.8rem"},children:[" ","(auch richtig: ",u.alternatives.join(", "),")"]})]},f)})]})]})}function Ze(){if(!r||r.type!=="true-false")return null;const c=r.content;return t.jsxs("div",{style:{flex:1,minHeight:0,display:"flex",flexDirection:"column",gap:"1rem"},children:[t.jsx("div",{style:{fontSize:"1rem",lineHeight:"1.6",flex:1},children:c.statement}),t.jsx("div",{style:{display:"flex",gap:"1rem"},children:[!0,!1].map(d=>{let u="#ffffff",f="#d1d5db";return h?d===c.correctAnswer?(u="#dcfce7",f="#86efac"):d===w&&!L&&(u="#fee2e2",f="#fca5a5"):w===d&&(u="#dbeafe",f="#3b82f6"),t.jsx("button",{onClick:()=>!h&&j(d),disabled:h,style:{flex:1,padding:"1rem",background:u,border:`2px solid ${f}`,borderRadius:"6px",cursor:h?"default":"pointer",fontSize:"1rem",fontWeight:"500",transition:"all 0.2s"},children:d?"Richtig":"Falsch"},d.toString())})})]})}function Ye(){if(!r||r.type!=="ordering")return null;const c=r.content;return t.jsxs("div",{style:{flex:1,minHeight:0},children:[t.jsx("div",{style:{marginBottom:"0.5rem",fontSize:"0.875rem",color:"#6b7280"},children:"Ordne die Elemente in die richtige Reihenfolge"}),t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:$.map((d,u)=>{const f=c.items.indexOf(d),v=h&&c.correctOrder[u]===f,S=h?c.correctOrder.indexOf(f):-1;return t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.75rem",background:h&&v?"#dcfce7":"#ffffff",border:h&&v?"2px solid #86efac":"2px solid #d1d5db",borderRadius:"6px"},children:[t.jsxs("div",{style:{fontWeight:"500",color:"#6b7280",minWidth:"24px"},children:[u+1,"."]}),t.jsxs("div",{style:{flex:1},children:[d,h&&!v&&t.jsxs("span",{style:{fontSize:"0.8rem",color:"#ef4444",marginLeft:"0.5rem"},children:["‚Üí Position ",S+1]})]}),!h&&t.jsxs("div",{style:{display:"flex",gap:"0.25rem"},children:[u>0&&t.jsx("button",{onClick:()=>{const y=[...$];[y[u],y[u-1]]=[y[u-1],y[u]],Q(y)},style:{padding:"0.25rem 0.5rem",background:"#f3f4f6",border:"none",borderRadius:"4px",cursor:"pointer"},children:"‚Üë"}),u<$.length-1&&t.jsx("button",{onClick:()=>{const y=[...$];[y[u],y[u+1]]=[y[u+1],y[u]],Q(y)},style:{padding:"0.25rem 0.5rem",background:"#f3f4f6",border:"none",borderRadius:"4px",cursor:"pointer"},children:"‚Üì"})]})]},u)})}),h&&!L&&t.jsxs("div",{style:{marginTop:"1rem",padding:"1rem",background:"#f9fafb",borderRadius:"6px"},children:[t.jsx("div",{style:{fontSize:"0.875rem",fontWeight:"500",marginBottom:"0.5rem",color:"#374151"},children:"Richtige Reihenfolge:"}),c.correctOrder.map((d,u)=>t.jsxs("div",{style:{fontSize:"0.875rem",marginTop:"0.25rem",color:"#10b981"},children:[u+1,". ",t.jsx("strong",{children:c.items[d]})]},u))]})]})}function Ke(){if(!r||r.type!=="matching")return null;const c=r.content;return t.jsxs("div",{style:{flex:1,minHeight:0},children:[t.jsx("div",{style:{marginBottom:"0.5rem",fontSize:"0.875rem",color:"#6b7280"},children:"Ordne die passenden Paare zu"}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.75rem"},children:c.pairs.map((d,u)=>{const f=h&&H[u]===u,v=H[u]!==void 0&&H[u]!==null;return t.jsxs(ce.Fragment,{children:[t.jsxs("div",{style:{padding:"0.75rem",background:"#f9fafb",border:"2px solid #d1d5db",borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"0.5rem"},children:[t.jsx("span",{children:d.left}),se(d.left)&&t.jsx(re,{text:d.left,size:"small"})]}),t.jsxs("select",{value:H[u]??"",onChange:S=>{const y=parseInt(S.target.value);oe({...H,[u]:y})},disabled:h,style:{padding:"0.75rem",border:h?f?"2px solid #86efac":v?"2px solid #fca5a5":"2px solid #d1d5db":"2px solid #d1d5db",borderRadius:"6px",backgroundColor:h?f?"#dcfce7":v?"#fee2e2":"#ffffff":"#ffffff"},children:[t.jsx("option",{value:"",children:"W√§hle..."}),ye.map(S=>t.jsx("option",{value:S,children:c.pairs[S].right},S))]})]},u)})}),h&&!L&&t.jsxs("div",{style:{marginTop:"1rem",padding:"1rem",background:"#f9fafb",borderRadius:"6px"},children:[t.jsx("div",{style:{fontSize:"0.875rem",fontWeight:"500",marginBottom:"0.5rem",color:"#374151"},children:"Richtige Zuordnungen:"}),c.pairs.map((d,u)=>t.jsxs("div",{style:{fontSize:"0.875rem",marginTop:"0.25rem",color:"#10b981"},children:[t.jsx("strong",{children:d.left})," ‚Üí ",t.jsx("strong",{children:d.right})]},u))]})]})}function Qe(){if(!r||r.type!=="multiple-select")return null;const c=r.content,d=u=>{if(h)return;const f=new Set(k);f.has(u)?f.delete(u):f.add(u),V(f)};return t.jsxs("div",{style:{flex:1,minHeight:0},children:[t.jsx("div",{style:{marginBottom:"0.75rem",fontSize:"0.875rem",color:"#6b7280"},children:"W√§hle alle zutreffenden Antworten"}),t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:c.options.map((u,f)=>{const v=k.has(f),S=c.correctAnswers.includes(f);let y="#ffffff",I="#d1d5db",R="";return h?S?(y="#dcfce7",I="#86efac",R=v?"‚úì":"‚óã"):v&&!S&&(y="#fee2e2",I="#fca5a5",R="‚úó"):v&&(y="#dbeafe",I="#3b82f6"),t.jsxs("label",{style:{display:"flex",alignItems:"center",padding:"0.875rem",background:y,border:`2px solid ${I}`,borderRadius:"6px",cursor:h?"default":"pointer",transition:"all 0.2s",position:"relative"},children:[t.jsx("input",{type:"checkbox",checked:v,onChange:()=>d(f),disabled:h,style:{marginRight:"0.75rem",width:"1.25rem",height:"1.25rem",cursor:h?"default":"pointer"}}),t.jsx("span",{style:{fontSize:"0.95rem",flex:1},children:u}),h&&R&&t.jsx("span",{style:{fontSize:"1.25rem",fontWeight:"bold",marginLeft:"0.5rem",color:S?"#10b981":"#ef4444"},children:R})]},f)})})]})}function Xe(){if(!r||r.type!=="slider")return null;const c=r.content,d=c.step||1,u=c.tolerance||0;return t.jsxs("div",{style:{flex:1,minHeight:0,display:"flex",flexDirection:"column",gap:"1.5rem"},children:[t.jsx("div",{style:{textAlign:"center"},children:t.jsxs("div",{style:{fontSize:"2.5rem",fontWeight:"bold",color:h?Math.abs(_-c.correctValue)<=u?"#10b981":"#ef4444":"#3b82f6"},children:[_,c.unit||""]})}),t.jsxs("div",{style:{padding:"0 1rem"},children:[t.jsx("input",{type:"range",min:c.min,max:c.max,step:d,value:_,onChange:f=>q(Number(f.target.value)),disabled:h,style:{width:"100%",height:"8px",borderRadius:"4px",outline:"none",cursor:h?"default":"pointer"}}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"0.5rem",fontSize:"0.875rem",color:"#6b7280"},children:[t.jsxs("span",{children:[c.min,c.unit||""]}),t.jsxs("span",{children:[c.max,c.unit||""]})]})]}),h&&t.jsx("div",{style:{padding:"1rem",background:"#f9fafb",borderRadius:"6px",textAlign:"center"},children:t.jsxs("div",{style:{fontSize:"0.875rem",fontWeight:"500",color:"#374151"},children:["Richtige Antwort: ",t.jsxs("strong",{style:{color:"#10b981",fontSize:"1.1rem"},children:[c.correctValue,c.unit||""]}),u>0&&t.jsxs("span",{style:{fontSize:"0.8rem",color:"#6b7280"},children:[" ","(¬±",u,")"]})]})})]})}function et(){if(!r||r.type!=="word-scramble")return null;const c=r.content;return t.jsxs("div",{style:{flex:1,minHeight:0,display:"flex",flexDirection:"column",gap:"1.5rem"},children:[t.jsxs("div",{style:{padding:"1.5rem",background:"#f9fafb",borderRadius:"8px",textAlign:"center"},children:[t.jsx("div",{style:{fontSize:"0.875rem",color:"#6b7280",marginBottom:"0.5rem"},children:"Buchstabensalat:"}),t.jsx("div",{style:{fontSize:"2rem",fontWeight:"bold",letterSpacing:"0.5rem",color:"#3b82f6",fontFamily:"monospace"},children:c.scrambledWord}),c.showLength&&t.jsxs("div",{style:{fontSize:"0.875rem",color:"#6b7280",marginTop:"0.5rem"},children:["(",c.correctWord.length," Buchstaben)"]})]}),t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",marginBottom:"0.5rem",color:"#374151"},children:"Deine L√∂sung:"}),t.jsx("input",{type:"text",value:O,onChange:d=>xe(d.target.value),disabled:h,placeholder:"Entschl√ºssle das Wort...",style:{width:"100%",padding:"0.875rem",fontSize:"1.1rem",border:h?O.trim().toLowerCase()===c.correctWord.toLowerCase()?"2px solid #86efac":O.trim()?"2px solid #fca5a5":"2px solid #d1d5db":"2px solid #d1d5db",borderRadius:"6px",backgroundColor:h?O.trim().toLowerCase()===c.correctWord.toLowerCase()?"#dcfce7":O.trim()?"#fee2e2":"#ffffff":"#ffffff",textAlign:"center",fontWeight:"500"}})]}),h&&!L&&t.jsxs("div",{style:{padding:"1rem",background:"#f9fafb",borderRadius:"6px",textAlign:"center"},children:[t.jsx("div",{style:{fontSize:"0.875rem",fontWeight:"500",marginBottom:"0.5rem",color:"#374151"},children:"Richtige L√∂sung:"}),t.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#10b981"},children:c.correctWord})]})]})}function tt(){if(!r||r.type!=="flashcard")return null;const c=r.content;return t.jsxs("div",{style:{flex:1,minHeight:0,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:"2rem",padding:"2rem"},children:[t.jsxs("div",{style:{width:"100%",maxWidth:"500px",minHeight:"300px",background:"white",border:"3px solid #e5e7eb",borderRadius:"16px",padding:"3rem",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:"1.5rem",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",transition:"all 0.3s ease"},children:[t.jsx("div",{style:{fontSize:"0.75rem",fontWeight:"600",color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.05em"},children:c.frontLanguage==="de"?"Deutsch":c.frontLanguage==="es"?"Espa√±ol":"English"}),t.jsxs("div",{style:{fontSize:"2.5rem",fontWeight:"bold",color:"#1f2937",textAlign:"center",minHeight:"80px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"1rem"},children:[t.jsx("div",{children:c.front}),se(c.front)&&t.jsx(re,{text:c.front,size:"large"})]}),Te?t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{width:"100%",height:"2px",background:"#e5e7eb",margin:"0.5rem 0"}}),t.jsx("div",{style:{fontSize:"0.75rem",fontWeight:"600",color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.05em"},children:c.backLanguage==="de"?"Deutsch":c.backLanguage==="es"?"Espa√±ol":"English"}),t.jsxs("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"#10b981",textAlign:"center",minHeight:"60px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"1rem"},children:[t.jsx("div",{children:c.back}),se(c.back)&&t.jsx(re,{text:c.back,size:"large"})]})]}):t.jsx("button",{onClick:()=>ze(!0),disabled:h,style:{padding:"1rem 2.5rem",background:"#3b82f6",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"1.125rem",fontWeight:"500",transition:"all 0.2s",boxShadow:"0 2px 4px rgba(59, 130, 246, 0.3)"},onMouseEnter:d=>{d.currentTarget.style.background="#2563eb",d.currentTarget.style.transform="translateY(-1px)"},onMouseLeave:d=>{d.currentTarget.style.background="#3b82f6",d.currentTarget.style.transform="translateY(0)"},children:"Ergebnis anzeigen"})]}),Te&&!h&&t.jsxs("div",{style:{display:"flex",gap:"1.5rem",justifyContent:"center",width:"100%",maxWidth:"500px"},children:[t.jsxs("button",{onClick:()=>{we(!1),ve()},style:{flex:1,padding:"1.25rem",background:"#fee2e2",color:"#dc2626",border:"2px solid #fca5a5",borderRadius:"12px",cursor:"pointer",fontSize:"1.125rem",fontWeight:"600",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.75rem",transition:"all 0.2s"},onMouseEnter:d=>{d.currentTarget.style.background="#fecaca",d.currentTarget.style.transform="scale(1.02)"},onMouseLeave:d=>{d.currentTarget.style.background="#fee2e2",d.currentTarget.style.transform="scale(1)"},children:[t.jsx("span",{style:{fontSize:"1.75rem"},children:"‚úó"}),t.jsx("span",{children:"Nicht gewusst"})]}),t.jsxs("button",{onClick:()=>{we(!0),ve()},style:{flex:1,padding:"1.25rem",background:"#dcfce7",color:"#16a34a",border:"2px solid #86efac",borderRadius:"12px",cursor:"pointer",fontSize:"1.125rem",fontWeight:"600",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.75rem",transition:"all 0.2s"},onMouseEnter:d=>{d.currentTarget.style.background="#bbf7d0",d.currentTarget.style.transform="scale(1.02)"},onMouseLeave:d=>{d.currentTarget.style.background="#dcfce7",d.currentTarget.style.transform="scale(1)"},children:[t.jsx("span",{style:{fontSize:"1.75rem"},children:"‚úì"}),t.jsx("span",{children:"Gewusst"})]})]}),h&&c.explanation&&t.jsxs("div",{style:{width:"100%",maxWidth:"500px",padding:"1rem",background:"#f3f4f6",borderRadius:"8px",fontSize:"0.95rem",color:"#4b5563",lineHeight:"1.6"},children:[t.jsx("strong",{children:"Hinweis:"})," ",c.explanation]})]})}function st(){if(!r||r.type!=="text-input")return null;const c=r.content;return t.jsxs("div",{style:{flex:1,minHeight:0,display:"flex",flexDirection:"column",gap:"1.5rem"},children:[t.jsxs("div",{style:{padding:"2rem",background:"#ffffff",borderRadius:"12px",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"},children:[t.jsx("input",{type:"text",value:le,onChange:d=>De(d.target.value),disabled:h,placeholder:"Deine Antwort...",style:{width:"100%",padding:"1rem",fontSize:"1.125rem",border:h?L?"2px solid #86efac":"2px solid #fca5a5":"2px solid #d1d5db",borderRadius:"8px",background:h?L?"#dcfce7":"#fee2e2":"#ffffff",outline:"none",transition:"all 0.2s"},onFocus:d=>{h||(d.currentTarget.style.borderColor="#3b82f6")},onBlur:d=>{h||(d.currentTarget.style.borderColor="#d1d5db")}}),h&&!L&&t.jsxs("div",{style:{marginTop:"1rem",padding:"0.75rem",background:"#f3f4f6",borderRadius:"6px",fontSize:"0.95rem",color:"#4b5563",display:"flex",alignItems:"center",gap:"0.5rem"},children:[t.jsxs("div",{children:[t.jsx("strong",{children:"Richtige Antwort:"})," ",c.correctAnswer]}),se(c.correctAnswer)&&t.jsx(re,{text:c.correctAnswer,size:"small"})]})]}),c.hint&&!h&&t.jsxs("div",{style:{padding:"0.75rem 1rem",background:"#fef3c7",border:"1px solid #fbbf24",borderRadius:"6px",fontSize:"0.9rem",color:"#92400e"},children:["üí° ",t.jsx("strong",{children:"Tipp:"})," ",c.hint]})]})}if(!o||!r)return t.jsx("div",{style:{padding:"2rem",textAlign:"center"},children:t.jsx("p",{children:"Wird geladen..."})});const rt=(b+1)/o.execution.taskIds.length*100;return t.jsxs("div",{style:{minHeight:"100vh",display:"flex",flexDirection:"column",padding:"1rem",maxWidth:"900px",margin:"0 auto"},children:[t.jsxs("div",{style:{marginBottom:"1rem",flexShrink:0},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[t.jsx("h2",{style:{margin:0,fontSize:"1.25rem"},children:"√úbungssitzung"}),t.jsxs("span",{style:{fontSize:"0.875rem",color:"#6b7280"},children:[b+1,"/",o.execution.taskIds.length]}),t.jsxs("span",{style:{fontSize:"0.75rem",color:"#9ca3af",fontFamily:"monospace"},children:["ID: ",r.id]})]}),t.jsx("button",{onClick:i,style:{padding:"0.5rem 1rem",background:"#e5e7eb",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"0.875rem"},children:"Abbrechen"})]}),t.jsx("div",{style:{width:"100%",height:"6px",background:"#e5e7eb",borderRadius:"3px",overflow:"hidden"},children:t.jsx("div",{style:{width:`${rt}%`,height:"100%",background:"#3b82f6",transition:"width 0.3s ease"}})})]}),t.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",background:"#f9fafb",padding:"1.5rem",borderRadius:"8px",marginBottom:"1rem",minHeight:0},children:[(r.type==="multiple-choice"||r.type==="ordering"||r.type==="matching"||r.type==="multiple-select"||r.type==="slider"||r.type==="word-scramble"||r.type==="text-input")&&t.jsxs("div",{style:{marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.75rem"},children:[t.jsx("h3",{style:{margin:0,fontSize:"1.1rem",lineHeight:"1.4",flex:1},children:r.content.question}),se(r.content.question)&&t.jsx(re,{text:r.content.question,size:"medium"})]}),Je()]}),h&&t.jsx("div",{style:{marginBottom:"1rem",flexShrink:0},children:t.jsx(Tt,{variant:L?"success":"error",title:L?"Richtig!":"Nicht ganz richtig",children:r.content.explanation&&t.jsx("p",{style:{margin:0},children:r.content.explanation})})}),t.jsxs("div",{style:{flexShrink:0,display:"flex",flexDirection:"column",gap:"1rem"},children:[t.jsx("div",{style:{display:"flex",justifyContent:"center",gap:"1rem"},children:h?t.jsx("button",{onClick:Ge,style:{padding:"0.875rem 2rem",background:"#3b82f6",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"1rem",fontWeight:"500"},children:b<o.execution.taskIds.length-1?"N√§chste Aufgabe ‚Üí":"Sitzung beenden"}):t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:ve,disabled:!Se(),style:{padding:"0.875rem 2rem",background:Se()?"#3b82f6":"#9ca3af",color:"white",border:"none",borderRadius:"8px",cursor:Se()?"pointer":"not-allowed",fontSize:"1rem",fontWeight:"500"},children:"Antwort √ºberpr√ºfen"}),t.jsx("button",{onClick:b<o.execution.taskIds.length-1?qe:Be,style:{padding:"0.875rem 2rem",background:"#f3f4f6",color:"#6b7280",border:"1px solid #d1d5db",borderRadius:"8px",cursor:"pointer",fontSize:"1rem",fontWeight:"500"},children:b<o.execution.taskIds.length-1?"√úberspringen ‚Üí":"Sitzung beenden"})]})}),t.jsxs("div",{style:{padding:"0.75rem 1rem",background:"#f9fafb",borderRadius:"6px",display:"flex",justifyContent:"space-around",gap:"1rem"},children:[t.jsxs("div",{style:{textAlign:"center"},children:[t.jsx("div",{style:{fontSize:"1.25rem",fontWeight:"bold",color:"#3b82f6"},children:o.execution.completedCount}),t.jsx("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:"beantwortet"})]}),t.jsxs("div",{style:{textAlign:"center"},children:[t.jsx("div",{style:{fontSize:"1.25rem",fontWeight:"bold",color:"#10b981"},children:o.execution.correctCount}),t.jsx("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:"richtig"})]}),t.jsxs("div",{style:{textAlign:"center"},children:[t.jsxs("div",{style:{fontSize:"1.25rem",fontWeight:"bold",color:"#f59e0b"},children:[o.execution.completedCount>0?Math.round(o.execution.correctCount/o.execution.completedCount*100):0,"%"]}),t.jsx("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:"genau"})]})]})]})]})}function Z({title:l,value:e,subtitle:s,color:n=D.primary[500],icon:a,className:i="",style:o={},...m}){const r={borderLeft:`4px solid ${n}`,...o};return t.jsx(ue,{...m,padding:"medium",shadow:!0,border:!0,style:r,className:i,children:t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:U[2]},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx("h3",{style:{margin:0,fontSize:P.fontSize.sm,fontWeight:P.fontWeight.medium,color:T.text.secondary,textTransform:"uppercase",letterSpacing:P.letterSpacing.wide},children:l}),a&&t.jsx("div",{style:{display:"flex",alignItems:"center",color:n,fontSize:P.fontSize.xl},children:a})]}),t.jsx("div",{style:{fontSize:P.fontSize["3xl"],fontWeight:P.fontWeight.bold,color:T.text.primary,lineHeight:P.lineHeight.tight},children:e}),s&&t.jsx("div",{style:{fontSize:P.fontSize.sm,color:T.text.tertiary},children:s})]})})}function Bt({session:l,onClose:e,onStartNew:s}){const n=l.results.accuracy,a=Math.round(l.results.averageTime);let i="",o="";n>=90?(i="Ausgezeichnet!",o="#10b981"):n>=75?(i="Sehr gut!",o="#3b82f6"):n>=60?(i="Gut gemacht!",o="#f59e0b"):(i="Weiter √ºben!",o="#ef4444");function m(r){const g=Math.floor(r/60),b=r%60;return g>0?`${g}:${b.toString().padStart(2,"0")} min`:`${b} sek`}return t.jsxs("div",{style:{padding:"2rem",maxWidth:"600px",margin:"0 auto",textAlign:"center"},children:[t.jsxs("div",{style:{marginBottom:"2rem"},children:[t.jsx("div",{style:{fontSize:"4rem",marginBottom:"1rem"},children:"üéâ"}),t.jsx("h1",{style:{marginBottom:"0.5rem"},children:"Sitzung abgeschlossen!"}),t.jsx("p",{style:{fontSize:"1.5rem",fontWeight:"bold",color:o,margin:0},children:i})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"1rem",marginBottom:"2rem"},children:[t.jsx(Z,{title:"Aufgaben bearbeitet",value:l.execution.completedCount,color:"#3b82f6"}),t.jsx(Z,{title:"Richtige Antworten",value:l.execution.correctCount,color:"#10b981"}),t.jsx(Z,{title:"Genauigkeit",value:`${Math.round(n)}%`,color:o}),t.jsx(Z,{title:"√ò Zeit pro Aufgabe",value:m(a),color:"#f59e0b"})]}),t.jsx("div",{style:{background:"#dbeafe",padding:"1rem",borderRadius:"8px",marginBottom:"2rem"},children:t.jsxs("p",{style:{margin:0,fontSize:"0.95rem"},children:[t.jsx("strong",{children:"Gesamtzeit:"})," ",m(l.execution.totalTimeSpent)]})}),t.jsxs("div",{style:{background:"#f9fafb",padding:"1.5rem",borderRadius:"8px",marginBottom:"2rem"},children:[t.jsx("h3",{style:{marginBottom:"0.5rem"},children:"üìà Dein Fortschritt"}),t.jsxs("p",{style:{margin:0,fontSize:"0.95rem",color:"#6b7280",lineHeight:"1.6"},children:[n>=90&&"Hervorragende Leistung! Du beherrschst dieses Thema sehr gut.",n>=75&&n<90&&"Sehr gute Arbeit! Du machst gro√üe Fortschritte.",n>=60&&n<75&&"Gute Arbeit! Weiter so, du verbesserst dich stetig.",n<60&&"Bleib dran! √úbung macht den Meister. Die n√§chste Sitzung wird noch besser!"]})]}),t.jsxs("div",{style:{background:"#dcfce7",border:"2px solid #86efac",padding:"1.5rem",borderRadius:"8px",marginBottom:"2rem"},children:[t.jsx("h4",{style:{marginBottom:"0.5rem"},children:"üß† Spaced Repetition aktiviert"}),t.jsx("p",{style:{margin:0,fontSize:"0.9rem",lineHeight:"1.5"},children:"Deine Antworten wurden gespeichert. Aufgaben, die du nicht sofort beherrscht hast, werden dir in optimalen Abst√§nden wieder vorgelegt, um dein Langzeitged√§chtnis zu trainieren."})]}),t.jsxs("div",{style:{display:"flex",gap:"1rem",justifyContent:"center"},children:[t.jsx("button",{onClick:s,style:{padding:"1rem 2rem",background:"#3b82f6",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"1rem",fontWeight:"500"},children:"Neue Sitzung starten"}),t.jsx("button",{onClick:e,style:{padding:"1rem 2rem",background:"#e5e7eb",color:"#374151",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"1rem",fontWeight:"500"},children:"Zur√ºck zur √úbersicht"})]})]})}function Lt({onClose:l}){const[e,s]=x.useState(null),[n,a]=x.useState(!0);x.useEffect(()=>{i()},[]);async function i(){try{const r=await A.practiceSessions.toArray(),g=r.filter(w=>w.execution.status==="completed"),b=await A.topics.toArray(),B=new Map(b.map(w=>[w.id,w])),C=await A.spacedRepetition.toArray(),z=g.reduce((w,j)=>w+(j.execution?.completedCount||0),0),h=g.reduce((w,j)=>w+(j.execution?.correctCount||0),0),W=z>0?h/z*100:0,L=g.reduce((w,j)=>j.execution.startedAt&&j.execution.completedAt?w+(new Date(j.execution.completedAt).getTime()-new Date(j.execution.startedAt).getTime())/1e3:w,0),ee=g.length>0?L/g.length:0,G=new Map;for(const w of g){const j=w.configuration.topicId;G.has(j)||G.set(j,{sessions:0,correct:0,total:0});const $=G.get(j);$.sessions++,$.correct+=w.execution?.correctCount||0,$.total+=w.execution?.completedCount||0}const Y=Array.from(G.entries()).map(([w,j])=>({topicId:w,topicName:B.get(w)?.title||w,sessionsCompleted:j.sessions,accuracy:j.total>0?j.correct/j.total*100:0,tasksReviewed:j.total})),E=new Date,te=C.filter(w=>w.algorithm.efactor>=2.5).length,J=C.filter(w=>w.algorithm.efactor<2.5&&w.algorithm.repetition>0).length,ae=C.filter(w=>w.algorithm.repetition===0).length,M=C.filter(w=>new Date(w.schedule.nextReview)<=E).length,K=g.sort((w,j)=>{const $=w.execution.completedAt?new Date(w.execution.completedAt).getTime():0;return(j.execution.completedAt?new Date(j.execution.completedAt).getTime():0)-$}).slice(0,5);s({totalSessions:r.length,completedSessions:g.length,totalQuestions:z,correctAnswers:h,accuracyRate:W,averageSessionTime:ee,currentStreak:0,totalStudyTime:L,topicProgress:Y,recentSessions:K,upcomingReviews:M,masteryLevels:{mastered:te,learning:J,new:ae}})}catch(r){console.error("Failed to load dashboard stats:",r)}finally{a(!1)}}function o(r){const g=Math.floor(r/3600),b=Math.floor(r%3600/60);return g>0?`${g}h ${b}m`:`${b}m`}function m(r){return(typeof r=="string"?new Date(r):r).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric"})}return n?t.jsxs("div",{style:{padding:"2rem",fontFamily:"system-ui, sans-serif",textAlign:"center"},children:[t.jsx("h1",{children:"üìä Dashboard"}),t.jsx("p",{children:"Lade Statistiken..."})]}):e?t.jsxs("div",{style:{padding:"2rem",fontFamily:"system-ui, sans-serif",maxWidth:"1200px",margin:"0 auto"},children:[t.jsxs("div",{style:{marginBottom:"2rem"},children:[t.jsx("button",{onClick:l,style:{padding:"0.5rem 1rem",background:"#e5e7eb",border:"none",borderRadius:"4px",cursor:"pointer",marginBottom:"1rem"},children:"‚Üê Zur√ºck"}),t.jsx("h1",{style:{margin:0},children:"üìä Lern-Dashboard"}),t.jsx("p",{style:{color:"#6b7280",marginTop:"0.5rem"},children:"Deine Fortschritte und Statistiken im √úberblick"})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginBottom:"2rem"},children:[t.jsx(Z,{title:"Gesamt Sitzungen",value:e.completedSessions.toString(),subtitle:`von ${e.totalSessions} gestartet`,color:"#3b82f6"}),t.jsx(Z,{title:"Genauigkeit",value:`${Math.round(e.accuracyRate)}%`,subtitle:`${e.correctAnswers}/${e.totalQuestions} richtig`,color:"#10b981"}),t.jsx(Z,{title:"Lernzeit",value:o(e.totalStudyTime),subtitle:`√ò ${o(e.averageSessionTime)} pro Sitzung`,color:"#f59e0b"}),t.jsx(Z,{title:"Anstehende Wiederholungen",value:e.upcomingReviews.toString(),subtitle:"bereit zum √úben",color:"#8b5cf6"})]}),t.jsxs(ue,{padding:"medium",style:{marginBottom:"2rem"},children:[t.jsx("h2",{style:{marginTop:0},children:"üéØ Beherrschungsniveau"}),t.jsxs("div",{style:{display:"flex",gap:"1rem",marginTop:"1rem"},children:[t.jsx(Ae,{label:"Gemeistert",count:e.masteryLevels.mastered,color:"#10b981"}),t.jsx(Ae,{label:"In Arbeit",count:e.masteryLevels.learning,color:"#f59e0b"}),t.jsx(Ae,{label:"Neu",count:e.masteryLevels.new,color:"#6b7280"})]})]}),e.topicProgress.length>0&&t.jsxs(ue,{padding:"medium",style:{marginBottom:"2rem"},children:[t.jsx("h2",{style:{marginTop:0},children:"üìö Fortschritt nach Thema"}),t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",marginTop:"1rem"},children:e.topicProgress.map(r=>t.jsxs("div",{children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.5rem"},children:[t.jsx("span",{style:{fontWeight:"500"},children:r.topicName}),t.jsxs("span",{style:{color:"#6b7280",fontSize:"0.875rem"},children:[r.sessionsCompleted," Sitzungen ‚Ä¢ ",Math.round(r.accuracy),"% genau"]})]}),t.jsx("div",{style:{background:"#f3f4f6",height:"8px",borderRadius:"4px",overflow:"hidden"},children:t.jsx("div",{style:{background:r.accuracy>=75?"#10b981":r.accuracy>=50?"#f59e0b":"#ef4444",height:"100%",width:`${r.accuracy}%`,transition:"width 0.3s ease"}})}),t.jsxs("div",{style:{fontSize:"0.75rem",color:"#6b7280",marginTop:"0.25rem"},children:[r.tasksReviewed," Aufgaben bearbeitet"]})]},r.topicId))})]}),e.recentSessions.length>0&&t.jsxs(ue,{padding:"medium",children:[t.jsx("h2",{style:{marginTop:0},children:"üïê Letzte Sitzungen"}),t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem",marginTop:"1rem"},children:e.recentSessions.map(r=>t.jsxs("div",{style:{padding:"1rem",background:"#f9fafb",borderRadius:"6px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{fontWeight:"500"},children:r.configuration.topicId}),t.jsx("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:r.execution.completedAt&&m(r.execution.completedAt)})]}),t.jsxs("div",{style:{textAlign:"right"},children:[t.jsxs("div",{style:{fontWeight:"500",color:r.results.accuracy>=75?"#10b981":"#f59e0b"},children:[Math.round(r.results.accuracy),"%"]}),t.jsxs("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:[r.execution.correctCount,"/",r.execution.completedCount]})]})]},r.id))})]})]}):t.jsxs("div",{style:{padding:"2rem",fontFamily:"system-ui, sans-serif"},children:[t.jsx("button",{onClick:l,style:{padding:"0.5rem 1rem",background:"#e5e7eb",border:"none",borderRadius:"4px",cursor:"pointer",marginBottom:"1rem"},children:"‚Üê Zur√ºck"}),t.jsx("h1",{children:"üìä Dashboard"}),t.jsx("p",{children:"Keine Daten verf√ºgbar."})]})}function Ae({label:l,count:e,color:s}){return t.jsxs("div",{style:{flex:1},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.5rem"},children:[t.jsx("span",{style:{fontSize:"0.875rem",fontWeight:"500"},children:l}),t.jsx("span",{style:{fontSize:"0.875rem",color:"#6b7280"},children:e})]}),t.jsx("div",{style:{background:"#f3f4f6",height:"8px",borderRadius:"4px",overflow:"hidden"},children:t.jsx("div",{style:{background:s,height:"100%",width:e>0?"100%":"0%",transition:"width 0.3s ease"}})})]})}function Mt(){const[l,e]=x.useState([]),[s,n]=x.useState(null),[a,i]=x.useState([]),[o,m]=x.useState({}),[r,g]=x.useState(null),[b,B]=x.useState(!0),[C,z]=x.useState(!1),[h,W]=x.useState(null),[L,ee]=x.useState(!1),[G,Y]=x.useState(!1),[E,te]=x.useState({targetCount:10,includeReview:!0}),J=x.useRef(!1);x.useEffect(()=>{J.current||(J.current=!0,ae())},[]);async function ae(){try{const p=await A.topics.count(),k=await A.tasks.count();console.log(`Database status: ${p} topics, ${k} tasks`),p===0||k===0?(console.log("Database empty or incomplete, seeding..."),await Me(A)):console.log("Database already seeded, skipping seed");const V=await A.topics.toArray();e(V),B(!1)}catch(p){console.error("Failed to initialize app:",p),console.error("Error details:",{name:p?.name,message:p?.message,failures:p?.failures,stack:p?.stack}),B(!1)}}async function M(p){n(p);const k=await A.learningPaths.where("topicId").equals(p.id).toArray();console.log(`Loading learning paths for topic ${p.id}:`,k),k.sort((_,q)=>new Date(q.createdAt).getTime()-new Date(_.createdAt).getTime());const V={};for(const _ of k){const q=await A.tasks.where("learningPathId").equals(_.id).toArray();V[_.id]=q.length,console.log(`Learning path "${_.title}" (${_.id}): ${q.length} tasks in DB, taskIds array length: ${_.taskIds?.length||0}`),console.log("Task IDs:",q.map(O=>O.id))}m(V),i(k)}function K(p){g(p),Y(!0)}function w(){Y(!1),z(!0)}function j(){Y(!1),g(null)}async function $(){if(z(!1),r&&s){const p=await A.practiceSessions.where("execution.status").equals("completed").reverse().limit(1).toArray();p.length>0&&p[0]&&W(p[0])}}function Q(){z(!1),g(null)}function H(){W(null)}function oe(){W(null),r&&z(!0)}if(b)return t.jsxs("div",{style:{padding:"2rem",fontFamily:"system-ui, sans-serif",textAlign:"center"},children:[t.jsx("h1",{children:"üß† MindForge Academy"}),t.jsx("p",{children:"Wird geladen..."})]});if(L)return t.jsx("div",{style:{fontFamily:"system-ui, sans-serif"},children:t.jsx(Lt,{onClose:()=>ee(!1)})});if(h)return t.jsx("div",{style:{fontFamily:"system-ui, sans-serif"},children:t.jsx(Bt,{session:h,onClose:H,onStartNew:oe})});if(G&&r&&s)return t.jsxs("div",{style:{padding:"2rem",fontFamily:"system-ui, sans-serif",maxWidth:"600px",margin:"0 auto"},children:[t.jsx("button",{onClick:j,style:{padding:"0.5rem 1rem",background:"#e5e7eb",border:"none",borderRadius:"4px",cursor:"pointer",marginBottom:"1rem"},children:"‚Üê Zur√ºck"}),t.jsx("h1",{style:{marginBottom:"0.5rem"},children:"Sitzung konfigurieren"}),t.jsx("p",{style:{color:"#6b7280",marginBottom:"2rem"},children:r.title}),t.jsxs("div",{style:{marginBottom:"2rem"},children:[t.jsx("label",{style:{display:"block",fontWeight:"500",marginBottom:"0.5rem"},children:"Anzahl der Fragen"}),t.jsx("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[5,10,15,20].map(p=>t.jsx("button",{onClick:()=>te({...E,targetCount:p}),style:{padding:"0.75rem 1.5rem",background:E.targetCount===p?"#3b82f6":"#f3f4f6",color:E.targetCount===p?"white":"#374151",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"1rem",fontWeight:"500"},children:p},p))})]}),t.jsxs("div",{style:{marginBottom:"2rem"},children:[t.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[t.jsx("input",{type:"checkbox",checked:E.includeReview,onChange:p=>te({...E,includeReview:p.target.checked}),style:{marginRight:"0.5rem",width:"1.25rem",height:"1.25rem",cursor:"pointer"}}),t.jsx("span",{children:"Wiederholungsfragen einbeziehen"})]}),t.jsx("p",{style:{fontSize:"0.875rem",color:"#6b7280",marginTop:"0.5rem",marginLeft:"1.75rem"},children:"Fragen, die du bereits beantwortet hast und die zur Wiederholung f√§llig sind"})]}),t.jsx("button",{onClick:w,style:{padding:"1rem 2rem",background:"#3b82f6",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"1.1rem",fontWeight:"500",width:"100%"},children:"Sitzung starten ‚Üí"})]});if(C&&r&&s)return t.jsx("div",{style:{fontFamily:"system-ui, sans-serif"},children:t.jsx(Pt,{topicId:s.id,learningPathIds:[r.id],targetCount:E.targetCount,includeReview:E.includeReview,onComplete:$,onCancel:Q})});if(s)return t.jsxs("div",{style:{padding:"2rem",fontFamily:"system-ui, sans-serif"},children:[t.jsx("button",{onClick:()=>n(null),style:{padding:"0.5rem 1rem",background:"#e5e7eb",border:"none",borderRadius:"4px",cursor:"pointer",marginBottom:"1rem"},children:"‚Üê Zur√ºck zu Themen"}),t.jsxs("h1",{children:["üìö ",s.title]}),t.jsx("h2",{style:{marginTop:"2rem",marginBottom:"1rem"},children:"Lernpfade"}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"1rem"},children:a.map(p=>t.jsxs("div",{style:{padding:"1.5rem",background:"#ffffff",border:"2px solid #e5e7eb",borderRadius:"8px",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:k=>{k.currentTarget.style.borderColor="#3b82f6",k.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:k=>{k.currentTarget.style.borderColor="#e5e7eb",k.currentTarget.style.transform="translateY(0)"},children:[t.jsx("h3",{style:{marginBottom:"0.5rem"},children:p.title}),t.jsx("p",{style:{fontSize:"0.9rem",color:"#6b7280",marginBottom:"1rem"},children:p.description}),t.jsxs("div",{style:{fontSize:"0.85rem",color:"#9ca3af"},children:[t.jsx("span",{style:{marginRight:"1rem"},children:p.difficulty==="easy"?"üü¢ Leicht":p.difficulty==="medium"?"üü° Mittel":"üî¥ Schwer"}),t.jsxs("span",{children:[o[p.id]||p.taskIds?.length||0," Aufgaben"]})]}),t.jsx("button",{onClick:()=>K(p),style:{marginTop:"1rem",padding:"0.5rem 1rem",background:"#3b82f6",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",width:"100%"},children:"Lernpfad starten ‚Üí"})]},p.id))})]});async function ye(){if(confirm("Datenbank neu laden? Dies wird alle Lernpfade aktualisieren, aber dein Fortschritt bleibt erhalten."))try{await A.topics.clear(),await A.learningPaths.clear(),await A.tasks.clear(),await Me(A);const p=await A.topics.toArray();e(p),alert("‚úÖ Datenbank erfolgreich aktualisiert!")}catch(p){console.error("Reseed failed:",p),alert("‚ùå Fehler beim Aktualisieren der Datenbank")}}return t.jsxs("div",{style:{padding:"2rem",fontFamily:"system-ui, sans-serif"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem"},children:[t.jsxs("div",{children:[t.jsx("h1",{children:"üß† MindForge Academy"}),t.jsx("p",{style:{fontSize:"1.1rem",color:"#6b7280",marginTop:"0.5rem"},children:"Erweitere dein Wissen, eine Frage nach der anderen"})]}),t.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[t.jsx("button",{onClick:ye,style:{padding:"0.75rem 1.5rem",background:"#f59e0b",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"1rem",fontWeight:"500",display:"flex",alignItems:"center",gap:"0.5rem"},children:"üîÑ DB Aktualisieren"}),t.jsx("button",{onClick:()=>ee(!0),style:{padding:"0.75rem 1.5rem",background:"#3b82f6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"1rem",fontWeight:"500",display:"flex",alignItems:"center",gap:"0.5rem"},children:"üìä Dashboard"})]})]}),t.jsx("h2",{style:{marginTop:0,marginBottom:"1rem"},children:"Themen ausw√§hlen"}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(250px, 1fr))",gap:"1.5rem"},children:l.map(p=>t.jsxs("div",{onClick:()=>M(p),style:{padding:"2rem",background:p.id==="test"?"#fef3c7":p.id==="mathematik"?"#dbeafe":"#dcfce7",borderRadius:"12px",cursor:"pointer",transition:"transform 0.2s, box-shadow 0.2s",border:"2px solid transparent"},onMouseEnter:k=>{k.currentTarget.style.transform="translateY(-4px)",k.currentTarget.style.boxShadow="0 10px 25px rgba(0,0,0,0.1)",k.currentTarget.style.borderColor="#3b82f6"},onMouseLeave:k=>{k.currentTarget.style.transform="translateY(0)",k.currentTarget.style.boxShadow="none",k.currentTarget.style.borderColor="transparent"},children:[t.jsxs("h2",{style:{marginBottom:"0.5rem"},children:[p.id==="test"?"üéØ":p.id==="mathematik"?"üî¢":"üß¨"," ",p.title]}),t.jsxs("div",{style:{fontSize:"0.85rem",opacity:.7},children:[p.learningPathIds.length," Lernpfade"]})]},p.id))})]})}Ce.createRoot(document.getElementById("root")).render(t.jsx(ce.StrictMode,{children:t.jsx(Mt,{})}));
//# sourceMappingURL=index-BrMGcCQf.js.map
